/*! apogee 0.4.1 */

var apogeeapp={};apogeeapp.ui={},apogeeapp.ui.initResourcePath=function(e){apogeeapp.ui.RESOURCE_DIR=e},apogeeapp.ui.getResourcePath=function(e){return apogeeapp.ui.RESOURCE_DIR+e},apogeeapp.ui.MENU_ZINDEX=100,apogeeapp.ui.WINDOW_FRAME_ZINIDEX=10,apogeeapp.ui.DIALOG_ZINDEX=200,apogeeapp.ui.idIndex=0,apogeeapp.ui.idBase="_visiui_id_",apogeeapp.ui.createId=function(){return apogeeapp.ui.idBase+apogeeapp.ui.idIndex++},apogeeapp.ui.applyStyle=function(e,t){for(var p in t)e.style[p]=t[p]},apogeeapp.ui.MINIMIZE_CMD_IMAGE="/minimize.png",apogeeapp.ui.RESTORE_CMD_IMAGE="/restore.png",apogeeapp.ui.MAXIMIZE_CMD_IMAGE="/maximize.png",apogeeapp.ui.CLOSE_CMD_IMAGE="/close.png",apogeeapp.ui.MENU_IMAGE="/hamburger.png",apogeeapp.ui.removeAllChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},apogeeapp.ui.createElement=function(e,t,p){var a=document.createElement(e);if(t)for(var o in t)a[o]=t[o];return p&&apogeeapp.ui.applyStyle(a,p),a},apogeeapp.ui.createElementWithClass=function(e,t,p){var a=document.createElement(e);return a.className=t,p&&p.appendChild(a),a},apogeeapp.ui.dialogLayer=null,apogeeapp.ui.BASE_ELEMENT_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",zIndex:1},apogeeapp.ui.DIALOG_LAYER_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",zIndex:2,pointerEvents:"none"},apogeeapp.ui.DIALOG_SHIELD_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",pointerEvents:"auto"},apogeeapp.ui.initWindows=function(e){var t=document.getElementById(e);if(!t)throw apogee.base.createError("Container ID not found: "+e);var p={};return p.baseElement=apogeeapp.ui.createElement("div",null,apogeeapp.ui.BASE_ELEMENT_STYLE),p.dialogLayer=apogeeapp.ui.createElement("div",null,apogeeapp.ui.DIALOG_LAYER_STYLE),t.appendChild(p.baseElement),t.appendChild(p.dialogLayer),apogeeapp.ui.dialogLayer=p.dialogLayer,p},apogeeapp.ui.createDialog=function(e){return new apogeeapp.ui.WindowFrame(e)},apogeeapp.ui.showDialog=function(e){var t=apogeeapp.ui.createElement("div",null,apogeeapp.ui.DIALOG_SHIELD_STYLE),p=new apogeeapp.ui.WindowParent(t);apogeeapp.ui.dialogLayer.appendChild(t),p.addWindow(e)},apogeeapp.ui.closeDialog=function(e){var t=e.getParent();e.close(),apogeeapp.ui.dialogLayer.removeChild(t.getOuterElement())},apogeeapp.ui.WINDOW_STATE_MINIMIZED=-1,apogeeapp.ui.WINDOW_STATE_NORMAL=0,apogeeapp.ui.WINDOW_STATE_MAXIMIZED=1,apogeeapp.ui.WINDOW_STATE_CHANGED="window state change",apogeeapp.ui.MINIMIZABLE=1,apogeeapp.ui.MAXIMIZABLE=2,apogeeapp.ui.CLOSEABLE=4,apogeeapp.ui.REQUEST_CLOSE="request_close",apogeeapp.ui.DENY_CLOSE=-1,apogeeapp.ui.CLOSE_EVENT="closed",apogeeapp.ui.RESIZED_EVENT="resized",apogeeapp.ui.SHOWN_EVENT="shown",apogeeapp.ui.HIDDEN_EVENT="hidden",apogeeapp.ui.setMemberCssData=function(e,t){var p="css_"+e,a=document.getElementById(p);""!=t?(a||((a=document.createElement("style")).id=p,document.head.appendChild(a)),a.innerHTML=t):a&&document.head.removeChild(a)},apogeeapp.ui.WindowParent=function(e){apogee.EventManager.init.call(this),this.containerElement=e,this.windowFrameStack=[],this.showing=!1,this.prevNewChildX=0,this.prevNewChildY=0,this.wrapCount=0},apogee.base.mixin(apogeeapp.ui.WindowParent,apogee.EventManager),apogeeapp.ui.WindowParent.BASE_ZINDEX=0,apogeeapp.ui.WindowParent.DELTA_CHILD_X=25,apogeeapp.ui.WindowParent.DELTA_CHILD_Y=25,apogeeapp.ui.WindowParent.MAX_WRAP_WIDTH=400,apogeeapp.ui.WindowParent.MAX_WRAP_HEIGHT=400,apogeeapp.ui.WindowParent.prototype.elementIsShown=function(){this.showing=!0,this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,this)},apogeeapp.ui.WindowParent.prototype.elementIsHidden=function(){this.showing=!1,this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,this)},apogeeapp.ui.WindowParent.prototype.getIsShowing=function(){return this.showing},apogeeapp.ui.WindowParent.prototype.getOuterElement=function(){return this.containerElement},apogeeapp.ui.WindowParent.prototype.addWindow=function(e){this.containerElement.appendChild(e.getElement()),this.windowFrameStack.push(e),this.updateOrder(),e.onAddedToParent(this)},apogeeapp.ui.WindowParent.prototype.removeWindow=function(e){this.containerElement.removeChild(e.getElement());var t=this.windowFrameStack.indexOf(e);this.windowFrameStack.splice(t,1),this.updateOrder()},apogeeapp.ui.WindowParent.prototype.bringToFront=function(e){var t=this.windowFrameStack.indexOf(e);this.windowFrameStack.splice(t,1),this.windowFrameStack.push(e),this.updateOrder()},apogeeapp.ui.WindowParent.prototype.getCenterOnPagePosition=function(e){var t=e.getElement();return[(this.containerElement.offsetWidth-t.clientWidth)/2,(this.containerElement.offsetHeight-t.clientHeight)/2]},apogeeapp.ui.WindowParent.prototype.getNextWindowPosition=function(){var e=this.prevNewChildX+apogeeapp.ui.WindowParent.DELTA_CHILD_X,t=this.prevNewChildY+apogeeapp.ui.WindowParent.DELTA_CHILD_Y;(e>apogeeapp.ui.WindowParent.MAX_WRAP_WIDTH||t>apogeeapp.ui.WindowParent.MAX_WRAP_HEIGHT)&&(this.wrapCount++,e=apogeeapp.ui.WindowParent.DELTA_CHILD_X*(this.wrapCount+1),t=apogeeapp.ui.WindowParent.DELTA_CHILD_Y),this.prevNewChildX=e,this.prevNewChildY=t;var p={};return p.x=e,p.y=t,p},apogeeapp.ui.WindowParent.prototype.updateOrder=function(){for(var e=apogeeapp.ui.WindowParent.BASE_ZINDEX,t=0;t<this.windowFrameStack.length;t++)this.windowFrameStack[t].setZIndex(e++)},apogeeapp.ui.WindowFrame=function(e){e||(e={}),apogee.EventManager.init.call(this),this.windowParent=null,this.parentElement=null,this.options=e,this.windowState=void 0!==e.initialState?e.initialState:apogeeapp.ui.WINDOW_STATE_NORMAL,this.posInfo={},this.posInfo.x=0,this.posInfo.y=0,this.sizeInfo={},this.sizeInfo.width=apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_WIDTH,this.sizeInfo.height=apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_HEIGHT,this.frame=null,this.titleCell=null,this.headerCell=null,this.bodyCell=null,this.headerContent=null,this.content=null,this.windowDragActive=!1,this.moveOffsetX=null,this.moveOffsetX=null,this.moveOnMouseMove=null,this.moveOnMouseLeave=null,this.moveOnMouseUp=null,this.resizeEastActive=!1,this.resizeWestActive=!1,this.resizeNorthActive=!1,this.resizeSouthActive=!1,this.resizeOffsetWidth=null,this.resizeOffsetHeight=null,this.resizeOnMouseUp=null,this.resizeOnMouseMove=null,this.resizeOnMouseLeave=null,this.minWidth=0,this.minHeight=0,this.initUI();var t=this;this.getElement().addEventListener("mousedown",function(e){t.windowParent.bringToFront(t)})},apogee.base.mixin(apogeeapp.ui.WindowFrame,apogee.EventManager),apogeeapp.ui.WindowFrame.RESIZE_LOCATION_SIZE=10,apogeeapp.ui.WindowFrame.RESIZE_TOLERANCE=5,apogeeapp.ui.WindowFrame.RESIZE_EAST=1,apogeeapp.ui.WindowFrame.RESIZE_WEST=2,apogeeapp.ui.WindowFrame.RESIZE_SOUTH=4,apogeeapp.ui.WindowFrame.RESIZE_NORTH=8,apogeeapp.ui.WindowFrame.RESIZE_NE=apogeeapp.ui.WindowFrame.RESIZE_NORTH+apogeeapp.ui.WindowFrame.RESIZE_EAST,apogeeapp.ui.WindowFrame.RESIZE_NW=apogeeapp.ui.WindowFrame.RESIZE_NORTH+apogeeapp.ui.WindowFrame.RESIZE_WEST,apogeeapp.ui.WindowFrame.RESIZE_SE=apogeeapp.ui.WindowFrame.RESIZE_SOUTH+apogeeapp.ui.WindowFrame.RESIZE_EAST,apogeeapp.ui.WindowFrame.RESIZE_SW=apogeeapp.ui.WindowFrame.RESIZE_SOUTH+apogeeapp.ui.WindowFrame.RESIZE_WEST,apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_HEIGHT=300,apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_WIDTH=300,apogeeapp.ui.WindowFrame.prototype.getTitle=function(){return this.title},apogeeapp.ui.WindowFrame.prototype.setTitle=function(e){this.title=e,this.titleBarTitleElement.innerHTML=e},apogeeapp.ui.WindowFrame.prototype.createMenu=function(e){return e||(e=apogeeapp.ui.getResourcePath(apogeeapp.ui.MENU_IMAGE)),this.menu=apogeeapp.ui.Menu.createMenuFromImage(e),this.titleBarMenuElement.appendChild(this.menu.getElement()),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_win_icon_overlay_style",this.titleBarMenuElement),this.menu},apogeeapp.ui.WindowFrame.prototype.getMenu=function(){return this.menu},apogeeapp.ui.WindowFrame.prototype.setIconOverlay=function(e){this.iconOverlayElement&&(this.clearIconOverlay(),e&&this.iconOverlayElement.appendChild(e))},apogeeapp.ui.WindowFrame.prototype.clearIconOverlay=function(){this.iconOverlayElement&&apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.WindowFrame.prototype.setHeaderContent=function(e){apogeeapp.ui.removeAllChildren(this.headerCell),this.headerCell.appendChild(e),this.headerContent=e},apogeeapp.ui.WindowFrame.prototype.setContent=function(e){apogeeapp.ui.removeAllChildren(this.bodyCell),this.bodyCell.appendChild(e),this.content=e},apogeeapp.ui.WindowFrame.prototype.safeRemoveContent=function(e){for(var t=0;t<this.bodyCell.childNodes.length;t++)this.bodyCell.childNodes[t]===e&&(this.bodyCell.removeChild(e),this.content=null)},apogeeapp.ui.WindowFrame.prototype.addTitleToolElement=function(e){this.titleBarToolElement.appendChild(e)},apogeeapp.ui.WindowFrame.prototype.removeTitleToolElement=function(e){this.titleBarToolElement.removeChild(e)},apogeeapp.ui.WindowFrame.prototype.getParent=function(){return this.windowParent},apogeeapp.ui.WindowFrame.prototype.getIsShowing=function(){return!!this.windowParent&&this.windowParent.getIsShowing()},apogeeapp.ui.WindowFrame.prototype.close=function(e){this.windowParent&&(e||this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this)!=apogeeapp.ui.DENY_CLOSE)&&(this.windowParent.removeListener(apogeeapp.ui.SHOWN_EVENT,this.windowShownListener),this.windowParent.removeListener(apogeeapp.ui.HIDDEN_EVENT,this.windowHiddenListener),this.windowParent.removeWindow(this),this.windowParent=null,this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this))},apogeeapp.ui.WindowFrame.prototype.setPosition=function(e,t){e<0&&(e=0),t<0&&(t=0),this.posInfo.x=e,this.posInfo.y=t,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setSize=function(e,t){this.sizeInfo.width=e,this.sizeInfo.height=t,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.getPosInfo=function(){return this.posInfo},apogeeapp.ui.WindowFrame.prototype.setPosInfo=function(e){this.posInfo=e,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.getSizeInfo=function(){return this.sizeInfo},apogeeapp.ui.WindowFrame.prototype.setSizeInfo=function(e){this.sizeInfo=e,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setCoordinateInfo=function(e,t){this.posInfo=e,this.sizeInfo=t,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setZIndex=function(e){this.frame.style.zIndex=String(e)},apogeeapp.ui.WindowFrame.prototype.getElement=function(){return this.frame},apogeeapp.ui.WindowFrame.prototype.fitToContent=function(){this.sizeInfo.width=void 0,this.sizeInfo.height=void 0},apogeeapp.ui.WindowFrame.prototype.centerInParent=function(){var e=this.windowParent.getCenterOnPagePosition(this);this.setPosition(e[0],e[1])},apogeeapp.ui.WindowFrame.prototype.getWindowState=function(){return this.windowState},apogeeapp.ui.WindowFrame.prototype.setWindowState=function(e){switch(e){case apogeeapp.ui.WINDOW_STATE_NORMAL:this.restoreContent();break;case apogeeapp.ui.WINDOW_STATE_MINIMIZED:this.minimizeContent();break;case apogeeapp.ui.WINDOW_STATE_MAXIMIZED:this.maximizeContent();break;default:alert("Unknown window state: "+e)}},apogeeapp.ui.WindowFrame.prototype.onAddedToParent=function(e){this.windowParent=e,this.parentElement=e.getOuterElement();var t=this;this.windowShownListener=function(e){t.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,t)},this.windowParent.addListener(apogeeapp.ui.SHOWN_EVENT,this.windowShownListener),this.windowHiddenListener=function(e){t.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t)},this.windowParent.addListener(apogeeapp.ui.HIDDEN_EVENT,this.windowHiddenListener),this.windowParent.getIsShowing()&&this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,this),void 0!==this.sizeInfo.height&&this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.moveMouseDown=function(e){this.windowState!==apogeeapp.ui.WINDOW_STATE_MAXIMIZED&&this.parentElement&&(this.windowDragActive=!0,this.moveOffsetX=e.clientX-this.frame.offsetLeft,this.moveOffsetY=e.clientY-this.frame.offsetTop,this.parentElement.addEventListener("mousemove",this.moveOnMouseMove),this.parentElement.addEventListener("mouseleave",this.moveOnMouseLeave),this.parentElement.addEventListener("mouseup",this.moveOnMouseUp))},apogeeapp.ui.WindowFrame.prototype.moveMouseMoveImpl=function(e){if(this.windowDragActive){var t=e.clientX-this.moveOffsetX;t<0&&(t=0);var p=e.clientY-this.moveOffsetY;p<0&&(p=0),this.posInfo.x=t,this.posInfo.y=p,this.updateCoordinates()}},apogeeapp.ui.WindowFrame.prototype.moveMouseUpImpl=function(e){this.endMove()},apogeeapp.ui.WindowFrame.prototype.moveMouseLeaveImpl=function(e){this.endMove()},apogeeapp.ui.WindowFrame.prototype.resizeMouseDownImpl=function(e,t){this.windowState!==apogeeapp.ui.WINDOW_STATE_MAXIMIZED&&t&&(t&apogeeapp.ui.WindowFrame.RESIZE_EAST?(this.resizeEastActive=!0,this.resizeOffsetWidth=e.clientX-this.bodyCell.clientWidth):t&apogeeapp.ui.WindowFrame.RESIZE_WEST&&(this.resizeWestActive=!0,this.resizeOffsetWidth=e.clientX+this.bodyCell.clientWidth,this.moveOffsetX=e.clientX-this.frame.offsetLeft),t&apogeeapp.ui.WindowFrame.RESIZE_SOUTH?(this.resizeSouthActive=!0,this.resizeOffsetHeight=e.clientY-this.bodyCell.clientHeight):t&apogeeapp.ui.WindowFrame.RESIZE_NORTH&&(this.resizeNorthActive=!0,this.resizeOffsetHeight=e.clientY+this.bodyCell.clientHeight,this.moveOffsetY=e.clientY-this.frame.offsetTop),this.parentElement.addEventListener("mouseup",this.resizeOnMouseUp),this.parentElement.addEventListener("mousemove",this.resizeOnMouseMove),this.parentElement.addEventListener("mouseleave",this.resizeOnMouseLeave))},apogeeapp.ui.WindowFrame.prototype.resizeMouseMoveImpl=function(e){var t,p,a,o,n=!1;this.resizeEastActive?(p=e.clientX-this.resizeOffsetWidth,this.sizeInfo.width=p,n=!0):this.resizeWestActive&&(p=this.resizeOffsetWidth-e.clientX,(a=e.clientX-this.moveOffsetX)<0&&(a=0),this.sizeInfo.width=p,this.posInfo.x=a,n=!0),this.resizeSouthActive?(t=e.clientY-this.resizeOffsetHeight,this.sizeInfo.height=t,n=!0):this.resizeNorthActive&&(t=this.resizeOffsetHeight-e.clientY,(o=e.clientY-this.moveOffsetY)<0&&(o=0),this.sizeInfo.height=t,this.posInfo.y=o,n=!0),n&&this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.resizeMouseUpImpl=function(e){this.endResize()},apogeeapp.ui.WindowFrame.prototype.resizeMouseLeaveImpl=function(e){this.endResize()},apogeeapp.ui.WindowFrame.prototype.endMove=function(e){this.windowDragActive=!1,this.parentElement.removeEventListener("mousemove",this.moveOnMouseMove),this.parentElement.removeEventListener("mouseup",this.moveOnMouseUp),this.parentElement.removeEventListener("mouseleave",this.moveOnMouseLeave)},apogeeapp.ui.WindowFrame.prototype.endResize=function(){this.resizeEastActive=!1,this.resizeWestActive=!1,this.resizeSouthActive=!1,this.resizeNorthActive=!1,this.parentElement.removeEventListener("mouseup",this.resizeOnMouseUp),this.parentElement.removeEventListener("mousemove",this.resizeOnMouseMove),this.parentElement.removeEventListener("mouseleave",this.resizeOnMouseLeave)},apogeeapp.ui.WindowFrame.prototype.minimizeContent=function(){this.headerCell.style.display="none",this.bodyCell.style.display="none";var e=this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_MINIMIZED,this.updateCoordinates(),this.setMinMaxButtons(),e||this.dispatchEvent(apogeeapp.ui.WINDOW_STATE_CHANGED,this)},apogeeapp.ui.WindowFrame.prototype.restoreContent=function(){this.headerCell.style.display="",this.bodyCell.style.display="";var e=this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED,t=this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_NORMAL,this.updateCoordinates(),this.setMinMaxButtons(),(e||t)&&this.dispatchEvent(apogeeapp.ui.WINDOW_STATE_CHANGED,this)},apogeeapp.ui.WindowFrame.prototype.maximizeContent=function(){this.headerCell.style.display="",this.bodyCell.style.display="";var e=this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_MAXIMIZED,this.updateCoordinates(),this.setMinMaxButtons(),e||this.dispatchEvent(apogeeapp.ui.WINDOW_STATE_CHANGED,this)},apogeeapp.ui.WindowFrame.prototype.updateCoordinates=function(){var e=this.bodyCell.style.height,t=this.bodyCell.style.width;this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED?(this.frame.style.left="0px",this.frame.style.top="0px",this.frame.style.height="100%",this.frame.style.width="100%",this.bodyCell.style.height="100%",this.bodyCell.style.width="100%"):this.windowState===apogeeapp.ui.WINDOW_STATE_NORMAL?(this.frame.style.left=this.posInfo.x+"px",this.frame.style.top=this.posInfo.y+"px",this.frame.style.height="",this.frame.style.width="",void 0!==this.sizeInfo.height?this.bodyCell.style.height=this.sizeInfo.height+"px":this.bodyCell.style.height="",void 0!==this.sizeInfo.width?this.bodyCell.style.width=this.sizeInfo.width+"px":this.bodyCell.style.width=""):this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED&&(this.frame.style.left=this.posInfo.x+"px",this.frame.style.top=this.posInfo.y+"px",this.frame.style.height="",this.frame.style.width="",this.bodyCell.style.height="0px",this.bodyCell.style.width="0px"),e==this.bodyCell.style.height&&t==this.bodyCell.style.width||this.dispatchEvent(apogeeapp.ui.RESIZED_EVENT,this)},apogeeapp.ui.WindowFrame.prototype.initUI=function(){var e,t,p;(e=document.createElement("table")).className="visiui_win_main",this.frame=e,t=document.createElement("tr"),e.appendChild(t),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_topLeft",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_WEST|apogeeapp.ui.WindowFrame.RESIZE_NORTH),t.appendChild(p),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_top",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_NORTH),t.appendChild(p),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_topRight",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_EAST|apogeeapp.ui.WindowFrame.RESIZE_NORTH),t.appendChild(p),t=document.createElement("tr"),e.appendChild(t),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_left",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_WEST),p.rowSpan=3,t.appendChild(p),(p=document.createElement("td")).className="visiui_win_windowColorClass",this.titleBarCell=p,t.appendChild(p),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_right",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_EAST),p.rowSpan=3,t.appendChild(p),(t=document.createElement("tr")).className="visiui_win_headerRow",e.appendChild(t),(p=document.createElement("td")).className="visiui_win_headerCell",this.headerCell=p,t.appendChild(p),(t=document.createElement("tr")).className="visiui_win_bodyRow",e.appendChild(t),(p=document.createElement("td")).className="visiui_win_bodyCell",this.bodyCell=p,t.appendChild(p),t=document.createElement("tr"),e.appendChild(t),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_bottomLeft",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_WEST|apogeeapp.ui.WindowFrame.RESIZE_SOUTH),t.appendChild(p),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_bottom",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_SOUTH),t.appendChild(p),(p=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_bottomRight",this.addResizeHandlers(p,apogeeapp.ui.WindowFrame.RESIZE_EAST|apogeeapp.ui.WindowFrame.RESIZE_SOUTH),t.appendChild(p),this.createTitleBar()},apogeeapp.ui.WindowFrame.prototype.addResizeHandlers=function(e,t){if(this.options.resizable){var p=this;e.onmousedown=function(e){p.resizeMouseDownImpl(e,t)},this.resizeOnMouseMove||(this.resizeOnMouseMove=function(e){p.resizeMouseMoveImpl(e)},this.resizeOnMouseUp=function(e){p.resizeMouseUpImpl(e)},this.resizeOnMouseLeave=function(e){p.resizeMouseLeaveImpl(e)})}},apogeeapp.ui.WindowFrame.prototype.createTitleBar=function(){this.titleBarElement=apogeeapp.ui.createElementWithClass("div","visiui_win_titleBarClass",this.titleBarCell),this.titleBarLeftElements=apogeeapp.ui.createElementWithClass("div","visiui_win_left_style",this.titleBarElement),this.titleBarMenuElement=apogeeapp.ui.createElementWithClass("div","visiui_win_menu_style",this.titleBarLeftElements),this.titleBarTitleElement=apogeeapp.ui.createElementWithClass("div","visiui_win_title",this.titleBarLeftElements),this.titleBarRightElements=apogeeapp.ui.createElementWithClass("div","visiui_win_right_style",this.titleBarElement),this.titleBarToolElement=apogeeapp.ui.createElementWithClass("div","visiui_win_tool_style",this.titleBarRightElements);var e=this;this.options.minimizable&&(this.minimizeButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.minimizeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.MINIMIZE_CMD_IMAGE),this.minimizeButton.onclick=function(){e.minimizeContent()}),(this.options.minimizable||this.options.maximizable)&&(this.restoreButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.restoreButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.RESTORE_CMD_IMAGE),this.restoreButton.onclick=function(){e.restoreContent()}),this.windowState=apogeeapp.ui.WINDOW_STATE_NORMAL,this.setMinMaxButtons(),this.options.closable&&(this.closeButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.closeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.CLOSE_CMD_IMAGE),this.closeButton.onclick=function(){e.close()}),this.setTitle(""),this.options.movable&&(this.titleBarElement.onmousedown=function(t){e.moveMouseDown(t)},this.moveOnMouseMove=function(t){e.moveMouseMoveImpl(t)},this.moveOnMouseUp=function(t){e.moveMouseUpImpl(t)},this.moveOnMouseLeave=function(t){e.moveMouseLeaveImpl(t)})},apogeeapp.ui.WindowFrame.prototype.setMinMaxButtons=function(){this.minimizeButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_MINIMIZED?this.minimizeButton.style.display="none":this.minimizeButton.style.display=""),this.restoreButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_NORMAL?this.restoreButton.style.display="none":this.restoreButton.style.display=""),this.maximizeButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_MAXIMIZED?this.maximizeButton.style.display="none":this.maximizeButton.style.display="")},apogeeapp.ui.TabFrame=function(){apogee.EventManager.init.call(this),this.tabTable={},this.activeTab=null,this.tabFrameControl=apogeeapp.ui.createElementWithClass("div","visiui-tf-frame"),this.tabBar=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-bar",this.tabFrameControl),this.tabFrame=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-container",this.tabFrameControl)},apogee.base.mixin(apogeeapp.ui.TabFrame,apogee.EventManager),apogeeapp.ui.TabFrame.CONTAINER_FRAME_MARGIN_PX=5,apogeeapp.ui.TabFrame.prototype.getElement=function(){return this.tabFrameControl},apogeeapp.ui.TabFrame.prototype.getTab=function(e){return this.tabTable[e]},apogeeapp.ui.TabFrame.prototype.addTab=function(e,t){var p=e.getId();if(this.tabTable[p])return alert("There is already a tab with this id!"),null;e.setTabFrame(this),this.tabFrame.appendChild(e.getMainElement());var a=e.getLabelElement();this.tabBar.appendChild(a);var o=this;a.onclick=function(){o.setActiveTab(p)},a.onmousedown=function(e){e.preventDefault()},this.tabTable[p]=e,t||null==this.activeTab?this.setActiveTab(p):this.updateTabDisplay()},apogeeapp.ui.TabFrame.prototype.closeTab=function(e){var t=this.tabTable[e];if(t){this.tabFrame.removeChild(t.getMainElement());var p=t.getLabelElement();if(this.tabBar.removeChild(p),delete p.onclick,delete p.onmousedown,delete this.tabTable[e],this.activeTab==e){this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t),this.activeTab=null;for(var a in this.tabTable){this.setActiveTab(a);break}}this.updateTabDisplay()}},apogeeapp.ui.TabFrame.prototype.setActiveTab=function(e){var t=this.tabTable[e];if(t){var p;this.activeTab&&(p=this.tabTable[this.activeTab]),this.activeTab=e,this.tabFrame.appendChild(t.getMainElement()),this.updateTabDisplay(),this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,t),p&&this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,p)}},apogeeapp.ui.TabFrame.prototype.updateTabDisplay=function(){var e;for(e in this.tabTable){var t=this.tabTable[e];e==this.activeTab?(t.getMainElement().style.display="",t.getLabelElement().className="visiui-tf-tab-base visiui-tf-tab-active"):(t.getMainElement().style.display="none",t.getLabelElement().className="visiui-tf-tab-base visiui-tf-tab-inactive")}},apogeeapp.ui.Tab=function(e){apogee.EventManager.init.call(this),this.tabFrame=null,this.id=e,this.tabLabelElement=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-base visiui-tf-tab-inactive"),this.menuContainer=apogeeapp.ui.createElementWithClass("div","visiui-tf_tab-menuDiv",this.tabLabelElement),this.titleElement=apogeeapp.ui.createElementWithClass("div","visiui_tf_tab_title",this.tabLabelElement),this.closeButton=apogeeapp.ui.createElementWithClass("img","visiui_tf_tab_cmd_button",this.tabLabelElement),this.closeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.CLOSE_CMD_IMAGE);var t=this;this.closeButton.onclick=function(){t.close()},this.displayFrame=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-window"),this.tabInsideContainer=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null),this.displayFrame.appendChild(this.tabInsideContainer.getOuterElement()),this.headerContainer=this.tabInsideContainer.getHeaderContainer(),this.bodyContainer=this.tabInsideContainer.getBodyContainer(),this.isShowing=!1},apogee.base.mixin(apogeeapp.ui.Tab,apogee.EventManager),apogeeapp.ui.Tab.prototype.setTabFrame=function(e){this.tabFrame=e;var t=this;this.tabShownListener=function(e){e==t&&t.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,t)},this.tabFrame.addListener(apogeeapp.ui.SHOWN_EVENT,this.tabShownListener),this.tabHiddenListener=function(e){e==t&&t.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t)},this.tabFrame.addListener(apogeeapp.ui.HIDDEN_EVENT,this.tabHiddenListener)},apogeeapp.ui.Tab.prototype.makeActive=function(){return!!this.tabFrame&&(this.tabFrame.setActiveTab(this.id),!0)},apogeeapp.ui.Tab.prototype.getId=function(){return this.id},apogeeapp.ui.Tab.prototype.setTitle=function(e){this.titleElement.innerHTML=e,this.title=e},apogeeapp.ui.Tab.prototype.setHeaderContent=function(e){apogeeapp.ui.removeAllChildren(this.headerContainer),this.headerContainer.appendChild(e),this.headerContent=e},apogeeapp.ui.Tab.prototype.setContent=function(e){apogeeapp.ui.removeAllChildren(this.bodyContainer),this.bodyContainer.appendChild(e),this.content=e},apogeeapp.ui.Tab.prototype.getTitle=function(){return this.title},apogeeapp.ui.Tab.prototype.createMenu=function(e){return e||(e=apogeeapp.ui.getResourcePath(apogeeapp.ui.MENU_IMAGE)),this.menu=apogeeapp.ui.Menu.createMenuFromImage(e),this.menuContainer.appendChild(this.menu.domElement),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_tf_icon_overlay",this.menuContainer),this.menu},apogeeapp.ui.Tab.prototype.getMenu=function(){return this.menu},apogeeapp.ui.Tab.prototype.setIconOverlay=function(e){this.iconOverlayElement&&(this.clearIconOverlay(),e&&this.iconOverlayElement.appendChild(e))},apogeeapp.ui.Tab.prototype.clearIconOverlay=function(){this.iconOverlayElement&&apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.Tab.prototype.close=function(e){this.tabFrame&&(e||this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this)!=apogeeapp.ui.DENY_CLOSE)&&(this.tabFrame.closeTab(this.id),this.tabFrame.removeListener(apogeeapp.ui.SHOWN_EVENT,this.tabShownListener),this.tabFrame.removeListener(apogeeapp.ui.HIDDEN_EVENT,this.tabHiddenListener),this.tabFrame=null,this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this))},apogeeapp.ui.Tab.prototype.getMainElement=function(){return this.displayFrame},apogeeapp.ui.Tab.prototype.getLabelElement=function(){return this.tabLabelElement},apogeeapp.ui.Menu={},apogeeapp.ui.Menu.initialized=!1,apogeeapp.ui.Menu.activeMenu=null,apogeeapp.ui.Menu.createMenu=function(e){var t=apogeeapp.ui.createElementWithClass("div","visiui-menu-heading visiui-menu-text");return t.innerHTML=e,new apogeeapp.ui.MenuHeader(t)},apogeeapp.ui.Menu.createMenuFromImage=function(e){var t=document.createElement("img");t.src=e;var p=apogeeapp.ui.createElementWithClass("div","visiui-menu-heading visiui-menu-image");return p.appendChild(t),new apogeeapp.ui.MenuHeader(p)},apogeeapp.ui.Menu.showContextMenu=function(e,t){e.setPosition(t.clientX,t.clientY,document.body),t.preventDefault(),apogeeapp.ui.Menu.show(e)},apogeeapp.ui.Menu.menuHeaderPressed=function(e){apogeeapp.ui.Menu.activeMenu===e?apogeeapp.ui.Menu.hideActiveMenu():apogeeapp.ui.Menu.show(e.getMenuBody())},apogeeapp.ui.Menu.nonMenuPressed=function(){apogeeapp.ui.Menu.activeMenu&&apogeeapp.ui.Menu.hideActiveMenu()},apogeeapp.ui.Menu.show=function(e){apogeeapp.ui.Menu.activeMenu&&apogeeapp.ui.Menu.hideActiveMenu();var t=e.getParentElement();e.prepareShow();var p=e.getMenuElement();if(t&&p){t.appendChild(p),apogeeapp.ui.Menu.activeMenu=e;var a=e.getMenuHeader();a&&(a.className="visiui-menu-heading visiui-menu-heading-active")}},apogeeapp.ui.Menu.hideActiveMenu=function(){if(apogeeapp.ui.Menu.activeMenu){var e=apogeeapp.ui.Menu.activeMenu,t=e.getMenuHeader();t&&(t.className="visiui-menu-heading");var p=e.getParentElement(),a=e.getMenuElement();p&&a&&(p.removeChild(a),apogeeapp.ui.Menu.activeMenu=null),e.menuHidden()}},apogeeapp.ui.Menu.nonMenuMouseHandler=null,apogeeapp.ui.Menu.initialize=function(){window.addEventListener("mousedown",apogeeapp.ui.Menu.nonMenuPressed),apogeeapp.ui.Menu.initialized=!0},apogeeapp.ui.Menu.deinitialize=function(){window.removeEventListener("mousedown",apogeeapp.ui.Menu.nonMenuPressed),apogeeapp.ui.Menu.initialized=!1},apogeeapp.ui.MenuHeader=function(e){apogeeapp.ui.Menu.initialized||apogeeapp.ui.Menu.initialize(),this.domElement=e,this.menuBody=new apogeeapp.ui.MenuBody,this.initHeadingElement(),this.menuBody.attachToMenuHeader(this)},apogeeapp.ui.MenuHeader.prototype.getElement=function(){return this.domElement},apogeeapp.ui.MenuHeader.prototype.setChildLocation=function(e){this.childLocation=e},apogeeapp.ui.MenuHeader.prototype.getChildLocation=function(){return this.childLocation},apogeeapp.ui.MenuHeader.prototype.getMenuBody=function(){return this.menuBody},apogeeapp.ui.MenuHeader.prototype.addEventMenuItem=function(e,t,p,a){this.menuBody.addEventMenuItem(e,t,p,a)},apogeeapp.ui.MenuHeader.prototype.addCallbackMenuItem=function(e,t){this.menuBody.addCallbackMenuItem(e,t)},apogeeapp.ui.MenuHeader.prototype.addMenuItem=function(e){this.menuBody.addMenuItem(e)},apogeeapp.ui.MenuHeader.prototype.setMenuItems=function(e){this.menuBody.setMenuItems(e)},apogeeapp.ui.MenuHeader.prototype.removeMenuItem=function(e){this.menuBody.removeMenuItem(e)},apogeeapp.ui.MenuHeader.prototype.setAsOnTheFlyMenu=function(e){this.menuBody.setAsOnTheFlyMenu(e)},apogeeapp.ui.MenuHeader.prototype.initHeadingElement=function(){var e=this;this.domElement.onmousedown=function(t){apogeeapp.ui.Menu.menuHeaderPressed(e),t.stopPropagation()}},apogeeapp.ui.MenuBody=function(){apogeeapp.ui.Menu.initialized||apogeeapp.ui.Menu.initialize(),this.menuDiv=null,this.parentElement=null,this.menuItems={},this.createMenuElement(),this.menuHeader=null},apogeeapp.ui.MenuBody.prototype.getMenuElement=function(){return this.menuDiv},apogeeapp.ui.MenuBody.prototype.getParentElement=function(){return this.parentElement},apogeeapp.ui.MenuBody.prototype.getMenuHeader=function(){return this.menuHeader},apogeeapp.ui.MenuBody.prototype.getIsContext=function(){return null==this.menuHeader},apogeeapp.ui.MenuBody.prototype.prepareShow=function(){this.isOnTheFlyMenu&&this.constructItemsForShow()},apogeeapp.ui.MenuBody.prototype.menuHidden=function(){this.isOnTheFlyMenu&&this.destroyItemsForHides()},apogeeapp.ui.MenuBody.prototype.attachToMenuHeader=function(e){this.parentElement=e.getElement(),this.menuDiv.style.left="0%",this.menuDiv.style.top="100%",this.menuHeader=e},apogeeapp.ui.MenuBody.prototype.setPosition=function(e,t,p){this.parentElement=p,p.appendChild(this.menuDiv);var a=p.offsetWidth,o=p.offsetHeight,n=this.menuDiv.clientWidth,i=this.menuDiv.clientHeight;p.appendChild(this.menuDiv),this.menuDiv.style.left=e+n>a&&e>a/2?e-n+"px":e+"px",this.menuDiv.style.top=t+i>o&&t>o/2?t-i+"px":t+"px"},apogeeapp.ui.MenuBody.prototype.setAsOnTheFlyMenu=function(e){this.isOnTheFlyMenu=!0,this.menuItemsCallback=e},apogeeapp.ui.MenuBody.prototype.addEventMenuItem=function(e,t,p,a){var o={};o.title=e,o.eventName=t,o.eventData=p,o.eventManager=a,this.addMenuItem(o)},apogeeapp.ui.MenuBody.prototype.addCallbackMenuItem=function(e,t){var p={};p.title=e,p.callback=t,this.addMenuItem(p)},apogeeapp.ui.MenuBody.prototype.addMenuItem=function(e){if(e.element=apogeeapp.ui.createElementWithClass("div","visiui-menu-item"),e.element.innerHTML=e.title,e.childMenuItems){var t=this.createChildMenuBody(e.childMenuItems).getMenuElement();t.style.left="100%",t.style.top="0%",e.element.appendChild(t),e.element.onmousedown=function(e){e.stopPropagation()},e.element.onclick=function(e){e.stopPropagation()}}else e.element.onmousedown=function(e){e.stopPropagation()},e.element.onclick=function(t){apogeeapp.ui.Menu.hideActiveMenu(),e.eventName?e.eventManager.dispatchEvent(e.eventName,e.eventData):e.callback&&e.callback(),t.stopPropagation()};this.menuDiv.appendChild(e.element),this.menuItems[e.title]=e},apogeeapp.ui.MenuBody.prototype.setMenuItems=function(e){for(var t=0;t<e.length;t++)this.addMenuItem(e[t])},apogeeapp.ui.MenuBody.prototype.removeMenuItem=function(e){var t=this.menuItems[e];t&&(this.menuDiv.removeChild(t.element),delete this.menuItems[e])},apogeeapp.ui.MenuBody.prototype.createMenuElement=function(){this.menuDiv=apogeeapp.ui.createElementWithClass("div","visiui-menu-body")},apogeeapp.ui.MenuBody.prototype.constructItemsForShow=function(){if(this.menuItemsCallback){var e=this.menuItemsCallback();this.setMenuItems(e)}},apogeeapp.ui.MenuBody.prototype.destroyItemsForHides=function(){this.menuDiv&&apogeeapp.ui.removeAllChildren(this.menuDiv),this.menuItems={}},apogeeapp.ui.MenuBody.prototype.createChildMenuBody=function(e){var t=new apogeeapp.ui.MenuBody;return t.setMenuItems(e),t},apogeeapp.jsonedit={};var OBJECT_CONSTRUCTOR={}.constructor,ARRAY_CONSTRUCTOR=[].constructor,STRING_CONSTRUCTOR="".constructor,NUMBER_CONSTRUCTOR=(0).constructor,BOOLEAN_CONSTRUCTOR=(!0).constructor;apogeeapp.jsonedit.getObjectType=function(e){return null==e?"value":e.constructor==OBJECT_CONSTRUCTOR?"object":e.constructor==ARRAY_CONSTRUCTOR?"array":"value"},apogeeapp.jsonedit.getValueType=function(e){return null==e?"null":e.constructor==STRING_CONSTRUCTOR?"string":e.constructor==NUMBER_CONSTRUCTOR?"number":e.constructor==BOOLEAN_CONSTRUCTOR?"boolean":"other"},apogeeapp.jsonedit.isBoolString=function(e){return"false"===e||"true"===e},apogeeapp.jsonedit.isNullString=function(e){return"null"===e},apogeeapp.jsonedit.canBeConvertedToNonString=function(e){return isFinite(e)||apogeeapp.jsonedit.isBoolString(e)||apogeeapp.jsonedit.isNullString(e)},apogeeapp.jsonedit.stringToNonString=function(stringValue){var stringToValueCode="value = "+stringValue,value;try{return eval(stringToValueCode),value}catch(e){return stringValue}};var PIXELS_PER_INDENT=10;apogeeapp.jsonedit.createIndentElement=function(e){var t=document.createElement("div");return t.className="indentCell",t.style.width=PIXELS_PER_INDENT*e+"px",t},apogeeapp.jsonedit.createObjectDelimiter=function(e){var t=document.createElement("div");return t.className="objectDelimCell",t.innerHTML=e,t},apogeeapp.jsonedit.createExpandButton=function(e){var t=document.createElement("div");return t.className="buttonCell",t.innerHTML="+",t.onclick=function(){e.setExpanded(!0)},t},apogeeapp.jsonedit.createContractButton=function(e){var t=document.createElement("div");return t.className="buttonCell",t.innerHTML="-",t.onclick=function(){e.setExpanded(!1)},t},apogeeapp.jsonedit.KeyEntry=function(e,t,p,a,o,n,i){this.editArea=e,this.key=p,this.type=a,this.data=o,this.isEditable=n,this.indentLevel=t.getIndentLevel()+1,this.parentValue=t,this.isVirtual=i,this.body=null,this.keyEditObject=null,this.valueEntry=null,this.createBody(this.data)},apogeeapp.jsonedit.KeyEntry.prototype.setKey=function(e){this.key=e,this.keyEditObject.setValue(e)},apogeeapp.jsonedit.KeyEntry.prototype.getInitialKey=function(){return this.key},apogeeapp.jsonedit.KeyEntry.prototype.getCurrentKey=function(){return this.keyEditObject.getValue()},apogeeapp.jsonedit.KeyEntry.prototype.getCurrentValue=function(){return this.valueEntry.getCurrentValue()},apogeeapp.jsonedit.KeyEntry.prototype.getElement=function(){return this.body},apogeeapp.jsonedit.KeyEntry.prototype.getParentValueObject=function(){return this.parentValue},apogeeapp.jsonedit.KeyEntry.prototype.getIndentLevel=function(){return this.indentLevel},apogeeapp.jsonedit.KeyEntry.prototype.setIsVirtual=function(e){this.isVirtual=e,this.keyEditObject.setIsVirtual(e),this.valueEntry.setIsVirtual(e)},apogeeapp.jsonedit.KeyEntry.prototype.updateValueElements=function(){apogeeapp.ui.removeAllChildren(this.body),this.formatBody()},apogeeapp.jsonedit.KeyEntry.prototype.createBody=function(e){this.body=document.createElement("div"),this.body.className="jsonBody",this.createKeyElement(),this.valueEntry=new apogeeapp.jsonedit.ValueEntry(this.editArea,this,e,this.isEditable,this.isVirtual),this.formatBody()},apogeeapp.jsonedit.KeyEntry.prototype.formatBody=function(){this.body.appendChild(apogeeapp.jsonedit.createIndentElement(this.indentLevel)),this.body.appendChild(this.keyEditObject.getElement());for(var e=this.valueEntry.getElementList(),t=0;t<e.length;t++)this.body.appendChild(e[t])},apogeeapp.jsonedit.KeyEntry.prototype.createKeyElement=function(){var e=this.type===apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY&&this.isEditable;if(this.keyEditObject=new apogeeapp.jsonedit.EditField(this.key,this.type,e,this.isVirtual),e){var t=this,p=function(e){t.isVirtual&&t.parentValue.makeVirtualEntryReal(),t.editArea.valueEdited()};this.keyEditObject.setOnEditCallback(p);var a=function(e){t.navigateCells(e)};this.keyEditObject.setNavCallback(a)}},apogeeapp.jsonedit.KeyEntry.prototype.navigateCells=function(e){this.parentValue&&this.parentValue.navigateChildren(this,!0,e)},apogeeapp.jsonedit.KeyEntry.prototype.loadContextMenu=function(e,t){var p=this,a=this.parentValue,o=this.keyEditObject.getElement(),n=this.valueEntry,i=n.getType(),r=this.isVirtual;o.oncontextmenu=function(o){if(o.preventDefault(),o.stopPropagation(),p.isEditable){var s=new apogeeapp.ui.MenuBody;r||(s.addCallbackMenuItem("Insert Above",function(){a.insertElement("","",t)}),s.addCallbackMenuItem("Insert Below",function(){a.insertElement("","",t+1)}),t>0&&s.addCallbackMenuItem("Move Up",function(){a.moveChildKeyToNextIndex(t-1)}),t<e-1&&s.addCallbackMenuItem("Move Down",function(){a.moveChildKeyToNextIndex(t)}),p.isVirtual||s.addCallbackMenuItem("Delete Entry",function(){a.deleteChildElement(p)}),"value"==i?(s.addCallbackMenuItem("Convert To Object",function(){n.valueToObject()}),s.addCallbackMenuItem("Convert To Array",function(){n.valueToArray()}),n.convertibleToNumber()&&s.addCallbackMenuItem("Convert To Number",function(){n.valueToNonString()}),n.convertibleToBool()&&s.addCallbackMenuItem("Convert To Boolean",function(){n.valueToNonString()}),n.convertibleToNull()&&s.addCallbackMenuItem("Convert To Null",function(){n.valueToNonString()}),n.convertibleToString()&&s.addCallbackMenuItem("Convert To String",function(){n.valueToString()})):"object"==i?(s.addCallbackMenuItem("Convert To Value",function(){n.convertToValue()}),s.addCallbackMenuItem("Convert To Array",function(){n.objectToArray()})):"array"==i&&(s.addCallbackMenuItem("Convert To Value",function(){n.convertToValue()}),s.addCallbackMenuItem("Convert To Object",function(){n.arrayToObject()}))),apogeeapp.ui.Menu.showContextMenu(s,o)}},"value"==i&&(this.valueEntry.getValueEditObject().getElement().oncontextmenu=o.oncontextmenu)},apogeeapp.jsonedit.KeyEntry.prototype.convertToKeyType=function(e){this.type!=apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY&&(this.type=apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY,this.key=String(e),this.createKeyElement(),apogeeapp.ui.removeAllChildren(this.body),this.formatBody())},apogeeapp.jsonedit.KeyEntry.prototype.convertToIndexType=function(e){this.type!=apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX&&(this.type=apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX,this.key=e,this.createKeyElement(),apogeeapp.ui.removeAllChildren(this.body),this.formatBody())},apogeeapp.jsonedit.ValueEntry=function(e,t,p,a,o){this.editArea=e,this.parent=t,this.data=p,this.isEditable=a,this.type=apogeeapp.jsonedit.getObjectType(p),this.indentLevel=t.getIndentLevel()+1,this.elementList=[],this.isVirtual=o,this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.listDiv=null,this.isExpanded=!0,this.expandedList=[],this.contractedList=[],"value"==this.type?this.createValueEntry(this.data):(this.createChildKeyEntries(this.data),this.updateChildKeys(),this.createElementList())},apogeeapp.jsonedit.ValueEntry.prototype.getInitialValue=function(){return this.data},apogeeapp.jsonedit.ValueEntry.prototype.getCurrentValue=function(){var e,t,p;if("value"==this.type)e=this.valueEditObject.getValue();else if("object"==this.type)for(e={},t=0;t<this.childKeyEntries.length;t++)e[(p=this.childKeyEntries[t]).getCurrentKey()]=p.getCurrentValue();else if("array"==this.type)for(e=[],t=0;t<this.childKeyEntries.length;t++)p=this.childKeyEntries[t],e[t]=p.getCurrentValue();return e},apogeeapp.jsonedit.ValueEntry.prototype.getType=function(){return this.type},apogeeapp.jsonedit.ValueEntry.prototype.setExpanded=function(e){this.isExpanded=e,this.doExpandContract()},apogeeapp.jsonedit.ValueEntry.prototype.getElementList=function(){return this.elementList},apogeeapp.jsonedit.ValueEntry.prototype.getValueEditObject=function(){return this.valueEditObject},apogeeapp.jsonedit.ValueEntry.prototype.getIndentLevel=function(){return this.indentLevel},apogeeapp.jsonedit.ValueEntry.prototype.setIsVirtual=function(e){this.isVirtual=e,this.valueEditObject.setIsVirtual(e)},apogeeapp.jsonedit.ValueEntry.prototype.navigateCells=function(e){var t=this.parent.getParentValueObject();t&&t.navigateChildren(this.parent,!1,e)},apogeeapp.jsonedit.ValueEntry.prototype.navigateChildren=function(e,t,p){var a,o=!1,n=0;if("array"==this.type?p==apogeeapp.jsonedit.EditField.DIRECTION_NEXT||p==apogeeapp.jsonedit.EditField.DIRECTION_DOWN?(a=!t)&&(o=!1,n=1):p==apogeeapp.jsonedit.EditField.DIRECTION_PREV||p==apogeeapp.jsonedit.EditField.DIRECTION_UP?(a=!t)&&(o=!1,n=-1):p!=apogeeapp.jsonedit.EditField.DIRECTION_RIGHT&&p!=apogeeapp.jsonedit.EditField.DIRECTION_LEFT||(a=!1):"object"==this.type&&(p==apogeeapp.jsonedit.EditField.DIRECTION_NEXT?(a=!0,o=!t,n=t?0:1):p==apogeeapp.jsonedit.EditField.DIRECTION_PREV?(a=!0,o=!t,n=t?-1:0):p==apogeeapp.jsonedit.EditField.DIRECTION_RIGHT?(a=t)&&(o=!1,n=0):p==apogeeapp.jsonedit.EditField.DIRECTION_LEFT?(a=!t)&&(o=!0,n=0):p==apogeeapp.jsonedit.EditField.DIRECTION_UP?(a=!0,o=t,n=-1):p==apogeeapp.jsonedit.EditField.DIRECTION_DOWN&&(a=!0,o=t,n=1)),a){var i,r,s=-1,l=null;if((i=e==this.virtualChildKey?this.childKeyEntries.length:this.childKeyEntries.indexOf(e))>=0&&((s=i+n)>=0&&s<this.childKeyEntries.length?l=this.childKeyEntries[s]:s==this.childKeyEntries.length&&(l=this.virtualChildKey)),l)if(o)r=l.keyEditObject;else{var d=l.valueEntry;"value"==d.getType()&&(r=d.valueEditObject)}r&&r.startEdit()}},apogeeapp.jsonedit.ValueEntry.prototype.insertElement=function(e,t,p){var a;void 0===p&&(p=this.childKeyEntries.length);var o;if(o=p>=this.childKeyEntries.length?this.virtualChildKey.getElement():this.childKeyEntries[p].getElement(),"object"==this.type)a=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,e,"key",t,this.isEditable,!1);else if("array"==this.type){a=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,p,"index",t,this.isEditable,!1);for(var n=p+1;n<this.childKeyEntries.length;n++)this.childKeyEntries[n].setKey(n);this.virtualChildKey.setKey(this.childKeyEntries.length+1)}this.childKeyEntries.splice(p,0,a),this.updateChildKeys(),this.listDiv.insertBefore(a.getElement(),o)},apogeeapp.jsonedit.ValueEntry.prototype.moveChildKeyToNextIndex=function(e){if(e<0||e>=this.childKeyEntries.length-1)alert("Can not make the specified key move");else{var t=this.childKeyEntries[e],p=this.childKeyEntries[e+1];this.childKeyEntries[e]=p,this.childKeyEntries[e+1]=t,this.updateChildKeys(),this.listDiv.insertBefore(p.getElement(),t.getElement())}},apogeeapp.jsonedit.ValueEntry.prototype.deleteChildElement=function(e){var t=this.childKeyEntries.indexOf(e);-1!=t?(this.childKeyEntries.splice(t,1),this.updateChildKeys(),this.listDiv.removeChild(e.getElement())):alert("Element not found!")},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToNumber=function(){if("value"===this.type){var e=this.getCurrentValue();if("string"===apogeeapp.jsonedit.getValueType(e))return isFinite(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToBool=function(){if("value"===this.type){var e=this.getCurrentValue();if("string"===apogeeapp.jsonedit.getValueType(e))return apogeeapp.jsonedit.isBoolString(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToNull=function(){if("value"===this.type){var e=this.getCurrentValue();if("string"===apogeeapp.jsonedit.getValueType(e))return apogeeapp.jsonedit.isNullString(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.valueToNonString=function(){var e=this.getCurrentValue(),t=apogeeapp.jsonedit.stringToNonString(e);this.valueEditObject.setValue(t),this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToString=function(){if("value"===this.type){var e=this.getCurrentValue();return"string"!==apogeeapp.jsonedit.getValueType(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.valueToString=function(){var e=this.getCurrentValue(),t=String(e);this.valueEditObject.setValue(t),this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.valueToArray=function(){if("value"==!this.type)throw"Type value expected. Found "+this.type;this.type="array";var e=[this.valueEditObject.getValue()];if(this.createChildKeyEntries(e),this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.valueToObject=function(){if("value"==!this.type)throw"Type value expected. Found "+this.type;this.type="object";var e={a:this.valueEditObject.getValue()};if(this.createChildKeyEntries(e),this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.objectToArray=function(){if("object"==!this.type)throw"Type object expected. Found "+this.type;this.type="array";var e=0;if(this.childKeyEntries)for(e=0;e<this.childKeyEntries.length;e++)this.childKeyEntries[e].convertToIndexType(e);if(this.virtualChildKey&&this.virtualChildKey.convertToIndexType(e),this.valueEditObject=null,this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.arrayToObject=function(){if("array"==!this.type)throw"Type array expected. Found "+this.type;this.type="object";var e=0;if(this.childKeyEntries)for(e=0;e<this.childKeyEntries.length;e++)this.childKeyEntries[e].convertToKeyType(String(e));if(this.virtualChildKey&&this.virtualChildKey.convertToKeyType(""),this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.convertToValue=function(){if("value"!=this.type){this.type="value";var e;if(e=this.childKeyEntries&&this.childKeyEntries.length>0?this.childKeyEntries[0].getCurrentValue():"",this.createValueEntry(e),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()}},apogeeapp.jsonedit.ValueEntry.prototype.createValueEntry=function(e){"value"==this.type&&(this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.elementList=[],this.createValueElement(e),this.listDiv=null,this.contractedList=null,this.expandedList=null)},apogeeapp.jsonedit.ValueEntry.prototype.createChildKeyEntries=function(e){if("value"!=this.type){this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.elementList=[];var t;if("object"==this.type){for(var p in e)t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,p,"key",e[p],this.isEditable,!1),this.childKeyEntries.push(t);this.isEditable&&(t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,"","key","",this.isEditable,!0),this.virtualChildKey=t)}else if("array"==this.type){for(var a=0;a<e.length;a++)t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,a,"index",e[a],this.isEditable,!1),this.childKeyEntries.push(t);this.isEditable&&(t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,a,"index","",this.isEditable,!0),this.virtualChildKey=t)}}},apogeeapp.jsonedit.ValueEntry.prototype.createElementList=function(){this.listDiv=document.createElement("div"),this.elementList=[],this.contractedList=[],this.expandedList=[];for(var e,t,p,a,o=apogeeapp.jsonedit.createIndentElement(this.indentLevel),n=0;n<this.childKeyEntries.length;n++)a=this.childKeyEntries[n],this.listDiv.appendChild(a.getElement());this.virtualChildKey&&this.listDiv.appendChild(this.virtualChildKey.getElement());var i=apogeeapp.jsonedit.createExpandButton(this),r=apogeeapp.jsonedit.createContractButton(this);"object"==this.type?(e=apogeeapp.jsonedit.createObjectDelimiter("{"),t=apogeeapp.jsonedit.createObjectDelimiter("}"),p=apogeeapp.jsonedit.createObjectDelimiter("}")):"array"==this.type&&(e=apogeeapp.jsonedit.createObjectDelimiter("["),t=apogeeapp.jsonedit.createObjectDelimiter("]"),p=apogeeapp.jsonedit.createObjectDelimiter("]")),this.elementList.push(e),this.elementList.push(i),this.contractedList.push(i),this.elementList.push(t),this.contractedList.push(t),this.elementList.push(r),this.expandedList.push(r),(this.childKeyEntries.length>0||this.virtualChildKey)&&(this.elementList.push(this.listDiv),this.expandedList.push(this.listDiv),this.elementList.push(o),this.expandedList.push(o)),this.elementList.push(p),this.expandedList.push(p),this.doExpandContract()},apogeeapp.jsonedit.ValueEntry.prototype.updateChildKeys=function(){var e,t;if("object"==this.type){var p;e=0;for(p in this.childKeyEntries)e++;t=0;for(p in this.childKeyEntries){var a=this.childKeyEntries[p];a.loadContextMenu(e,t),t++}this.virtualChildKey&&this.virtualChildKey.loadContextMenu(e,e)}else if("array"==this.type){for(e=this.childKeyEntries.length,t=0;t<e;t++)(a=this.childKeyEntries[t]).getCurrentKey()!=t&&a.setKey(t),a.loadContextMenu(e,t);this.virtualChildKey&&(this.virtualChildKey.getCurrentKey()!=e&&this.virtualChildKey.setKey(e),this.virtualChildKey.loadContextMenu(e,e))}},apogeeapp.jsonedit.ValueEntry.prototype.doExpandContract=function(){if(this.expandedList&&this.contractedList){var e,t=this.isExpanded?this.expandedList:this.contractedList,p=this.isExpanded?this.contractedList:this.expandedList;for(e=0;e<t.length;e++)t[e].style.display="";for(e=0;e<p.length;e++)p[e].style.display="none"}},apogeeapp.jsonedit.ValueEntry.prototype.createValueElement=function(e){this.valueEditObject=new apogeeapp.jsonedit.EditField(e,apogeeapp.jsonedit.EditField.FIELD_TYPE_VALUE,this.isEditable,this.isVirtual);var t=this;this.valueEditObject.setOnEditCallback(function(e){if(t.isVirtual){var p=t.parent.getParentValueObject();p&&p.makeVirtualEntryReal()}t.editArea.valueEdited()});this.valueEditObject.setNavCallback(function(e){t.navigateCells(e)});var p=this.valueEditObject.getElement();this.elementList.push(p)},apogeeapp.jsonedit.ValueEntry.prototype.makeVirtualEntryReal=function(e){var t=this.virtualChildKey;t.setIsVirtual(!1),this.childKeyEntries.push(t);var p;"object"==this.type?(p=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,"","key","",this.isEditable,!0),this.virtualChildKey=p):"array"==this.type&&(p=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,this.childKeyEntries.length,"index","",this.isEditable,!0),this.virtualChildKey=p),this.updateChildKeys(),this.createElementList(),this.parent.updateValueElements()},apogeeapp.jsonedit.EditField=function(e,t,p,a){this.fieldType=t,this.isEditable=p,this.isVirtual=a,this.element=document.createElement("div"),this.onEdit=null,this.onNavigate=null,this.editField=null;var o=this;this.element.onclick=function(){o.onClick()},this.setValue(e)},apogeeapp.jsonedit.EditField.FIELD_TYPE_VALUE="value",apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY="key",apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX="index",apogeeapp.jsonedit.EditField.prototype.setOnEditCallback=function(e){return this.onEdit=e},apogeeapp.jsonedit.EditField.prototype.setNavCallback=function(e){this.onNavigate=e},apogeeapp.jsonedit.EditField.prototype.setIsVirtual=function(e){this.isVirtual=e,this.setCssClass()},apogeeapp.jsonedit.EditField.prototype.getValue=function(){return this.value},apogeeapp.jsonedit.EditField.prototype.setValue=function(e){void 0===e&&(e=null,console.log("The value undefined is not valid for a JSON. It has been converted to null.")),this.value=e,this.isString="string"===apogeeapp.jsonedit.getValueType(e),this.setCssClass(),this.element.innerHTML=null===e?"null":""===e?"&nbsp;":e},apogeeapp.jsonedit.EditField.prototype.setCssClass=function(){var e="cell_base cell_"+this.fieldType;this.isVirtual?e+="_virtual":"value"===this.fieldType&&(this.isString?e+="_string":e+="_nonstring"),this.element.className=e},apogeeapp.jsonedit.EditField.prototype.getElement=function(){return this.element},apogeeapp.jsonedit.EditField.prototype.onClick=function(){this.isEditable&&!this.editField&&this.startEdit()},apogeeapp.jsonedit.EditField.prototype.startEdit=function(){if(!this.editField){var e,t=getSelection();t.anchorNode.parentNode==this.element?(e={},t.anchorOffset<=t.focusOffset?(e.start=t.anchorOffset,e.end=t.focusOffset):(e.start=t.focusOffset,e.end=t.anchorOffset)):e=null,this.editField=document.createElement("input"),this.editField.type="text",void 0!==this.value&&(this.editField.value=this.value),apogeeapp.ui.removeAllChildren(this.element),this.element.appendChild(this.editField),e?this.editField.setSelectionRange(e.start,e.end):this.editField.select(),this.editField.focus();var p=this;this.editField.onblur=function(){p.endEdit()},this.editField.onkeydown=function(e){p.onKeyDown(e)}}},apogeeapp.jsonedit.EditField.prototype.endEdit=function(){if(this.editField)if(this.editField.value!=this.value){var e,t=this.editField.value;e=this.isString&&""!==this.value?t:apogeeapp.jsonedit.canBeConvertedToNonString(t)?apogeeapp.jsonedit.stringToNonString(t):t,this.editField=null,this.setValue(e),this.onEdit&&this.onEdit(this.value)}else this.editField=null,this.element.innerHTML=this.value},apogeeapp.jsonedit.EditField.DIRECTION_NONE=0,apogeeapp.jsonedit.EditField.DIRECTION_UP=1,apogeeapp.jsonedit.EditField.DIRECTION_DOWN=2,apogeeapp.jsonedit.EditField.DIRECTION_RIGHT=3,apogeeapp.jsonedit.EditField.DIRECTION_LEFT=4,apogeeapp.jsonedit.EditField.DIRECTION_NEXT=5,apogeeapp.jsonedit.EditField.DIRECTION_PREV=6,apogeeapp.jsonedit.EditField.ENTER_KEY=13,apogeeapp.jsonedit.EditField.TAB_KEY=9,apogeeapp.jsonedit.EditField.UP_KEY=38,apogeeapp.jsonedit.EditField.DOWN_KEY=40,apogeeapp.jsonedit.EditField.RIGHT_KEY=39,apogeeapp.jsonedit.EditField.LEFT_KEY=37,apogeeapp.jsonedit.EditField.prototype.onKeyDown=function(e){var t=!1,p=apogeeapp.jsonedit.EditField.DIRECTION_NONE,a=!1;e.keyCode==apogeeapp.jsonedit.EditField.ENTER_KEY?(t=!0,p=e.shiftKey?apogeeapp.jsonedit.EditField.DIRECTION_PREV:apogeeapp.jsonedit.EditField.DIRECTION_NEXT,a=!0):e.keyCode==apogeeapp.jsonedit.EditField.TAB_KEY?(t=!0,p=e.shiftKey?apogeeapp.jsonedit.EditField.DIRECTION_PREV:apogeeapp.jsonedit.EditField.DIRECTION_NEXT,a=!0):e.keyCode==apogeeapp.jsonedit.EditField.UP_KEY?(t=!0,p=apogeeapp.jsonedit.EditField.DIRECTION_UP,a=!0):e.keyCode==apogeeapp.jsonedit.EditField.DOWN_KEY?(t=!0,p=apogeeapp.jsonedit.EditField.DIRECTION_DOWN,a=!0):e.keyCode==apogeeapp.jsonedit.EditField.RIGHT_KEY?this.cursorAtEndOfEditField()&&(t=!0,p=apogeeapp.jsonedit.EditField.DIRECTION_RIGHT,a=!0):e.keyCode==apogeeapp.jsonedit.EditField.LEFT_KEY&&this.cursorAtStartOfEditField()&&(t=!0,p=apogeeapp.jsonedit.EditField.DIRECTION_LEFT,a=!0),a&&(e.preventDefault(),e.stopPropagation()),t&&(this.endEdit(),p!=apogeeapp.jsonedit.EditField.DIRECTION_NONE&&this.onNavigate&&this.onNavigate(p))},apogeeapp.jsonedit.EditField.prototype.cursorAtStartOfEditField=function(){return 0==this.editField.selectionStart&&0==this.editField.selectionEnd},apogeeapp.jsonedit.EditField.prototype.cursorAtEndOfEditField=function(){var e=String(this.editField.value).length;return this.editField.selectionStart==e&&this.editField.selectionEnd==e},apogeeapp.jsonedit.JsonEditArea=function(e,t,p){this.body=e,this.isEditable=p,void 0===t&&(t=""),this.valueEntry=new apogeeapp.jsonedit.ValueEntry(this,this,t,this.isEditable),this.valueEntry.setExpanded(!0),this.formatBody()},apogeeapp.jsonedit.JsonEditArea.prototype.setEditCallback=function(e){this.editCallback=e},apogeeapp.jsonedit.JsonEditArea.prototype.getCurrentValue=function(){return this.valueEntry.getCurrentValue()},apogeeapp.jsonedit.JsonEditArea.prototype.getElement=function(){return this.body},apogeeapp.jsonedit.JsonEditArea.prototype.getParentValueObject=function(){},apogeeapp.jsonedit.JsonEditArea.prototype.getIndentLevel=function(){return 0},apogeeapp.jsonedit.JsonEditArea.prototype.formatBody=function(){for(var e=this.valueEntry.getElementList(),t=0;t<e.length;t++)this.body.appendChild(e[t]);this.loadContextMenu()},apogeeapp.jsonedit.JsonEditArea.prototype.loadContextMenu=function(){var e=this,t=this.body,p=this.valueEntry,a=p.getType();t.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation();var o=new apogeeapp.ui.MenuBody;o.addCallbackMenuItem("Get Value",function(){alert(JSON.stringify(p.getCurrentValue()))}),e.isEditable&&("value"==a?(o.addCallbackMenuItem("Convert To Object",function(){p.valueToObject()}),o.addCallbackMenuItem("Convert To Array",function(){p.valueToArray()}),p.convertibleToNumber()&&o.addCallbackMenuItem("Convert To Number",function(){p.valueToNonString()}),p.convertibleToBool()&&o.addCallbackMenuItem("Convert To Boolean",function(){p.valueToNonString()}),p.convertibleToNull()&&o.addCallbackMenuItem("Convert To Null",function(){p.valueToNonString()}),p.convertibleToString()&&o.addCallbackMenuItem("Convert To String",function(){p.valueToString()})):"object"==a?(o.addCallbackMenuItem("Convert To Value",function(){p.convertToValue()}),o.addCallbackMenuItem("Convert To Array",function(){p.objectToArray()})):"array"==a&&(o.addCallbackMenuItem("Convert To Value",function(){p.convertToValue()}),o.addCallbackMenuItem("Convert To Object",function(){p.arrayToObject()}))),apogeeapp.ui.Menu.showContextMenu(o,t)}},apogeeapp.jsonedit.JsonEditArea.prototype.updateValueElements=function(){apogeeapp.ui.removeAllChildren(this.body),this.formatBody()},apogeeapp.jsonedit.JsonEditArea.prototype.valueEdited=function(){this.editCallback&&this.editCallback()},apogeeapp.ui.setLoadListener=function(e,t,p){var a={position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",overflow:"hidden",zIndex:-1},o=apogeeapp.ui.createElement("iframe",null,a);o.onload=function(){var e=o.contentDocument.body;t&&t(),p&&(p(),e.onresize=p)},e.appendChild(o)},apogeeapp.ui.removeResizeListener=function(e,t){alert("implement this!")},apogeeapp.ui.DisplayAndHeader=function(e,t,p,a){this.container=apogeeapp.ui.createElementWithClass("div","visiui-dnh-container"),this.header=apogeeapp.ui.createElementWithClass("div","visiui-dnh-header",this.container),this.body=apogeeapp.ui.createElementWithClass("div","visiui-dnh-body",this.container),this.headerStyleClass=t,this.bodyStyleClass=a,this.headerContent=document.createElement("div"),this.header.appendChild(this.headerContent),this.bodyContent=document.createElement("div"),this.body.appendChild(this.bodyContent),this.setHeaderType(e),this.setBodyType(p)},apogeeapp.ui.DisplayAndHeader.FIXED_PANE="visiui-dnh-fixed",apogeeapp.ui.DisplayAndHeader.SCROLLING_PANE="visiui-dnh-scrolling",apogeeapp.ui.DisplayAndHeader.prototype.setHeaderType=function(e){var t=e;this.headerStyleClass&&(t+=" "+this.headerStyleClass),this.headerContent.className=t},apogeeapp.ui.DisplayAndHeader.prototype.setBodyType=function(e){var t=e;this.bodyStyleClass&&(t+=" "+this.bodyStyleClass),this.bodyContent.className=t},apogeeapp.ui.DisplayAndHeader.prototype.getOuterElement=function(){return this.container},apogeeapp.ui.DisplayAndHeader.prototype.getHeaderContainer=function(){return this.header},apogeeapp.ui.DisplayAndHeader.prototype.getBodyContainer=function(){return this.body},apogeeapp.ui.DisplayAndHeader.prototype.getHeader=function(){return this.headerContent},apogeeapp.ui.DisplayAndHeader.prototype.getBody=function(){return this.bodyContent},apogeeapp.ui.SplitPane=function(e,t){this.container1=apogeeapp.ui.createElementWithClass("div","visiui-sp-parent");var p=apogeeapp.ui.createElementWithClass("div","visiui-sp-parent2",this.container1),a=apogeeapp.ui.createElementWithClass("table","visiui-sp-table",p),o=apogeeapp.ui.createElementWithClass("tr","visiui-sp-row",a),n=apogeeapp.ui.createElementWithClass("td","visiui-sp-left",o),i=apogeeapp.ui.createElementWithClass("td","visiui-sp-divider",o),r=apogeeapp.ui.createElementWithClass("td","visiui-sp-right",o),s=apogeeapp.ui.createElementWithClass("div","visiui-sp-inner",n);this.leftOuterPane=apogeeapp.ui.createElementWithClass("div",e,s);var l=apogeeapp.ui.createElementWithClass("div","visiui-sp-inner",r);this.rightOuterPane=apogeeapp.ui.createElementWithClass("div",t,l);var d=!1,u=0,c=0,g=function(e){if(d){var t=e.clientX-u;n.style.width=c+t+"px"}},h=function(e){E()},m=function(e){E()},E=function(){d=!1,a.removeEventListener("mouseup",h),a.removeEventListener("mousemove",g),a.removeEventListener("mouseleave",m)};i.addEventListener("mousedown",function(e){d=!0,u=e.clientX,c=n.offsetWidth,a.addEventListener("mouseup",h),a.addEventListener("mousemove",g),a.addEventListener("mouseleave",m)})},apogeeapp.ui.SplitPane.SCROLLING_PANE="visiui-sp-scrolling",apogeeapp.ui.SplitPane.FIXED_PANE="visiui-sp-fixed",apogeeapp.ui.SplitPane.prototype.getOuterElement=function(){return this.container1},apogeeapp.ui.SplitPane.prototype.getLeftPaneContainer=function(){return this.leftOuterPane},apogeeapp.ui.SplitPane.prototype.getRightPaneContainer=function(){return this.rightOuterPane},apogeeapp.ui.treecontrol||(apogeeapp.ui.treecontrol={}),apogeeapp.ui.treecontrol.TreeControl=function(){this.list=apogeeapp.ui.createElementWithClass("ul","visiui-tc-child-list",this.element)},apogeeapp.ui.treecontrol.TreeControl.prototype.getElement=function(){return this.list},apogeeapp.ui.treecontrol.TreeControl.prototype.setRootEntry=function(e){this.clearRootEntry(),this.list.appendChild(e.getElement())},apogeeapp.ui.treecontrol.TreeControl.prototype.clearRootEntry=function(){apogeeapp.ui.removeAllChildren(this.list)},apogeeapp.ui.treecontrol||(apogeeapp.ui.treecontrol={}),apogeeapp.ui.treecontrol.TreeEntry=function(e,t,p,a,o){this.contractUrl=apogeeapp.ui.getResourcePath("/contractPlus2.png"),this.expandUrl=apogeeapp.ui.getResourcePath("/expandPlus2.png"),this.noControlUrl=apogeeapp.ui.getResourcePath("/nothingPlus2.png"),this.emptyControlUrl=apogeeapp.ui.getResourcePath("/emptyPlus2.png"),this.isRoot=o;var n;n=o?"visiui-tc-root":"visiui-tc-child",this.element=apogeeapp.ui.createElementWithClass("li",n),this.control=apogeeapp.ui.createElementWithClass("img","visiui-tc-control",this.element),t&&(this.iconContainerElement=apogeeapp.ui.createElementWithClass("div","visiui-tc-icon-container",this.element),a?(this.menu=apogeeapp.ui.Menu.createMenuFromImage(t),this.menu.setAsOnTheFlyMenu(a),this.iconContainerElement.appendChild(this.menu.getElement())):(this.icon=apogeeapp.ui.createElementWithClass("img","visiui-tc-icon",this.iconContainerElement),this.icon.src=t),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_tc_icon_overlay",this.iconContainerElement)),this.label=apogeeapp.ui.createElementWithClass("div","visiui-tc-label",this.element),e&&this.setLabel(e),this.childList=null,this.childMap={},this.setState(apogeeapp.ui.treecontrol.NO_CONTROL);this.label.oncontextmenu=function(e){var t=new apogeeapp.ui.MenuBody,p=a();t.setMenuItems(p),apogeeapp.ui.Menu.showContextMenu(t,e)},p&&(this.label.ondblclick=p)},apogeeapp.ui.treecontrol.NO_CONTROL=0,apogeeapp.ui.treecontrol.EXPANDED=1,apogeeapp.ui.treecontrol.COLLAPSED=-1,apogeeapp.ui.treecontrol.DEFAULT_STATE=apogeeapp.ui.treecontrol.COLLAPSED,apogeeapp.ui.treecontrol.TreeEntry.prototype.getElement=function(){return this.element},apogeeapp.ui.treecontrol.TreeEntry.prototype.setLabel=function(e){this.label.innerHTML=e},apogeeapp.ui.treecontrol.TreeEntry.prototype.addChild=function(e,t){this.childList||(this.childList=apogeeapp.ui.createElementWithClass("ul","visiui-tc-child-list",this.element),this.setState(apogeeapp.ui.treecontrol.DEFAULT_STATE)),this.childMap[e]=t,this.childList.appendChild(t.getElement())},apogeeapp.ui.treecontrol.TreeEntry.prototype.removeChild=function(e){if(this.childList){var t=this.childMap[e];t&&(delete this.childMap[e],this.childList.removeChild(t.getElement()),0===this.childList.childElementCount&&(this.element.removeChild(this.childList),this.childList=null,this.setState(apogeeapp.ui.treecontrol.NO_CONTROL)))}},apogeeapp.ui.treecontrol.TreeEntry.prototype.setState=function(e){if(this.state=e,this.state==apogeeapp.ui.treecontrol.NO_CONTROL)this.isRoot?this.control.src=this.emptyControlUrl:this.control.src=this.noControlUrl;else if(this.state==apogeeapp.ui.treecontrol.EXPANDED){if(this.control.src=this.contractUrl,!this.collapse){t=this;this.collapse=function(){t.setState(apogeeapp.ui.treecontrol.COLLAPSED)}}this.control.onclick=this.collapse,this.childList.style.display=""}else if(this.state==apogeeapp.ui.treecontrol.COLLAPSED){if(this.control.src=this.expandUrl,!this.expand){var t=this;this.expand=function(){t.setState(apogeeapp.ui.treecontrol.EXPANDED)}}this.control.onclick=this.expand,this.childList.style.display="none"}},apogeeapp.ui.treecontrol.TreeEntry.prototype.setIconOverlay=function(e){this.clearIconOverlay(),e&&this.iconOverlayElement.appendChild(e)},apogeeapp.ui.treecontrol.TreeEntry.prototype.clearIconOverlay=function(){apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.app={},apogeeapp.app.dialog={},apogeeapp.app.Apogee=function(e){apogee.EventManager.init.call(this),this.workspaceUI=null,this.componentGenerators={},this.standardComponents=[],this.additionalComponents=[],this.linkManager=new apogeeapp.app.LinkManager,this.loadComponentGenerators(),this.createUI(e);var t=apogee.util.readQueryField("url",document.URL);t&&apogeeapp.app.openworkspace.openWorkspaceFromUrl(this,t)},apogee.base.mixin(apogeeapp.app.Apogee,apogee.EventManager),apogeeapp.app.Apogee.DEFAULT_WORKSPACE_NAME="workspace",apogeeapp.app.Apogee.prototype.getWorkspaceUI=function(){return this.workspaceUI},apogeeapp.app.Apogee.prototype.getWorkspace=function(){return this.workspaceUI?this.workspaceUI.getWorkspace():null},apogeeapp.app.Apogee.prototype.setWorkspaceUI=function(e){if(this.workspaceUI)throw apogee.base.createError("There is already an open workspace",!1);return e.setApp(this,this.tabFrame,this.treePane),this.workspaceUI=e,!0},apogeeapp.app.Apogee.prototype.clearWorkspaceUI=function(){return this.workspaceUI=null,!0},apogeeapp.app.Apogee.prototype.updateWorkspaceLinks=function(e,t,p,a){this.linkManager.updateWorkspaceLinks(e,t,p,a)},apogeeapp.app.Apogee.prototype.registerComponent=function(e){var t=e.uniqueName;this.componentGenerators[t]?alert("There is already a registered component with this name. Either the component has already been added of the name is not unique."):(this.componentGenerators[t]=e,this.additionalComponents.push(t))},apogeeapp.app.Apogee.prototype.getComponentGenerator=function(e){return this.componentGenerators[e]},apogeeapp.app.Apogee.prototype.loadComponentGenerators=function(){this.registerStandardComponent(apogeeapp.app.JsonTableComponent.generator),this.registerStandardComponent(apogeeapp.app.GridTableComponent.generator),this.registerStandardComponent(apogeeapp.app.TextComponent.generator),this.registerStandardComponent(apogeeapp.app.FolderComponent.generator),this.registerStandardComponent(apogeeapp.app.FunctionComponent.generator),this.registerStandardComponent(apogeeapp.app.FolderFunctionComponent.generator),this.registerComponent(apogeeapp.app.CustomControlComponent.generator)},apogeeapp.app.Apogee.prototype.registerStandardComponent=function(e){var t=e.uniqueName;this.componentGenerators[t]?alert("There is already a registered component with this name. Either the component has already been added of the name is not unique."):(this.componentGenerators[t]=e,this.standardComponents.push(t))},apogeeapp.app.Apogee.prototype.createUI=function(e){var t=apogeeapp.ui.initWindows(e).baseElement,p=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null);t.appendChild(p.getOuterElement());var a=this.createMenuBar();p.getHeader().appendChild(a);var o=new apogeeapp.ui.SplitPane(apogeeapp.ui.SplitPane.SCROLLING_PANE,apogeeapp.ui.SplitPane.FIXED_PANE);p.getBody().appendChild(o.getOuterElement()),this.treePane=o.getLeftPaneContainer(),this.tabFrame=new apogeeapp.ui.TabFrame,o.getRightPaneContainer().appendChild(this.tabFrame.getElement());var n=this;this.tabFrame.addListener(apogeeapp.ui.SHOWN_EVENT,function(e){n.onTabShown(e)}),this.tabFrame.addListener(apogeeapp.ui.HIDDEN_EVENT,function(e){n.onTabHidden(e)})},apogeeapp.app.Apogee.prototype.onTabHidden=function(e){this.activeTabIconDisplay.style.display="none",this.activeTabTitleDisplay.style.display="none"},apogeeapp.app.Apogee.prototype.onTabShown=function(e){if(this.workspaceUI){var t=e.getId(),p=this.workspaceUI.getComponentById(t);p&&(this.activeTabIconDisplay.src=p.getIconUrl(),this.activeTabTitleDisplay.innerHTML=p.getMember().getDisplayName(!0),this.activeTabIconDisplay.style.display="",this.activeTabTitleDisplay.style.display="")}},apogeeapp.app.Apogee.prototype.createMenuBar=function(){var e,t,p={},a=apogeeapp.ui.createElementWithClass("div","menu_bar"),o=apogeeapp.ui.createElementWithClass("div","menu_bar_left",a),n=apogeeapp.ui.createElementWithClass("div","menu_bar_right",a);t="Workspace",e=apogeeapp.ui.Menu.createMenu(t),o.appendChild(e.getElement()),p[t]=e;var i=apogeeapp.app.createworkspace.getCreateCallback(this);e.addCallbackMenuItem("New",i);var r=apogeeapp.app.openworkspace.getOpenCallback(this);e.addCallbackMenuItem("Open",r);var s=apogeeapp.app.saveworkspace.getSaveCallback(this);e.addCallbackMenuItem("Save",s);var l=apogeeapp.app.closeworkspace.getCloseCallback(this);e.addCallbackMenuItem("Close",l),t="Components",e=apogeeapp.ui.Menu.createMenu(t),o.appendChild(e.getElement()),p[t]=e,e.setMenuItems(this.getAddChildMenuItems()),t="Libraries",e=apogeeapp.ui.Menu.createMenu(t),o.appendChild(e.getElement()),p[t]=e;var d=apogeeapp.app.updatelinks.getUpdateLinksCallback(this);e.addCallbackMenuItem("Update Links",d);var u=apogeeapp.app.importworkspace.getImportCallback(this,apogeeapp.app.FolderComponent.generator);e.addCallbackMenuItem("Import as Folder",u);var c=apogeeapp.app.importworkspace.getImportCallback(this,apogeeapp.app.FolderFunctionComponent.generator);e.addCallbackMenuItem("Import as Folder Function",c);var g=apogeeapp.app.exportworkspace.getExportCallback(this);return e.addCallbackMenuItem("Export as Workspace",g),this.addToMenuBar&&this.addToMenuBar(a,p),this.activeTabIconDisplay=apogeeapp.ui.createElementWithClass("img","tab-icon-display",n),this.activeTabIconDisplay.style.display="none",this.activeTabTitleDisplay=apogeeapp.ui.createElementWithClass("div","tab-title-display",n),this.activeTabTitleDisplay.style.display="none",a},apogeeapp.app.Apogee.prototype.getAddChildMenuItems=function(e,t){for(var p,a=[],o=0;o<this.standardComponents.length;o++){var n=this.standardComponents[o],i=this.componentGenerators[n];(p={}).title="Add "+i.displayName,p.callback=apogeeapp.app.addcomponent.getAddComponentCallback(this,i,e,t),a.push(p)}return p={},p.title="Other Components...",p.callback=apogeeapp.app.addcomponent.getAddAdditionalComponentCallback(this,e,t),a.push(p),a},apogeeapp.app.LinkManager=function(){this.linkMap={}},apogeeapp.app.LinkManager.prototype.updateWorkspaceLinks=function(e,t,p,a){var o,n,i,r,s,l;for(n=p.length,o=0;o<n;o++)r=(i=p[o]).link,s=i.type,(l=this.linkMap[r])&&-1!==l.indexOf(r)&&(l.splice(o,1),0===l.length&&this.removeLinkFromPage(r,s)&&delete this.linkMap[r]);var d;for(a&&(d=this.getResponseProcessor(t,a)),n=t.length,o=0;o<n;o++)r=(i=t[o]).link,s=i.type,(l=this.linkMap[r])?(-1!=l.indexOf(r)||l.push(e),d&&d.getOnLoad(r)()):((l=[]).push(e),this.linkMap[r]=l,this.addLinkToPage(r,s,d))},apogeeapp.app.LinkManager.prototype.addLinkToPage=function(e,t,p){"js"===t?apogeeapp.app.LinkManager.addJsLink(e,p):"css"===t&&apogeeapp.app.LinkManager.addCssLink(e,p)},apogeeapp.app.LinkManager.prototype.removeLinkFromPage=function(e,t){return"css"===t&&(apogeeapp.app.LinkManager.removeLink(e),!0)},apogeeapp.app.LinkManager.addJsLink=function(e,t){var p=document.getElementById(e);if(p)alert("THIS SHOULDN'T HAPPEN!");else{var a={};a.id=e,a.src=e,t&&(a.onload=t.getOnLoad(e),a.onerror=t.getOnError(e)),p=apogeeapp.ui.createElement("script",a),document.head.appendChild(p)}},apogeeapp.app.LinkManager.addCssLink=function(e,t){var p=document.getElementById(e);if(p)alert("THIS SHOULDN'T HAPPEN!");else{var a={};a.id=e,a.rel="stylesheet",a.type="text/css",a.href=e,t&&(a.onload=t.getOnLoad(e),a.onerror=t.getOnError(e)),p=apogeeapp.ui.createElement("link",a),document.head.appendChild(p)}},apogeeapp.app.LinkManager.removeLink=function(e){var t=document.getElementById(e);t&&document.head.removeChild(t)},apogeeapp.app.LinkManager.prototype.getResponseProcessor=function(e,t){for(var p=[],a=0;a<e.length;a++)p[a]=e[a].link;var o=function(e){var a=p.indexOf(e);a>=0&&p.splice(a,1),0===p.length&&t()},n={};return n.getOnLoad=function(e){return function(){console.log("link loaded: "+e),o(e)}},n.getOnError=function(e){return function(){console.log("link not loaded: "+e),o(e),alert("Error loading link: "+e)}},n},apogeeapp.app.WorkspaceUI=function(){this.workspace=null,this.app=null,this.tabFrame=null,this.tree=null,this.componentMap={},this.jsLinkArray=[],this.cssLinkArray=[]},apogeeapp.app.WorkspaceUI.MAIN_WORKSPACE_NAME="main workspace",apogeeapp.app.WorkspaceUI.prototype.setApp=function(e,t,p){this.app=e,this.tabFrame=t,this.tree=new apogeeapp.ui.treecontrol.TreeControl,apogeeapp.ui.removeAllChildren(p),p.appendChild(this.tree.getElement())},apogeeapp.app.WorkspaceUI.prototype.getApp=function(){return this.app},apogeeapp.app.WorkspaceUI.prototype.setWorkspace=function(e,t){this.workspace=e;var p=this.workspace.getRoot(),a=new apogeeapp.app.FolderComponent(this,p);t&&this.loadFolderComponentContentFromJson(p,t),this.tree.setRootEntry(a.getTreeEntry());var o=this;this.workspace.addListener(apogee.updatemember.MEMBER_UPDATED_EVENT,function(e){o.memberUpdated(e)});this.workspace.addListener(apogee.deletemember.MEMBER_DELETED_EVENT,function(e){o.childDeleted(e)})},apogeeapp.app.WorkspaceUI.prototype.getWorkspace=function(){return this.workspace},apogeeapp.app.WorkspaceUI.prototype.getTabFrame=function(){return this.tabFrame},apogeeapp.app.WorkspaceUI.prototype.close=function(){for(var e in this.componentMap){var t=this.componentMap[e];t&&t.component&&!t.componentMember&&t.component.onDelete()}this.tree.clearRootEntry(),this.setLinks([],[])},apogeeapp.app.WorkspaceUI.prototype.getComponent=function(e){var t=this.componentMap[e.getId()];return t?t.component:null},apogeeapp.app.WorkspaceUI.prototype.getComponentById=function(e){var t=this.componentMap[e];return t?t.component:null},apogeeapp.app.WorkspaceUI.prototype.getFolders=function(){var e={};for(var t in this.componentMap){var p=this.componentMap[t].member;p.isParent&&(e[p.getFullName()]=p)}return e},apogeeapp.app.WorkspaceUI.prototype.registerMember=function(e,t,p){if(e.getWorkspace()!==this.workspace)throw apogee.base.createError("Component registered in wrong workspace: "+e.getFullName());var a=e.getId();if(this.componentMap[a])throw apogee.base.createError("There is already a member with the given ID.",!0);var o={};o.member=e,o.component=t,p&&(o.componentMember=p),this.componentMap[a]=o},apogeeapp.app.WorkspaceUI.prototype.memberUpdated=function(e){var t=e.getId(),p=this.componentMap[t];p&&p.component&&p.component.memberUpdated()},apogeeapp.app.WorkspaceUI.prototype.childDeleted=function(e){var t=e.getId(),p=this.componentMap[t];delete this.componentMap[t],p&&p.component&&p.component.onDelete()},apogeeapp.app.WorkspaceUI.prototype.toJson=function(e){var t={};t.fileType="apogee workspace",t.jsLinks=this.jsLinkArray,t.cssLinks=this.cssLinkArray,t.workspace=this.workspace.toJson(e);var p;return p=e||this.workspace.getRoot(),t.components=this.getFolderComponentContentJson(p),t},apogeeapp.app.WorkspaceUI.prototype.getFolderComponentContentJson=function(e){var t={},p=e.getChildMap();for(var a in p){var o=p[a],n=this.getComponent(o);t[o.getName()]=n.toJson()}return t},apogeeapp.app.WorkspaceUI.prototype.loadFolderComponentContentFromJson=function(e,t){for(var p in t){var a=t[p],o=e.lookupChild(p);this.loadComponentFromJson(o,a)}},apogeeapp.app.WorkspaceUI.prototype.loadComponentFromJson=function(e,t){var p=t.type,a=this.app.getComponentGenerator(p);if(!a)throw apogee.base.createError("Component type not found: "+p);a.createComponentFromJson(this,e,t)},apogeeapp.app.WorkspaceUI.prototype.getJsLinks=function(){return this.jsLinkArray},apogeeapp.app.WorkspaceUI.prototype.setLinks=function(e,t,p){var a=this.jsLinkArray,o=this.cssLinkArray,n=[],i=[];this.createLinkAddRemoveList(e,a,"js",n,i),this.createLinkAddRemoveList(t,o,"css",n,i),this.jsLinkArray=e,this.cssLinkArray=t,this.app.updateWorkspaceLinks(apogeeapp.app.WorkspaceUI.MAIN_WORKSPACE_NAME,n,i,p)},apogeeapp.app.WorkspaceUI.prototype.getCssLinks=function(){return this.cssLinkArray},apogeeapp.app.WorkspaceUI.prototype.createLinkAddRemoveList=function(e,t,p,a,o){var n,i,r={};for(n=0;n<e.length;n++)r[i=e[n]]=!0;for(n=0;n<t.length;n++)r[i=t[n]]?r[i]=!1:o.push({link:i,type:p});for(i in r)r[i]&&a.push({link:i,type:p})},apogeeapp.app.WindowHeaderManager=function(){this.toolbarDiv=null,this.toolbarActive=!1,this.bannerDiv=null,this.bannerBarActive=!1,this.headerContainer=document.createElement("div")},apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR="error",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_ERROR="red",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_ERROR="white",apogeeapp.app.WindowHeaderManager.ERROR_ICON_IMAGE="/error.png",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING="pending",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_PENDING="yellow",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_PENDING="black",apogeeapp.app.WindowHeaderManager.PENDING_ICON_IMAGE="/pending.png",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_UNKNOWN="yellow",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_UNKNOWN="black",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE="none",apogeeapp.app.WindowHeaderManager.PENDING_MESSAGE="Calculation pending...",apogeeapp.app.WindowHeaderManager.prototype.showBannerBar=function(e,t){this.bannerDiv||(this.bannerDiv=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",backgroundColor:p,color:a}));var p,a;t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?(p=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_ERROR,a=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_ERROR):t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING?(p=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_PENDING,a=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_PENDING):(p=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_UNKNOWN,a=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_UNKNOWN);var o={};o.backgroundColor=p,o.color=a,apogeeapp.ui.applyStyle(this.bannerDiv,o),this.bannerDiv.innerHTML=e,this.bannerBarActive=!0,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.hideBannerBar=function(){this.bannerBarActive=!1,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.showToolbar=function(e){this.toolbarActive=!0,this.toolbarDiv=e,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.hideToolbar=function(){this.toolbarActive=!1,this.toolbarDiv=null,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.updateHeaderElement=function(){var e=[];if(this.toolbarActive&&this.toolbarDiv&&e.push(this.toolbarDiv),this.saveBarActive&&this.saveDiv&&e.push(this.saveDiv),this.bannerBarActive&&this.bannerDiv&&e.push(this.bannerDiv),apogeeapp.ui.removeAllChildren(this.headerContainer),e.length>0)for(var t=0;t<e.length;t++)this.headerContainer.appendChild(e[t])},apogeeapp.app.WindowHeaderManager.prototype.getHeaderElement=function(){return this.headerContainer},apogeeapp.app.WindowHeaderManager.getIconOverlay=function(e){var t;if(e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?t=apogeeapp.app.WindowHeaderManager.ERROR_ICON_IMAGE:e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING&&(t=apogeeapp.app.WindowHeaderManager.PENDING_ICON_IMAGE),!t)return null;var p=apogeeapp.ui.getResourcePath(t),a=document.createElement("img");return a.src=p,a},apogeeapp.app.Component=function(e,t,p,a){a||(a={}),this.options=a,this.workspaceUI=e,this.member=t,this.uiActiveParent=null,this.generator=p,this.workspaceUI.registerMember(this.member,this),this.saveActions=[],this.cleanupActions=[],this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE,this.bannerMessage="",this.windowDisplay=null,this.windowDisplayStateJson=this.options.windowState,this.tabDisplay=null,this.treeDisplay=new apogeeapp.app.TreeComponentDisplay(this)},apogeeapp.app.Component.prototype.addSaveAction=function(e){this.saveActions.push(e)},apogeeapp.app.Component.prototype.addCleanupAction=function(e){this.cleanupActions.push(e)},apogeeapp.app.Component.DEFAULT_ICON_RES_PATH="/genericIcon.png",apogeeapp.app.Component.MENU_ITEM_OPEN=1,apogeeapp.app.Component.prototype.getMember=function(){return this.member},apogeeapp.app.Component.prototype.getIconUrl=function(){if(this.generator.ICON_URL)return this.generator.ICON_URL;var e=this.generator.ICON_RES_PATH;return e||(e=apogeeapp.app.Component.DEFAULT_ICON_RES_PATH),apogeeapp.ui.getResourcePath(e)},apogeeapp.app.Component.prototype.getWorkspace=function(){return this.member.getWorkspace()},apogeeapp.app.Component.prototype.getWorkspaceUI=function(){return this.workspaceUI},apogeeapp.app.Component.prototype.getTreeEntry=function(){return this.treeDisplay.getTreeEntry()},apogeeapp.app.Component.prototype.createWindowDisplay=function(){var e=this.instantiateWindowDisplay();return e.setBannerState(this.bannerState,this.bannerMessage),this.windowDisplay=e,e},apogeeapp.app.Component.prototype.getWindowDisplay=function(){return this.windowDisplay},apogeeapp.app.Component.prototype.closeWindowDisplay=function(){this.windowDisplay&&(this.windowDisplayStateJson=this.windowDisplay.getStateJson(),this.windowDisplay.deleteDisplay())},apogeeapp.app.Component.prototype.getMenuItems=function(e){var t=e||[],p={};return p.title="Edit Properties",p.callback=apogeeapp.app.updatecomponent.getUpdateComponentCallback(this),t.push(p),(p={}).title="Delete",p.callback=this.createDeleteCallback(p.title),t.push(p),t},apogeeapp.app.Component.prototype.getOpenMenuItem=function(){var e=this.createOpenCallback();if(e){var t={};return t.title="Open",t.callback=e,t}return null},apogeeapp.app.Component.prototype.createTabDisplay=function(){return this.tabDisplay&&this.tabDisplay.closeTab(),this.usesTabDisplay()&&(this.tabDisplay=this.instantiateTabDisplay(),this.tabDisplay.setBannerState(this.bannerState,this.bannerMessage)),this.tabDisplay},apogeeapp.app.Component.prototype.getTabDisplay=function(){return this.tabDisplay},apogeeapp.app.Component.prototype.closeTabDisplay=function(){this.tabDisplay&&(this.tabDisplay.closeTab(),this.tabDisplay=null)},apogeeapp.app.Component.prototype.toJson=function(){var e={};e.type=this.generator.uniqueName,null!=this.windowDisplay&&(this.windowDisplayStateJson=this.windowDisplay.getStateJson()),this.windowDisplayStateJson&&(e.windowState=this.windowDisplayStateJson);for(var t=0;t<this.saveActions.length;t++)this.saveActions[t].call(this,e);return e},apogeeapp.app.Component.prototype.onDelete=function(){if(this.uiActiveParent){var e=this.workspaceUI.getComponent(this.uiActiveParent);e&&e.removeChildComponent(this)}this.tabDisplay&&this.closeTabDisplay();for(var t=0;t<this.cleanupActions.length;t++)this.cleanupActions[t].call(this)},apogeeapp.app.Component.prototype.memberUpdated=function(){if(this.member.getParent()!==this.uiActiveParent){var e=this.uiActiveParent,t=this.member.getParent();this.uiActiveParent=t,e&&(this.workspaceUI.getComponent(e).removeChildComponent(this),this.windowDisplay&&(this.windowDisplay.deleteDisplay(),this.windowDisplay=null)),t&&this.workspaceUI.getComponent(t).addChildComponent(this)}var p=this.getMember();if(p.hasError()){for(var a="",o=p.getErrors(),n=0;n<o.length;n++)a+=o[n].msg+"\n";this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR,this.bannerMessage=a}else p.getResultPending()?(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING,this.bannerMessage=apogeeapp.app.WindowHeaderManager.PENDING_MESSAGE):(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE,this.bannerMessage=null);this.treeDisplay.updateData(),this.treeDisplay.setBannerState(this.bannerState,this.bannerMessage),null!=this.windowDisplay&&(this.windowDisplay.updateData(),this.windowDisplay.setBannerState(this.bannerState,this.bannerMessage)),null!=this.tabDisplay&&(this.tabDisplay.updateData(),this.tabDisplay.setBannerState(this.bannerState,this.bannerMessage))},apogeeapp.app.Component.prototype.getPropertyValues=function(){var e=this.member,t={};t.name=e.getName();var p=e.getParent();return p&&(t.parentName=p.getFullName()),e.generator.addPropFunction&&e.generator.addPropFunction(e,t),this.generator.addPropFunction&&this.generator.addPropFunction(this,t),t},apogeeapp.app.Component.prototype.createOpenCallback=function(){var e,t=this,p=this.workspaceUI,a=function(e){var t=e.getTabDisplay();if(t)(a=t.getTab()).makeActive();else{var a=(t=e.createTabDisplay()).getTab();p.getTabFrame().addTab(a,!0)}};if(this.usesTabDisplay())e=function(){a(t)};else{var o=this.member.getParent();if(o){var n=p.getComponent(o);n&&n.usesTabDisplay()&&(e=function(){a(n),n.showChildComponent(t)})}}return e},apogeeapp.app.Component.prototype.createDeleteCallback=function(){var e=this.getMember();return function(){if(confirm("Are you sure you want to delete this object?")){var t={};t.action="deleteMember",t.member=e;var p=apogee.action.doAction(t);if(!p.getSuccess()){var a=p.getErrorMsg();alert(a)}}}},apogeeapp.app.ParentComponent=function(e,t,p,a){apogeeapp.app.Component.call(this,e,t,p,a),this.tabDisplay=null},apogeeapp.app.ParentComponent.prototype=Object.create(apogeeapp.app.Component.prototype),apogeeapp.app.ParentComponent.prototype.constructor=apogeeapp.app.ParentComponent,apogeeapp.app.ParentComponent.prototype.instantiateWindowDisplay=function(){return new apogeeapp.app.ParentWindowComponentDisplay(this,this.windowDisplayStateJson)},apogeeapp.app.ParentComponent.prototype.usesTabDisplay=function(){return!0},apogeeapp.app.ParentComponent.prototype.showChildComponent=function(e){e.getMember().getParent()==this.getMember()&&this.tabDisplay&&this.tabDisplay.showChildComponent(e)},apogeeapp.app.ParentComponent.prototype.getMenuItems=function(e){var t=e||[],p={},a=this.getWorkspaceUI().getApp(),o={};return o.parentName=this.member.getFullName(),p.title="Add Component...",p.childMenuItems=a.getAddChildMenuItems(o),t.push(p),t=apogeeapp.app.Component.prototype.getMenuItems.call(this,t)},apogeeapp.app.ParentComponent.prototype.isParentComponent=!0,apogeeapp.app.ParentComponent.prototype.removeChildComponent=function(e){var t=this.getTreeEntry(),p=e.getMember().getId();t.removeChild(p);var a=e.getWindowDisplay();a&&a.deleteDisplay()},apogeeapp.app.ParentComponent.prototype.addChildComponent=function(e){var t=this.getTreeEntry(),p=e.getTreeEntry(),a=e.getMember().getId();t.addChild(a,p),this.tabDisplay&&this.tabDisplay.addChildComponent(e)},apogeeapp.app.EditComponent=function(e,t,p,a){apogeeapp.app.Component.call(this,e,t,p,a)},apogeeapp.app.EditComponent.prototype=Object.create(apogeeapp.app.Component.prototype),apogeeapp.app.EditComponent.prototype.constructor=apogeeapp.app.EditComponent,apogeeapp.app.EditComponent.prototype.instantiateWindowDisplay=function(){return new apogeeapp.app.EditWindowComponentDisplay(this,this.windowDisplayStateJson)},apogeeapp.app.EditComponent.prototype.setAlternateWindowDisplay=function(e){this.alternateWindowDisplay=e,this.windowDisplay=e,e.setBannerState(this.bannerState,this.bannerMessage)},apogeeapp.app.EditComponent.prototype.usesTabDisplay=function(){return!1},apogeeapp.app.EditComponent.prototype.instantiateTabDisplay=function(){return null},apogeeapp.app.EditComponent.prototype.getMenuItems=function(e){var t=e||[],t=apogeeapp.app.Component.prototype.getMenuItems.call(this,t);if(this.member.isCodeable&&this.member.hasCode()){var p=this.getTableEditSettings();if(void 0!==p.clearFunctionMenuText){var a={};a.title=p.clearFunctionMenuText,a.callback=this.getClearFunctionCallback(p.emptyDataValue),t.push(a)}}return t},apogeeapp.app.EditComponent.prototype.getClearFunctionCallback=function(e){var t={};return t.member=this.member,t.data=e,t.action=apogee.updatemember.UPDATE_DATA_ACTION_NAME,function(){var e=apogee.action.doAction(t);e.getSuccess()||alert(e.getErrorMsg())}},apogeeapp.app.TreeComponentDisplay=function(e){this.component=e,this.member=e.getMember(),this.treeEntry=this.createTreeEntry()},apogeeapp.app.TreeComponentDisplay.prototype.getTreeEntry=function(){return this.treeEntry},apogeeapp.app.TreeComponentDisplay.prototype.changeParent=function(e,t){t.getTreeEntry().removeChild(this.member.getId()),e.getTreeEntry().addChild(this.member.getId(),this.treeEntry)},apogeeapp.app.TreeComponentDisplay.prototype.deleteDisplay=function(){alert("Delete tree component display not implemneted")},apogeeapp.app.TreeComponentDisplay.prototype.setBannerState=function(e,t){var p=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);p?this.treeEntry.setIconOverlay(p):this.treeEntry.clearIconOverlay()},apogeeapp.app.TreeComponentDisplay.prototype.updateData=function(){this.treeEntry.setLabel(this.member.getName())},apogeeapp.app.TreeComponentDisplay.prototype.createTreeEntry=function(){var e=this,t=this.component.createOpenCallback(),p=this.member.getName(),a=this.component.getIconUrl(),o=this.member.isParent&&this.member.isRoot();return new apogeeapp.ui.treecontrol.TreeEntry(p,a,t,function(){var t=[],p=e.component.getOpenMenuItem();return p&&t.push(p),e.component.getMenuItems(t)},o)},apogeeapp.app.TabComponentDisplay=function(e,t,p){this.component=e,this.member=t,this.folder=p,this.loadTabEntry()},apogeeapp.app.TabComponentDisplay.prototype.getTab=function(){return this.tab},apogeeapp.app.TabComponentDisplay.prototype.closeTab=function(){this.tab&&(this.tab.close(),this.tab=null)},apogeeapp.app.TabComponentDisplay.prototype.setBannerState=function(e,t){if(e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE?this.windowHeaderManager.hideBannerBar():this.windowHeaderManager.showBannerBar(t,e),this.tab){var p=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);p?this.tab.setIconOverlay(p):this.tab.clearIconOverlay()}},apogeeapp.app.TabComponentDisplay.prototype.updateData=function(){this.tab.setTitle(this.member.getName())},apogeeapp.app.TabComponentDisplay.prototype.addChildComponent=function(e){var t=e.createWindowDisplay(),p=t.getWindowFrame(),a=t.getPreferredPosition();a||(a=this.parentContainer.getNextWindowPosition()),p.setPosition(a.x,a.y),this.parentContainer.addWindow(p);var o=t.getPreferredState();p.setWindowState(o)},apogeeapp.app.TabComponentDisplay.prototype.showChildComponent=function(e){var t=e.getWindowDisplay();if(t){var p=t.getWindowFrame();p&&this.parentContainer.bringToFront(p)}},apogeeapp.app.TabComponentDisplay.prototype.loadTabEntry=function(){this.tab=new apogeeapp.ui.Tab(this.member.getId()),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.tab.setHeaderContent(this.windowHeaderManager.getHeaderElement()),this.createDisplayContent(),this.tab.setContent(this.contentElement);this.tab.addListener(apogeeapp.ui.SHOWN_EVENT,function(){e.parentContainer.elementIsShown()});this.tab.addListener(apogeeapp.ui.HIDDEN_EVENT,function(){e.parentContainer.elementIsHidden()});e=this;this.tab.createMenu(this.component.getIconUrl()).setAsOnTheFlyMenu(function(){return e.component.getMenuItems()}),this.tab.setTitle(this.member.getName());var e=this;this.tab.addListener(apogeeapp.ui.CLOSE_EVENT,function(){e.component.closeTabDisplay(),e.destroy()})},apogeeapp.app.TabComponentDisplay.PARENT_CONTAINER_STYLE={position:"relative",display:"table",width:"100%",height:"100%",top:"0px",left:"0px"},apogeeapp.app.TabComponentDisplay.prototype.createDisplayContent=function(){if(this.contentElement=apogeeapp.ui.createElement("div",null,apogeeapp.app.TabComponentDisplay.PARENT_CONTAINER_STYLE),this.parentContainer=new apogeeapp.ui.WindowParent(this.contentElement),this.folder.isParent){this.setAddChildrenContextMenu();var e=this.component.getWorkspaceUI(),t=this.folder.getChildMap();for(var p in t){var a=t[p],o=e.getComponent(a);this.addChildComponent(o)}}},apogeeapp.app.TabComponentDisplay.prototype.setAddChildrenContextMenu=function(){var e=this.component.getWorkspaceUI().getApp(),t={};t.parentName=this.member.getFullName(),this.contentElement.oncontextmenu=function(p){if(p.preventDefault(),p.stopPropagation(),p.offsetX){var a={},o={};o.x=p.offsetX,o.y=p.offsetY,a.windowState={},a.windowState.posInfo=o}var n=new apogeeapp.ui.MenuBody;n.setMenuItems(e.getAddChildMenuItems(t,a)),apogeeapp.ui.Menu.showContextMenu(n,p)}},apogeeapp.app.TabComponentDisplay.prototype.destroy=function(){var e=this.folder.getChildMap(),t=this.component.getWorkspaceUI();for(var p in e){var a=e[p];t.getComponent(a).closeWindowDisplay()}this.closeTab()},apogeeapp.app.ParentWindowComponentDisplay=function(e,t){this.component=e,this.member=e.getMember(),this.options=t,this.loadWindowFrameEntry()},apogeeapp.app.ParentWindowComponentDisplay.prototype.getWindowFrame=function(){return this.windowFrame},apogeeapp.app.ParentWindowComponentDisplay.prototype.getPreferredPosition=function(){return this.options?this.options.posInfo:void 0},apogeeapp.app.ParentWindowComponentDisplay.prototype.getPreferredState=function(){return apogeeapp.ui.WINDOW_STATE_MINIMIZED},apogeeapp.app.ParentWindowComponentDisplay.prototype.getComponent=function(){return this.component},apogeeapp.app.ParentWindowComponentDisplay.prototype.deleteDisplay=function(){this.windowFrame&&this.windowFrame.close()},apogeeapp.app.ParentWindowComponentDisplay.prototype.setBannerState=function(e,t){if(this.windowFrame){var p=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);p?this.windowFrame.setIconOverlay(p):this.windowFrame.clearIconOverlay()}},apogeeapp.app.ParentWindowComponentDisplay.prototype.updateData=function(){this.windowFrame&&this.windowFrame.setTitle(this.member.getDisplayName())},apogeeapp.app.ParentWindowComponentDisplay.prototype.getStateJson=function(){if(this.windowFrame){var e={};return e.posInfo=this.windowFrame.getPosInfo(),e}},apogeeapp.app.ParentWindowComponentDisplay.prototype.loadWindowFrameEntry=function(){var e={};e.minimizable=!1,e.maximizable=!1,e.resizable=!1,e.movable=!0,e.frameColorClass="visicomp_windowColor",e.titleBarClass="visicomp_titleBarClass",this.windowFrame=new apogeeapp.ui.WindowFrame(e),this.windowFrame.setWindowState(apogeeapp.ui.WINDOW_STATE_MINIMIZED);var t=apogeeapp.ui.createElement("div");this.windowFrame.setContent(t),this.windowFrame.setTitle(this.member.getDisplayName());var p=this;this.windowFrame.createMenu(this.component.getIconUrl()).setAsOnTheFlyMenu(function(){var e=[],t=p.component.getOpenMenuItem();return t&&e.push(t),p.component.getMenuItems(e)})},apogeeapp.app.ParentWindowComponentDisplay.prototype.destroy=function(){for(var e in viewModeElements)this.viewModeElemens[e].destroy()},apogeeapp.app.EditWindowComponentDisplay=function(e,t){this.component=e,this.member=e.getMember(),this.options=t,this.viewType=null,this.select=null,this.viewModeElements={},this.viewModeElement=null,this.loadWindowFrameEntry()},apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR="#f4f4f4",apogeeapp.app.EditWindowComponentDisplay.prototype.getWindowFrame=function(){return this.windowFrame},apogeeapp.app.EditWindowComponentDisplay.prototype.getPreferredPosition=function(){return this.options?this.options.posInfo:void 0},apogeeapp.app.EditWindowComponentDisplay.prototype.getPreferredState=function(){return this.options&&void 0!==this.options.state?this.options.state:apogeeapp.ui.WINDOW_STATE_NORMAL},apogeeapp.app.EditWindowComponentDisplay.prototype.getComponent=function(){return this.component},apogeeapp.app.EditWindowComponentDisplay.prototype.getMember=function(){return this.member},apogeeapp.app.EditWindowComponentDisplay.prototype.deleteDisplay=function(){for(var e in this.viewModeElements){var t=this.viewModeElements[e];t&&t.destroy()}this.windowFrame&&this.windowFrame.close()},apogeeapp.app.EditWindowComponentDisplay.prototype.setBannerState=function(e,t){if(this.windowHeaderManager&&(e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE?this.windowHeaderManager.hideBannerBar():this.windowHeaderManager.showBannerBar(t,e)),this.windowFrame){var p=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);p?this.windowFrame.setIconOverlay(p):this.windowFrame.clearIconOverlay()}},apogeeapp.app.EditWindowComponentDisplay.prototype.updateData=function(){if(this.windowFrame){this.windowFrame.setTitle(this.member.getDisplayName());for(var e in this.viewModeElements)this.viewModeElements[e].memberUpdated()}},apogeeapp.app.EditWindowComponentDisplay.prototype.getStateJson=function(){var e={},t=!1;return this.windowFrame&&(e.sizeInfo=this.windowFrame.getSizeInfo(),e.posInfo=this.windowFrame.getPosInfo(),e.state=this.windowFrame.getWindowState(),t=!0),this.viewType&&(e.viewType=this.viewType,t=!0),t?e:void 0},apogeeapp.app.EditWindowComponentDisplay.prototype.setStateJson=function(e){this.windowFrame&&(e.sizeInfo&&this.windowFrame.setSizeInfo(e.sizeInfo),e.posInfo&&this.windowFrame.setPosInfo(e.posInfo),e.state&&this.windowFrame.setWindowState(e.state)),e.viewType&&(this.viewType=e.viewType)},apogeeapp.app.EditWindowComponentDisplay.prototype.loadWindowFrameEntry=function(){var e={};e.minimizable=!0,e.maximizable=!0,e.resizable=!0,e.movable=!0,e.frameColorClass="visicomp_windowColor",e.titleBarClass="visicomp_titleBarClass",this.windowFrame=new apogeeapp.ui.WindowFrame(e),this.options&&this.options.sizeInfo?this.windowFrame.setSize(this.options.sizeInfo.width,this.options.sizeInfo.height):this.windowFrame.setSize(this.component.generator.DEFAULT_WIDTH,this.component.generator.DEFAULT_HEIGHT),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.windowFrame.setHeaderContent(this.windowHeaderManager.getHeaderElement()),this.windowFrame.setTitle(this.member.getDisplayName());var t=this.windowFrame.createMenu(this.component.getIconUrl()),p=this.component;t.setAsOnTheFlyMenu(function(){return p.getMenuItems()}),this.createSelectTool(),this.initContentUI()},apogeeapp.app.EditWindowComponentDisplay.prototype.createSelectTool=function(){this.select=apogeeapp.ui.createElement("select",null,{marginRight:"3px",backgroundColor:"transparent"});var e=this;this.select.onchange=function(t){e.setViewType(e.select.value)},this.windowFrame.addTitleToolElement(this.select)},apogeeapp.app.EditWindowComponentDisplay.prototype.initContentUI=function(){for(var e=this.component.getTableEditSettings(),t=e.viewModes,p=0;p<t.length;p++){var a=t[p];this.select.add(apogeeapp.ui.createElement("option",{text:a}))}var o=this.getInitialViewType(t,e.defaultView);this.setViewType(o)},apogeeapp.app.EditWindowComponentDisplay.prototype.getInitialViewType=function(e,t){return this.options&&this.options.viewType&&e.indexOf(this.options.viewType)>=0?this.options.viewType:t||e[0]},apogeeapp.app.EditWindowComponentDisplay.prototype.setViewType=function(e){if(this.viewType!==e){if(this.viewModeElement){var t=this.viewModeElement.isCloseOk();if(t!==apogeeapp.app.ViewMode.CLOSE_OK)return t===apogeeapp.app.ViewMode.UNSAVED_DATA?alert("You must save or cancel the edit session to change the view mode."):alert("close request rejected..."),void this.updateViewTypeSelect();this.viewModeElement.setInactive()}this.viewType=e,this.updateViewTypeSelect(),this.viewModeElement=this.viewModeElements[e],this.viewModeElement||(this.viewModeElement=this.component.getViewModeElement(this,e),this.viewModeElements[e]=this.viewModeElement),this.viewModeElement?this.viewModeElement.setActive():alert("Error: View mode element not found!")}},apogeeapp.app.EditWindowComponentDisplay.prototype.updateViewTypeSelect=function(){this.select.value!=this.viewType&&(this.select.value=this.viewType)},apogeeapp.app.EditWindowComponentDisplay.prototype.showDisplayElement=function(e){this.windowFrame.setContent(e)},apogeeapp.app.EditWindowComponentDisplay.prototype.removeDisplayElement=function(e){this.windowFrame.safeRemoveContent(e)},apogeeapp.app.EditWindowComponentDisplay.prototype.startEditUI=function(e,t){this.select.disabled=!0,this.showSaveBar(e,t)},apogeeapp.app.EditWindowComponentDisplay.prototype.endEditUI=function(){this.hideSaveBar(),this.select.disabled=!1},apogeeapp.app.EditWindowComponentDisplay.prototype.showSaveBar=function(e,t){this.saveDiv||(this.saveDiv=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",backgroundColor:"white",border:"solid 1px gray",padding:"3px"}),this.saveDiv.appendChild(document.createTextNode("Edit: ")),this.saveBarSaveButton=document.createElement("button"),this.saveBarSaveButton.innerHTML="Save",this.saveDiv.appendChild(this.saveBarSaveButton),this.saveDiv.appendChild(document.createTextNode(" ")),this.saveBarCancelButton=document.createElement("button"),this.saveBarCancelButton.innerHTML="Cancel",this.saveDiv.appendChild(this.saveBarCancelButton)),this.saveBarSaveButton.onclick=e,this.saveBarCancelButton.onclick=t,this.saveBarActive=!0,this.windowHeaderManager.showToolbar(this.saveDiv)},apogeeapp.app.EditWindowComponentDisplay.prototype.hideSaveBar=function(){this.saveBarActive=!1,this.windowHeaderManager.showToolbar(this.normalToolbarDiv)},apogeeapp.app.FolderComponent=function(e,t,p){apogeeapp.app.ParentComponent.call(this,e,t,apogeeapp.app.FolderComponent.generator,p),this.addSaveAction(apogeeapp.app.FolderComponent.writeToJson),this.memberUpdated()},apogeeapp.app.FolderComponent.prototype=Object.create(apogeeapp.app.ParentComponent.prototype),apogeeapp.app.FolderComponent.prototype.constructor=apogeeapp.app.FolderComponent,apogeeapp.app.FolderComponent.prototype.instantiateTabDisplay=function(){var e=this.getMember();return this.tabDisplay=new apogeeapp.app.TabComponentDisplay(this,e,e),this.tabDisplay},apogeeapp.app.FolderComponent.writeToJson=function(e){var t=this.getMember(),p=this.getWorkspaceUI();e.children=p.getFolderComponentContentJson(t)},apogeeapp.app.FolderComponent.createComponent=function(e,t,p){var a={};a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name,t.children&&(a.children=t.children),a.type=apogee.Folder.generator.type;var o=apogee.action.doAction(a),n=a.member;if(n){var i=apogeeapp.app.FolderComponent.createComponentFromJson(e,n,p);o.component=i}return o},apogeeapp.app.FolderComponent.createComponentFromJson=function(e,t,p){var a=new apogeeapp.app.FolderComponent(e,t,p);return p&&p.children&&e.loadFolderComponentContentFromJson(t,p.children),a},apogeeapp.app.FolderComponent.generator={},apogeeapp.app.FolderComponent.generator.displayName="Folder",apogeeapp.app.FolderComponent.generator.uniqueName="apogeeapp.app.FolderComponent",apogeeapp.app.FolderComponent.generator.createComponent=apogeeapp.app.FolderComponent.createComponent,apogeeapp.app.FolderComponent.generator.createComponentFromJson=apogeeapp.app.FolderComponent.createComponentFromJson,apogeeapp.app.FolderComponent.generator.DEFAULT_WIDTH=500,apogeeapp.app.FolderComponent.generator.DEFAULT_HEIGHT=500,apogeeapp.app.FolderComponent.generator.ICON_RES_PATH="/folderIcon.png",apogeeapp.app.FolderComponent.generator.propertyDialogLines=[{type:"invisible",resultKey:"children"}],apogeeapp.app.FolderComponent.generator.appendWorkspaceChildren=function(e,t){e.children=t},apogeeapp.app.JsonTableComponent=function(e,t,p){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.JsonTableComponent.generator,p),this.memberUpdated()},apogeeapp.app.JsonTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.JsonTableComponent.prototype.constructor=apogeeapp.app.JsonTableComponent,apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT="Text",apogeeapp.app.JsonTableComponent.VIEW_JSON_TEXT="JSON",apogeeapp.app.JsonTableComponent.VIEW_FORM="Form",apogeeapp.app.JsonTableComponent.VIEW_CODE="Formula",apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.JsonTableComponent.VIEW_MODES=[apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT,apogeeapp.app.JsonTableComponent.VIEW_JSON_TEXT,apogeeapp.app.JsonTableComponent.VIEW_FORM,apogeeapp.app.JsonTableComponent.VIEW_CODE,apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION],apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.JsonTableComponent.VIEW_MODES,defaultView:apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT,clearFunctionMenuText:"Clear Formula",emptyDataValue:""},apogeeapp.app.JsonTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.JsonTableComponent.prototype.getViewModeElement=function(e,t){switch(t){case apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT:return new apogeeapp.app.AceDataMode(e,!1);case apogeeapp.app.JsonTableComponent.VIEW_JSON_TEXT:return new apogeeapp.app.AceDataMode(e,!0);case apogeeapp.app.JsonTableComponent.VIEW_FORM:return new apogeeapp.app.FormDataMode(e);case apogeeapp.app.JsonTableComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(e);case apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(e);case apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(e);default:return alert("unrecognized view element!"),null}},apogeeapp.app.JsonTableComponent.createComponent=function(e,t,p){var a={};a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name,a.type=apogee.JsonTable.generator.type;var o=apogee.action.doAction(a),n=a.member;if(n){var i=new apogeeapp.app.JsonTableComponent(e,n,p);o.component=i}return o},apogeeapp.app.JsonTableComponent.createComponentFromJson=function(e,t,p){return new apogeeapp.app.JsonTableComponent(e,t,p)},apogeeapp.app.JsonTableComponent.generator={},apogeeapp.app.JsonTableComponent.generator.displayName="Data Table",apogeeapp.app.JsonTableComponent.generator.uniqueName="apogeeapp.app.JsonTableComponent",apogeeapp.app.JsonTableComponent.generator.createComponent=apogeeapp.app.JsonTableComponent.createComponent,apogeeapp.app.JsonTableComponent.generator.createComponentFromJson=apogeeapp.app.JsonTableComponent.createComponentFromJson,apogeeapp.app.JsonTableComponent.generator.DEFAULT_WIDTH=300,apogeeapp.app.JsonTableComponent.generator.DEFAULT_HEIGHT=300,apogeeapp.app.JsonTableComponent.generator.ICON_RES_PATH="/dataIcon.png",apogeeapp.app.GridTableComponent=function(e,t,p){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.GridTableComponent.generator,p),this.memberUpdated()},apogeeapp.app.GridTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.GridTableComponent.prototype.constructor=apogeeapp.app.GridTableComponent,apogeeapp.app.GridTableComponent.VIEW_GRID="Grid",apogeeapp.app.GridTableComponent.VIEW_CODE="Formula",apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.GridTableComponent.VIEW_MODES=[apogeeapp.app.GridTableComponent.VIEW_GRID,apogeeapp.app.GridTableComponent.VIEW_CODE,apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION],apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.GridTableComponent.VIEW_MODES,defaultView:apogeeapp.app.GridTableComponent.VIEW_GRID,clearFunctionMenuText:"Clear Formula",emptyDataValue:[[null]]},apogeeapp.app.GridTableComponent.DEFAULT_VIEW=apogeeapp.app.GridTableComponent.VIEW_GRID,apogeeapp.app.GridTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.GridTableComponent.prototype.getViewModeElement=function(e,t){switch(t){case apogeeapp.app.GridTableComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(e);case apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(e);case apogeeapp.app.GridTableComponent.VIEW_GRID:return new apogeeapp.app.HandsonGridMode(e);case apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(e);default:return alert("unrecognized view element!"),null}},apogeeapp.app.GridTableComponent.createComponent=function(e,t,p){var a={};a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name,a.type=apogee.JsonTable.generator.type,a.updateData={},a.updateData.data=[[""]];var o=apogee.action.doAction(a),n=a.member;if(n){var i=new apogeeapp.app.GridTableComponent(e,n,p);o.component=i}return o},apogeeapp.app.GridTableComponent.createComponentFromJson=function(e,t,p){return new apogeeapp.app.GridTableComponent(e,t,p)},apogeeapp.app.GridTableComponent.generator={},apogeeapp.app.GridTableComponent.generator.displayName="Grid Table",apogeeapp.app.GridTableComponent.generator.uniqueName="apogeeapp.app.GridTableComponent",apogeeapp.app.GridTableComponent.generator.createComponent=apogeeapp.app.GridTableComponent.createComponent,apogeeapp.app.GridTableComponent.generator.createComponentFromJson=apogeeapp.app.GridTableComponent.createComponentFromJson,apogeeapp.app.GridTableComponent.generator.DEFAULT_WIDTH=300,apogeeapp.app.GridTableComponent.generator.DEFAULT_HEIGHT=300,apogeeapp.app.GridTableComponent.generator.ICON_RES_PATH="/gridIcon.png",apogeeapp.app.TextComponent=function(e,t,p){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.TextComponent.generator,p),this.memberUpdated()},apogeeapp.app.TextComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.TextComponent.prototype.constructor=apogeeapp.app.TextComponent,apogeeapp.app.TextComponent.VIEW_TEXT="Text",apogeeapp.app.TextComponent.VIEW_CODE="Formula",apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.TextComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.TextComponent.VIEW_MODES=[apogeeapp.app.TextComponent.VIEW_TEXT,apogeeapp.app.TextComponent.VIEW_CODE,apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.TextComponent.VIEW_DESCRIPTION],apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.TextComponent.VIEW_MODES,defaultView:apogeeapp.app.TextComponent.VIEW_TEXT,clearFunctionMenuText:"Clear Formula",emptyDataValue:""},apogeeapp.app.TextComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.TextComponent.prototype.getViewModeElement=function(e,t){switch(t){case apogeeapp.app.TextComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(e);case apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(e);case apogeeapp.app.TextComponent.VIEW_TEXT:return new apogeeapp.app.AceTextMode(e);case apogeeapp.app.TextComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(e);default:return alert("unrecognized view element!"),null}},apogeeapp.app.TextComponent.createComponent=function(e,t,p){var a={};a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name,a.type=apogee.JsonTable.generator.type,a.updateData={},a.updateData.data="";var o=apogee.action.doAction(a),n=a.member;if(n){var i=new apogeeapp.app.TextComponent(e,n,p);o.component=i}return o},apogeeapp.app.TextComponent.createComponentFromJson=function(e,t,p){return new apogeeapp.app.TextComponent(e,t,p)},apogeeapp.app.TextComponent.generator={},apogeeapp.app.TextComponent.generator.displayName="Text Table",apogeeapp.app.TextComponent.generator.uniqueName="apogeeapp.app.TextComponent",apogeeapp.app.TextComponent.generator.createComponent=apogeeapp.app.TextComponent.createComponent,apogeeapp.app.TextComponent.generator.createComponentFromJson=apogeeapp.app.TextComponent.createComponentFromJson,apogeeapp.app.TextComponent.generator.DEFAULT_WIDTH=300,apogeeapp.app.TextComponent.generator.DEFAULT_HEIGHT=300,apogeeapp.app.TextComponent.generator.ICON_RES_PATH="/textIcon.png",apogeeapp.app.FunctionComponent=function(e,t,p){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.FunctionComponent.generator,p),this.memberUpdated()},apogeeapp.app.FunctionComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.FunctionComponent.prototype.constructor=apogeeapp.app.FunctionComponent,apogeeapp.app.FunctionComponent.VIEW_CODE="Code",apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.FunctionComponent.VIEW_MODES=[apogeeapp.app.FunctionComponent.VIEW_CODE,apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION],apogeeapp.app.FunctionComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.FunctionComponent.VIEW_MODES,defaultView:apogeeapp.app.FunctionComponent.VIEW_CODE},apogeeapp.app.FunctionComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.FunctionComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.FunctionComponent.prototype.getViewModeElement=function(e,t){switch(t){case apogeeapp.app.FunctionComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(e);case apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(e);case apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(e);default:return alert("unrecognized view element!"),null}},apogeeapp.app.FunctionComponent.createComponent=function(e,t,p){var a={};a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name;var o;o=t.argListString?apogee.FunctionTable.parseStringArray(t.argListString):[],a.updateData={},a.updateData.argList=o,a.type=apogee.FunctionTable.generator.type;var n=apogee.action.doAction(a),i=a.member;if(i){var r=new apogeeapp.app.FunctionComponent(e,i,p);n.component=r}return n},apogeeapp.app.FunctionComponent.createComponentFromJson=function(e,t,p){return new apogeeapp.app.FunctionComponent(e,t,p)},apogeeapp.app.FunctionComponent.generator={},apogeeapp.app.FunctionComponent.generator.displayName="Function",apogeeapp.app.FunctionComponent.generator.uniqueName="apogeeapp.app.FunctionComponent",apogeeapp.app.FunctionComponent.generator.createComponent=apogeeapp.app.FunctionComponent.createComponent,apogeeapp.app.FunctionComponent.generator.createComponentFromJson=apogeeapp.app.FunctionComponent.createComponentFromJson,apogeeapp.app.FunctionComponent.generator.DEFAULT_WIDTH=400,apogeeapp.app.FunctionComponent.generator.DEFAULT_HEIGHT=400,apogeeapp.app.FunctionComponent.generator.ICON_RES_PATH="/functionIcon.png",apogeeapp.app.FunctionComponent.generator.propertyDialogLines=[{type:"inputElement",heading:"Arg List: ",resultKey:"argListString"}],apogeeapp.app.FolderFunctionComponent=function(e,t,p){apogeeapp.app.ParentComponent.call(this,e,t,apogeeapp.app.FolderFunctionComponent.generator,p);var a=t.getInternalFolder();e.registerMember(a,this,t),this.memberUpdated(),this.addSaveAction(apogeeapp.app.FolderFunctionComponent.writeToJson)},apogeeapp.app.FolderFunctionComponent.prototype=Object.create(apogeeapp.app.ParentComponent.prototype),apogeeapp.app.FolderFunctionComponent.prototype.constructor=apogeeapp.app.FolderFunctionComponent,apogeeapp.app.FolderFunctionComponent.prototype.instantiateTabDisplay=function(){var e=this.getMember(),t=e.getInternalFolder();return this.tabDisplay=new apogeeapp.app.TabComponentDisplay(this,e,t),this.tabDisplay},apogeeapp.app.FolderFunctionComponent.writeToJson=function(e){var t=this.getMember().getInternalFolder(),p=this.getWorkspaceUI();e.children=p.getFolderComponentContentJson(t)},apogeeapp.app.FolderFunctionComponent.createComponent=function(e,t,p){var a={};if(a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name,t.argListString){var o=apogee.FunctionTable.parseStringArray(t.argListString);a.argList=o}t.returnValueString&&(a.returnValue=t.returnValueString),t.internalFolder&&(a.internalFolder=t.internalFolder),a.type=apogee.FolderFunction.generator.type;var n=apogee.action.doAction(a),i=a.member;if(n.getSuccess()){var r=apogeeapp.app.FolderFunctionComponent.createComponentFromJson(e,i,p);n.component=r}return n},apogeeapp.app.FolderFunctionComponent.createComponentFromJson=function(e,t,p){var a=new apogeeapp.app.FolderFunctionComponent(e,t,p);if(p&&p.children){var o=t.getInternalFolder();e.loadFolderComponentContentFromJson(o,p.children)}return a},apogeeapp.app.FolderFunctionComponent.generator={},apogeeapp.app.FolderFunctionComponent.generator.displayName="Folder Function",apogeeapp.app.FolderFunctionComponent.generator.uniqueName="apogeeapp.app.FolderFunctionComponent",apogeeapp.app.FolderFunctionComponent.generator.createComponent=apogeeapp.app.FolderFunctionComponent.createComponent,apogeeapp.app.FolderFunctionComponent.generator.createComponentFromJson=apogeeapp.app.FolderFunctionComponent.createComponentFromJson,apogeeapp.app.FolderFunctionComponent.generator.DEFAULT_WIDTH=500,apogeeapp.app.FolderFunctionComponent.generator.DEFAULT_HEIGHT=500,apogeeapp.app.FolderFunctionComponent.generator.ICON_RES_PATH="/functionFolderIcon.png",apogeeapp.app.FolderFunctionComponent.generator.propertyDialogLines=[{type:"inputElement",heading:"Arg List: ",resultKey:"argListString"},{type:"inputElement",heading:"Return Val: ",resultKey:"returnValueString"},{type:"invisible",resultKey:"internalFolder"}],apogeeapp.app.FolderFunctionComponent.generator.appendWorkspaceChildren=function(e,t){var p={};p.name=e.name,p.type=apogee.Folder.generator.type,apogeeapp.app.FolderComponent.generator.appendWorkspaceChildren(p,t),e.internalFolder=p},apogeeapp.app.BasicControlComponent=function(e,t,p,a){apogeeapp.app.EditComponent.call(this,e,t,p,a),this.displayDestroyFlags=apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER,this.memberUpdated()},apogeeapp.app.BasicControlComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.BasicControlComponent.prototype.constructor=apogeeapp.app.BasicControlComponent,apogeeapp.app.BasicControlComponent.prototype.setDisplayDestroyFlags=function(e){this.displayDestroyFlags=e,this.outputMode&&this.outputMode.setDisplayDestroyFlags(e)},apogeeapp.app.BasicControlComponent.VIEW_OUTPUT="Output",apogeeapp.app.BasicControlComponent.VIEW_CODE="Code",apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.BasicControlComponent.VIEW_MODES=[apogeeapp.app.BasicControlComponent.VIEW_OUTPUT,apogeeapp.app.BasicControlComponent.VIEW_CODE,apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION],apogeeapp.app.BasicControlComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.BasicControlComponent.VIEW_MODES,defaultView:apogeeapp.app.BasicControlComponent.VIEW_OUTPUT},apogeeapp.app.BasicControlComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.BasicControlComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.BasicControlComponent.prototype.getViewModeElement=function(e,t){switch(t){case apogeeapp.app.BasicControlComponent.VIEW_OUTPUT:return this.outputMode||(this.outputMode=new apogeeapp.app.ControlOutputMode(e,this.displayDestroyFlags)),this.outputMode;case apogeeapp.app.BasicControlComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(e);case apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(e);case apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(e);default:return alert("unrecognized view element!"),null}},apogeeapp.app.BasicControlComponent.createGenerator=function(e,t,p){var a={};return a.displayName=e,a.uniqueName=t,a.createComponent=function(e,t,o){e.getWorkspace();var n={};n.action="createMember",n.owner=t.parent,n.workspace=t.parent.getWorkspace(),n.name=t.name,n.type=apogee.JsonTable.generator.type;var i=apogee.action.doAction(n),r=n.member;if(r){var s=new p(e,r,a,o);i.component=s}return i},a.createComponentFromJson=function(e,t,o){return new p(e,t,a,o)},a.DEFAULT_WIDTH=500,a.DEFAULT_HEIGHT=500,a.ICON_RES_PATH="/controlIcon.png",a},apogeeapp.app.CustomControlComponent=function(e,t,p){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.CustomControlComponent.generator,p),this.uiCodeFields={},this.currentCss="",this.loadResourceFromJson(p);var a;a=!(!p||void 0===p.destroyOnInactive)&&p.destroyOnInactive,this.setDestroyOnInactive(a),this.memberUpdated(),this.addSaveAction(apogeeapp.app.CustomControlComponent.writeToJson)},apogeeapp.app.CustomControlComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.CustomControlComponent.prototype.constructor=apogeeapp.app.CustomControlComponent,apogeeapp.app.CustomControlComponent.prototype.getDataDisplay=function(e){var t=this.getUiCodeField(apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML),p=this.createResource();return new apogeeapp.app.HtmlJsDataDisplay(t,p,e)},apogeeapp.app.CustomControlComponent.prototype.getUiCodeFields=function(){return this.uiCodeFields},apogeeapp.app.CustomControlComponent.prototype.getUiCodeField=function(e){var t=this.uiCodeFields[e];return null!==t&&void 0!==t||(t=""),t},apogeeapp.app.CustomControlComponent.prototype.getDestroyOnInactive=function(){return this.destroyOnInactive},apogeeapp.app.CustomControlComponent.prototype.setDestroyOnInactive=function(e){if(this.destroyOnInactive=e,this.outputMode){var t=e?apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE:apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER;this.outputMode.setDisplayDestroyFlags(t)}},apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML="html",apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS="css",apogeeapp.app.CustomControlComponent.CODE_FIELD_INIT="init",apogeeapp.app.CustomControlComponent.CODE_FIELD_SET_DATA="setData",apogeeapp.app.CustomControlComponent.CODE_FIELD_IS_CLOSE_OK="isCloseOk",apogeeapp.app.CustomControlComponent.CODE_FIELD_DESTROY="destroy",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_LOAD="onLoad",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_UNLOAD="onUnload",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_RESIZE="onResize",apogeeapp.app.CustomControlComponent.CODE_FIELD_CONSTRUCTOR="constructorAddition",apogeeapp.app.CustomControlComponent.VIEW_OUTPUT="Output",apogeeapp.app.CustomControlComponent.VIEW_CODE="Model Code",apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.CustomControlComponent.VIEW_HTML="HTML",apogeeapp.app.CustomControlComponent.VIEW_CSS="CSS",apogeeapp.app.CustomControlComponent.VIEW_INIT="init(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_SET_DATA="setData(data,element,mode)",apogeeapp.app.CustomControlComponent.VIEW_IS_CLOSE_OK="isCloseOk(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_DESTROY="destroy(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD="onLoad(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_UNLOAD="onUnload(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE="onResize(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR="constructor(mode)",apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.CustomControlComponent.VIEW_MODES=[apogeeapp.app.CustomControlComponent.VIEW_OUTPUT,apogeeapp.app.CustomControlComponent.VIEW_CODE,apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.CustomControlComponent.VIEW_HTML,apogeeapp.app.CustomControlComponent.VIEW_CSS,apogeeapp.app.CustomControlComponent.VIEW_INIT,apogeeapp.app.CustomControlComponent.VIEW_SET_DATA,apogeeapp.app.CustomControlComponent.VIEW_IS_CLOSE_OK,apogeeapp.app.CustomControlComponent.VIEW_DESTROY,apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD,apogeeapp.app.CustomControlComponent.VIEW_ON_UNLOAD,apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE,apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR,apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION],apogeeapp.app.CustomControlComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.CustomControlComponent.VIEW_MODES,defaultView:apogeeapp.app.CustomControlComponent.VIEW_OUTPUT},apogeeapp.app.CustomControlComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.CustomControlComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.CustomControlComponent.prototype.getViewModeElement=function(e,t){switch(t){case apogeeapp.app.CustomControlComponent.VIEW_OUTPUT:return this.outputMode||(this.outputMode=new apogeeapp.app.ControlOutputMode(e,this.displayDestroyFlags)),this.outputMode;case apogeeapp.app.CustomControlComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(e);case apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(e);case apogeeapp.app.CustomControlComponent.VIEW_HTML:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML);case apogeeapp.app.CustomControlComponent.VIEW_CSS:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS);case apogeeapp.app.CustomControlComponent.VIEW_INIT:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_INIT);case apogeeapp.app.CustomControlComponent.VIEW_SET_DATA:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_SET_DATA);case apogeeapp.app.CustomControlComponent.VIEW_IS_CLOSE_OK:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_IS_CLOSE_OK);case apogeeapp.app.CustomControlComponent.VIEW_DESTROY:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_DESTROY);case apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_LOAD);case apogeeapp.app.CustomControlComponent.VIEW_ON_UNLOAD:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_UNLOAD);case apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_RESIZE);case apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR:return new apogeeapp.app.AceCustomControlMode(e,apogeeapp.app.CustomControlComponent.CODE_FIELD_CONSTRUCTOR);case apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(e);default:return alert("unrecognized view element!"),null}},apogeeapp.app.CustomControlComponent.prototype.updateFromJson=function(e){this.loadResourceFromJson(e)},apogeeapp.app.CustomControlComponent.prototype.loadResourceFromJson=function(e){var t;t=e&&e.resource?e.resource:{},this.update(t)},apogeeapp.app.CustomControlComponent.prototype.createResource=function(){try{var e="",t=this.getUiCodeFields();for(var p in apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS){var a=t[p];if(a&&""!=a){var o=apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS[p];e+=apogee.util.formatString(o,a)+"\n"}}var n=apogee.util.formatString(apogeeapp.app.CustomControlComponent.GENERATOR_FUNCTION_FORMAT_TEXT,e);return new Function(n)()()}catch(e){alert("Error creating custom control: "+e.message)}},apogeeapp.app.CustomControlComponent.prototype.update=function(e){this.outputMode&&this.outputMode.forceClearDisplay(),this.uiCodeFields=e;var t=this.getUiCodeField(apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS);return t!==this.currentCss&&(""==t&&""==this.currentCss||(apogeeapp.ui.setMemberCssData(this.getMember().getId(),t),this.currentCss=t)),new apogee.ActionResponse},apogeeapp.app.CustomControlComponent.writeToJson=function(e){e.resource=this.uiCodeFields},apogeeapp.app.CustomControlComponent.GENERATOR_FUNCTION_FORMAT_TEXT=["//member functions","var resourceFunction = function(component) {","var resource = {};","{0}","return resource;","}","//end member functions","return resourceFunction;",""].join("\n"),apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS={constructorAddition:"resource.constructorAddition = function(mode) {\n__customControlDebugHook();\n{0}\n};",init:"resource.init = function(element,mode) {\n{0}\n};",setData:"resource.setData = function(data,element,mode) {\n{0}\n};",isCloseOk:"resource.isCloseOk = function(element,mode) {\n{0}\n};",destroy:"resource.destroy = function(element,mode) {\n{0}\n};",onLoad:"resource.onLoad = function(element,mode) {\n{0}\n};",onUnload:"resource.onUnload = function(element,mode) {\n{0}\n};",onResize:"resource.onResize = function(element,mode) {\n{0}\n};"},apogeeapp.app.CustomControlComponent.createComponent=function(e,t,p){var a={};a.action="createMember",a.owner=t.parent,a.workspace=t.parent.getWorkspace(),a.name=t.name,a.type=apogee.JsonTable.generator.type;var o=apogee.action.doAction(a),n=a.member;if(n){if(!t.destroyOnHide){var i;(i=p?apogee.util.jsonCopy(p):{}).destroyOnInactive=!1}var r=new apogeeapp.app.CustomControlComponent.createComponentFromJson(e,n,i);o.component=r}return o},apogeeapp.app.CustomControlComponent.createComponentFromJson=function(e,t,p){return new apogeeapp.app.CustomControlComponent(e,t,p)},apogeeapp.app.CustomControlComponent.addPropFunction=function(e,t){t.destroyOnHide=e.getDestroyOnInactive()},apogeeapp.app.CustomControlComponent.updateProperties=function(e,t,p,a){var o=!p.destroyOnHide;e.setDestroyOnInactive(o)},apogeeapp.app.CustomControlComponent.generator={},apogeeapp.app.CustomControlComponent.generator.displayName="Custom Control",apogeeapp.app.CustomControlComponent.generator.uniqueName="apogeeapp.app.CustomControlComponent",apogeeapp.app.CustomControlComponent.generator.createComponent=apogeeapp.app.CustomControlComponent.createComponent,apogeeapp.app.CustomControlComponent.generator.createComponentFromJson=apogeeapp.app.CustomControlComponent.createComponentFromJson,apogeeapp.app.CustomControlComponent.generator.DEFAULT_WIDTH=500,apogeeapp.app.CustomControlComponent.generator.DEFAULT_HEIGHT=500,apogeeapp.app.CustomControlComponent.generator.ICON_RES_PATH="/controlIcon.png",apogeeapp.app.CustomControlComponent.generator.propertyDialogLines=[{type:"checkbox",heading:"Destroy on Hide: ",resultKey:"destroyOnHide"}],apogeeapp.app.CustomControlComponent.generator.addPropFunction=apogeeapp.app.CustomControlComponent.addPropFunction,apogeeapp.app.CustomControlComponent.generator.updateProperties=apogeeapp.app.CustomControlComponent.updateProperties,apogeeapp.app.createworkspace={},apogeeapp.app.createworkspace.getCreateCallback=function(e){return function(){e.getWorkspaceUI()&&alert("There is already an open workspace. You must close the workspace first.");var t=apogeeapp.app.createworkspace.createWorkspace(e);t.getSuccess()||alert(t.getErrorMsg())}},apogeeapp.app.createworkspace.createWorkspace=function(e){var t,p=new apogee.ActionResponse;try{if(e.getWorkspaceUI())throw new Error("There is already an open workspace");var a=new apogeeapp.app.WorkspaceUI;t=e.setWorkspaceUI(a);var o=new apogee.Workspace;a.setWorkspace(o),p.workspaceUI=a}catch(a){t&&e.clearWorkspaceUI();var n=apogee.ActionError.processException(a,"AppException",!1);p.addError(n)}return p},apogeeapp.app.openworkspace={},apogeeapp.app.openworkspace.getOpenCallback=function(e){return function(){if(e.getWorkspaceUI())alert("There is already an open workspace. You must close the workspace first.");else{apogeeapp.app.openworkspace.openFile(function(t,p,a){if(t)alert("Error: "+t.message);else{var o=function(e){e.getSuccess()||alert(e.getErrorMsg())};apogeeapp.app.openworkspace.openWorkspace(e,p,a,o)}})}}},apogeeapp.app.openworkspace.openWorkspace=function(e,t,p,a){var o,n=new apogee.ActionResponse;try{if(e.getWorkspaceUI())throw new Error("There is already an open workspace");var i=JSON.parse(t),r=new apogeeapp.app.WorkspaceUI;o=e.setWorkspaceUI(r);var s,l,d=!1;i.jsLinks&&i.jsLinks.length>0?(s=i.jsLinks,d=!0):s=[],i.cssLinks&&i.cssLinks.length>0?(l=i.cssLinks,d=!0):l=[];var u=function(){apogeeapp.app.openworkspace.loadWorkspace(r,i),a(n)};d?r.setLinks(s,l,u):u()}catch(t){o&&e.clearWorkspaceUI();var c=apogee.ActionError.processException(t,"AppException",!1);n.addError(c),a(n)}},apogeeapp.app.openworkspace.loadWorkspace=function(e,t,p){var a=t.workspace,o=t.components,n=new apogee.Workspace(a,p);e.setWorkspace(n,o)},apogeeapp.app.openworkspace.openWorkspaceFromUrl=function(e,t){apogeeapp.app.openworkspace.openWorkspaceFromUrlImpl(e,t,function(e){e.getSuccess()||alert(e.getErrorMsg())})},apogeeapp.app.openworkspace.openWorkspaceFromUrlImpl=function(e,t,p){apogeeapp.app.openworkspace.doRequest(t,function(a){apogeeapp.app.openworkspace.openWorkspace(e,a,t,p)},function(e){var t=new apogee.ActionError(e,"AppException",null),a=new apogee.ActionResponse;a.addError(t),p(a)})},apogeeapp.app.openworkspace.doRequest=function(e,t,p){var a=new XMLHttpRequest;a.onreadystatechange=function(){var e;4==a.readyState&&200==a.status?t(a.responseText):4==a.readyState&&a.status>=400&&(e="Error in http request. Status: "+a.status,p(e))},a.open("GET",e,!0),a.send()},apogeeapp.app.saveworkspace={},apogeeapp.app.saveworkspace.getSaveCallback=function(e,t){return function(){var e=apogeeapp.app.saveworkspace.getWorkspaceText();e?void 0===t?apogeeapp.app.saveworkspace.showSaveDialog(e):apogeeapp.app.saveworkspace.saveFile(t,e):alert("There is no workspace open.")}},apogeeapp.app.saveworkspace.getWorkspaceText=function(){var e=app.getWorkspaceUI();if(e){var t=e.toJson();return JSON.stringify(t)}},apogeeapp.app.importworkspace={},apogeeapp.app.importworkspace.getImportCallback=function(e,t){return function(){if(e.getWorkspaceUI()){apogeeapp.app.openworkspace.openFile(function(p,a,o){if(p)alert("Error: "+p.message);else{var n=function(e){e.getSuccess()||alert(e.getErrorMsg())};apogeeapp.app.importworkspace.openWorkspace(e,t,a,o,n)}})}else alert("There must be an open workspace to import a workspace.")}},apogeeapp.app.importworkspace.openWorkspace=function(e,t,p,a,o){var n=new apogee.ActionResponse;try{var i,r,s=e.getWorkspaceUI(),l=JSON.parse(p),d=!1;l.jsLinks&&l.jsLinks.length>0?(i=l.jsLinks,d=!0):i=[],l.cssLinks&&l.cssLinks.length>0?(r=l.cssLinks,d=!0):r=[];var u={};u.name=l.workspace.data.name,t.appendWorkspaceChildren(u,l.workspace.data.children);var c={};c.children=l.components;var g=apogeeapp.app.addcomponent.getAddComponentCallback(e,t,u,c);d?s.setLinks(i,r,g):g()}catch(e){var h=apogee.ActionError.processException(e,"AppException",!1);n.addError(h),o(n)}},apogeeapp.app.importworkspace.openWorkspaceFromUrl=function(e,t){apogeeapp.app.importworkspace.openWorkspaceFromUrlImpl(e,t,function(e){e.getSuccess()||alert(e.getErrorMsg())})},apogeeapp.app.importworkspace.openWorkspaceFromUrlImpl=function(e,t,p){apogeeapp.app.importworkspace.doRequest(t,function(a){apogeeapp.app.importworkspace.openWorkspace(e,a,t,p)},function(e){var t=new apogee.ActionError(e,"AppException",null),a=new apogee.ActionResponse;a.addError(t),p(a)})},apogeeapp.app.importworkspace.doRequest=function(e,t,p){var a=new XMLHttpRequest;a.onreadystatechange=function(){var e;4==a.readyState&&200==a.status?t(a.responseText):4==a.readyState&&a.status>=400&&(e="Error in http request. Status: "+a.status,p(e))},a.open("GET",e,!0),a.send()},apogeeapp.app.exportworkspace={},apogeeapp.app.exportworkspace.getExportCallback=function(e){return function(){var t=e.getWorkspaceUI();if(t){var p=t.getFolders(),a=[];for(var o in p)a.push(o);var n=apogeeapp.app.exportworkspace.getExportDialogLayout(a);apogeeapp.app.dialog.showConfigurableDialog(n,function(e){var t=p[e.parentName],a=apogeeapp.app.exportworkspace.getWorkspaceText(t);if(a)return apogeeapp.app.saveworkspace.showSaveDialog(a),!0;alert("There is no workspace open.")})}else alert("There is no open workspace.")}},apogeeapp.app.exportworkspace.getWorkspaceText=function(e){var t=app.getWorkspaceUI();if(t){var p=t.toJson(e);return JSON.stringify(p)}},apogeeapp.app.exportworkspace.getExportDialogLayout=function(e){var t={},p=[];t.lines=p;var a={};if(a.type="title",a.title="Export Folder as Workspace",p.push(a),e){var o={};o.type="dropdown",o.heading="Folder: ",o.entries=e,o.resultKey="parentName",p.push(o)}var n={};return n.type="submit",n.submit="OK",n.cancel="Cancel",p.push(n),t},apogeeapp.app.closeworkspace={},apogeeapp.app.closeworkspace.getCloseCallback=function(e){return function(){var t=apogeeapp.app.closeworkspace.closeWorkspace(e);t.getSuccess()||alert(t.getErrorMsg())}},apogeeapp.app.closeworkspace.closeWorkspace=function(e){var t=new apogee.ActionResponse,p=!1;try{var a=e.getWorkspaceUI();if(null===a){i=new apogee.ActionError("There is no workspace open.","User",null);return t.addError(i),t}var o=a.getWorkspace();if(!confirm("Are you sure you want to close the workspace?"))return t;p=e.clearWorkspaceUI(),a.close(),o.onClose()}catch(e){var n=!p,i=apogee.ActionError.processException(e,"AppException",n);t.addError(i)}return t},apogeeapp.app.addcomponent={},apogeeapp.app.addcomponent.getAddComponentCallback=function(e,t,p,a){return function(){var o=e.getWorkspaceUI();if(o){var n=o.getFolders(),i=[];for(var r in n)i.push(r);var s=apogeeapp.app.propdialog.getDialogLayout(i,t,!0,p);apogeeapp.app.dialog.showConfigurableDialog(s,function(e){var p=apogee.codeCompiler.validateTableName(e.name);if(!p.valid)return alert(p.errorMessage),!1;e.parent=n[e.parentName];var i=t.createComponent(o,e,a);return i.getSuccess()||alert(i.getErrorMsg()),!0})}else alert("There is no open workspace.")}},apogeeapp.app.addcomponent.getAddAdditionalComponentCallback=function(e,t,p){return function(){apogeeapp.app.dialog.showSelectComponentDialog(e.additionalComponents,function(a){var o=e.getComponentGenerator(a);o?apogeeapp.app.addcomponent.getAddComponentCallback(e,o,t,p)():alert("Unknown component type: "+a)})}},apogeeapp.app.updatecomponent={},apogeeapp.app.updatecomponent.getUpdateComponentCallback=function(e){var t=e.generator;return function(){var p=e.getWorkspaceUI(),a=e.getPropertyValues(),o=null,n=null;if(e.getMember().getParent()){o=p.getFolders(),n=[];for(var i in o)n.push(i)}var r=apogeeapp.app.propdialog.getDialogLayout(n,t,!1,a);apogeeapp.app.dialog.showConfigurableDialog(r,function(t){var p=!1;for(var n in t)t[n]!==a[n]&&(p=!0);if(!p)return!0;if(t.name!==a.name){var i=apogee.codeCompiler.validateTableName(t.name);if(!i.valid)return alert(i.errorMessage),!1}t.owner=o?o[t.parentName]:e.getMember().getOwner();var r=apogeeapp.app.updatecomponent.updatePropertyValues(e,a,t);return r.getSuccess()||alert(r.getErrorMsg()),!0})}},apogeeapp.app.updatecomponent.updatePropertyValues=function(e,t,p){var a,o=new apogee.ActionResponse,n=e.getMember(),i=e.getWorkspace(),r=[];t.name===p.name&&t.parentName===p.parentName||((a={}).action="moveMember",a.member=n,a.name=p.name,a.owner=p.owner,r.push(a));var s=n.generator;return s.getPropertyUpdateAction&&(a=s.getPropertyUpdateAction(n,t,p))&&r.push(a),r.length>0&&((a={}).action="compoundAction",a.actions=r,a.workspace=i,o=apogee.action.doAction(a,o)),e.generator.updateProperties&&e.generator.updateProperties(e,t,p,o),o},apogeeapp.app.updatelinks={},apogeeapp.app.updatelinks.getUpdateLinksCallback=function(e){return function(){var t=e.getWorkspaceUI();t?apogeeapp.app.dialog.showUpdateLinksDialog(t):alert("There is no open workspace.")}},apogeeapp.app.ViewMode=function(e,t){this.componentDisplay=e,this.member=e.getMember(),this.setDisplayDestroyFlags(t),this.dataDisplay=null,this.modeActive=!1,this.displayInWindow=!1,this.inEditMode=!1;var p=e.getWindowFrame();this.windowMinimized=p.getWindowState()==apogeeapp.ui.WINDOW_STATE_MINIMIZED,p.addListener(apogeeapp.ui.WINDOW_STATE_CHANGED,e=>this.onWindowStateChange(e)),this.windowLoaded=p.getIsShowing(),p.addListener(apogeeapp.ui.SHOWN_EVENT,()=>this.onWindowLoaded()),p.addListener(apogeeapp.ui.HIDDEN_EVENT,()=>this.onWindowUnloaded()),p.addListener(apogeeapp.ui.RESIZED_EVENT,()=>this.onWindowResized())},apogeeapp.app.ViewMode.UNSAVED_DATA=-1,apogeeapp.app.ViewMode.CLOSE_OK=0,apogeeapp.app.ViewMode.VIEW_STATE_INACTIVE=1,apogeeapp.app.ViewMode.VIEW_STATE_MINIMIZED=2,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER=0,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE=1,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED=3,apogeeapp.app.ViewMode.prototype.getMember=function(){return this.member},apogeeapp.app.ViewMode.prototype.getDisplayWindow=function(){return this.componentDisplay.getWindowFrame()},apogeeapp.app.ViewMode.prototype.getElement=function(){return this.dataDisplay?this.dataDisplay.getElement():null},apogeeapp.app.ViewMode.prototype.setDisplayDestroyFlags=function(e){this.destroyOnInactive=0!=(e&apogeeapp.app.ViewMode.VIEW_STATE_INACTIVE),this.destroyOnMinimize=0!=(e&apogeeapp.app.ViewMode.VIEW_STATE_MINIMIZED)},apogeeapp.app.ViewMode.prototype.forceClearDisplay=function(){this.destroyDataDisplay()},apogeeapp.app.ViewMode.prototype.setActive=function(){this.modeActive=!0,this.setDisplayState()},apogeeapp.app.ViewMode.prototype.setInactive=function(){this.modeActive=!1,this.setDisplayState()},apogeeapp.app.ViewMode.prototype.destroy=function(){this.destroyDataDisplay()},apogeeapp.app.ViewMode.prototype.isCloseOk=function(){if(this.dataDisplay){if(this.dataDisplay.isCloseOk)return this.dataDisplay.isCloseOk();if(this.inEditMode)return apogeeapp.app.ViewMode.UNSAVED_DATA}return apogeeapp.app.ViewMode.CLOSE_OK},apogeeapp.app.ViewMode.prototype.memberUpdated=function(){this.dataDisplay&&!this.inEditMode&&this.setData()},apogeeapp.app.ViewMode.prototype.onCancel=function(){return this.setData(),!0},apogeeapp.app.ViewMode.prototype.startEditMode=function(e,t){this.inEditMode=!0,this.componentDisplay.startEditUI(e,t)},apogeeapp.app.ViewMode.prototype.endEditMode=function(){this.inEditMode=!1,this.componentDisplay.endEditUI()},apogeeapp.app.ViewMode.prototype.onWindowStateChange=function(e){this.windowMinimized=e.getWindowState()==apogeeapp.ui.WINDOW_STATE_MINIMIZED,this.setDisplayState()},apogeeapp.app.ViewMode.prototype.onWindowLoaded=function(){this.windowLoaded=!0,this.dataDisplay&&this.dataDisplay.onLoad&&this.dataDisplay.onLoad()},apogeeapp.app.ViewMode.prototype.onWindowUnloaded=function(){this.windowLoaded=!0,this.dataDisplay&&this.dataDisplay.onUnload&&this.dataDisplay.onUnload()},apogeeapp.app.ViewMode.prototype.onWindowResized=function(){this.dataDisplay&&this.displayInWindow&&this.dataDisplay.onResize&&this.dataDisplay.onResize()},apogeeapp.app.ViewMode.prototype.setData=function(){this.dataDisplay.showData(this.getDisplayData(),this.getIsDataEditable())},apogeeapp.app.ViewMode.prototype.setDisplayState=function(){var e=this.modeActive,t=!this.modeActive&&this.destroyOnInactive||this.windowMinimized&&this.destroyOnMinimize;e?this.dataDisplay?this.displayInWindow||this.placeDisplayInWindow():(this.dataDisplay=this.createDisplay(),this.placeDisplayInWindow(),this.setData()):this.dataDisplay&&(this.displayInWindow&&this.removeDisplayfromWindow(),t&&this.isCloseOk()===apogeeapp.app.ViewMode.CLOSE_OK&&this.destroyDataDisplay())},apogeeapp.app.ViewMode.prototype.placeDisplayInWindow=function(){this.dataDisplay&&(this.componentDisplay.showDisplayElement(this.dataDisplay.getElement()),this.windowLoaded&&this.dataDisplay.onLoad&&this.dataDisplay.onLoad(),this.displayInWindow=!0)},apogeeapp.app.ViewMode.prototype.removeDisplayfromWindow=function(){this.dataDisplay&&(this.componentDisplay.removeDisplayElement(this.dataDisplay.getElement()),this.windowLoaded&&this.dataDisplay.onUnload&&this.dataDisplay.onUnload(),this.displayInWindow=!1)},apogeeapp.app.ViewMode.prototype.destroyDataDisplay=function(){this.dataDisplay&&(this.dataDisplay.destroy&&this.dataDisplay.destroy(),this.dataDisplay=null)},apogeeapp.app.TextAreaEditor=function(e){this.outsideDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"});var t=apogeeapp.ui.createElement("TEXTAREA",null,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",overflow:"auto"});this.textArea=t,this.textArea.readOnly=!0,this.outsideDiv.appendChild(this.textArea),this.viewMode=e,this.workingData=null,this.editOk=!1,this.editMode=!1;var p=this;this.textArea.addEventListener("click",function(){p.onMouseClick()})},apogeeapp.app.TextAreaEditor.prototype.save=function(){var e=this.textArea.value;this.viewMode.onSave(e)&&this.endEditMode()},apogeeapp.app.TextAreaEditor.prototype.cancel=function(){this.viewMode.onCancel()&&this.endEditMode()},apogeeapp.app.TextAreaEditor.prototype.getElement=function(){return this.outsideDiv},apogeeapp.app.TextAreaEditor.prototype.showData=function(e,t){this.editOk=t,this.textArea.readOnly=!t,this.textArea.value=e,this.editOk?this.textArea.style.backgroundColor="":this.textArea.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR},apogeeapp.app.TextAreaEditor.prototype.destroy=function(){},apogeeapp.app.TextAreaEditor.prototype.endEditMode=function(){this.editMode=!1,this.textArea.readOnly=!0,this.viewMode.endEditMode()},apogeeapp.app.TextAreaEditor.prototype.onMouseClick=function(){if(this.editOk&&!this.editMode){var e=this,t=function(){e.save()},p=function(){e.cancel()};this.viewMode.startEditMode(t,p),this.textArea.readOnly=!1,this.editMode=!0}},apogeeapp.app.TextAreaMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.TextAreaMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.TextAreaMode.prototype.constructor=apogeeapp.app.TextAreaMode,apogeeapp.app.TextAreaMode.formatString="\t",apogeeapp.app.TextAreaMode.prototype.createDisplay=function(){return new apogeeapp.app.TextAreaEditor(this)},apogeeapp.app.TextAreaMode.prototype.getDisplayData=function(){var e=this.member.getData();return null===e?"null":void 0===e?"undefined":JSON.stringify(e,null,apogeeapp.app.TextAreaMode.formatString)},apogeeapp.app.TextAreaMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.TextAreaMode.prototype.onSave=function(e){var t;if(e.length>0)try{t=JSON.parse(e)}catch(e){return alert("There was an error parsing the JSON input: "+e.message),!1}else t="";var p={};p.action="updateData",p.member=this.member,p.data=t;apogee.action.doAction(p);return!0},apogeeapp.app.AceTextEditor=function(e,t){this.outsideDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"}),this.editorDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.outsideDiv.appendChild(this.editorDiv),this.viewMode=e,this.workingData=null,this.editOk=!1,this.editMode=!1;var p=ace.edit(this.editorDiv);p.renderer.setShowGutter(!0),p.setReadOnly(!0),p.setTheme("ace/theme/eclipse"),p.getSession().setMode(t),p.$blockScrolling=1/0,this.editor=p;var a=this;this.editorDiv.addEventListener("click",function(){a.onMouseClick()})},apogeeapp.app.AceTextEditor.prototype.save=function(){var e=this.editor.getSession().getValue();this.viewMode.onSave(e)&&this.endEditMode()},apogeeapp.app.AceTextEditor.prototype.cancel=function(){this.viewMode.onCancel()&&this.endEditMode()},apogeeapp.app.AceTextEditor.prototype.getElement=function(){return this.outsideDiv},apogeeapp.app.AceTextEditor.prototype.showData=function(e,t){this.editOk=t,this.editor.getSession().setValue(e),this.editOk?this.editorDiv.style.backgroundColor="":this.editorDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR},apogeeapp.app.AceTextEditor.prototype.onLoad=function(){this.editor&&this.editor.resize()},apogeeapp.app.AceTextEditor.prototype.onResize=function(){this.editor&&this.editor.resize()},apogeeapp.app.AceTextEditor.prototype.destroy=function(){this.editor&&(this.editor.destroy(),this.editor=null)},apogeeapp.app.AceTextEditor.prototype.endEditMode=function(){this.editMode=!1,this.editor.setReadOnly(!0),this.viewMode.endEditMode()},apogeeapp.app.AceTextEditor.prototype.onMouseClick=function(){if(this.editOk&&!this.editMode){var e=this,t=function(){e.save()},p=function(){e.cancel()};this.viewMode.startEditMode(t,p),this.editor.setReadOnly(!1),this.editMode=!0}},apogeeapp.app.AceCodeMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.AceCodeMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceCodeMode.prototype.constructor=apogeeapp.app.AceCodeMode,apogeeapp.app.AceCodeMode.prototype.createDisplay=function(){return new apogeeapp.app.AceTextEditor(this,"ace/mode/javascript")},apogeeapp.app.AceCodeMode.prototype.getDisplayData=function(){return this.member.getFunctionBody()},apogeeapp.app.AceCodeMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceCodeMode.prototype.onSave=function(e){var t={};this.onBlankData&&""===e?(t.action="updateData",t.member=this.member,t.data=this.onBlankData.dataValue):(t.action="updateCode",t.member=this.member,t.argList=this.member.getArgList(),t.functionBody=e,t.supplementalCode=this.member.getSupplementalCode());apogee.action.doAction(t);return!0},apogeeapp.app.AceDataMode=function(e,t){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED),this.doJsonFormatting=t},apogeeapp.app.AceDataMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceDataMode.prototype.constructor=apogeeapp.app.AceDataMode,apogeeapp.app.AceDataMode.formatString="\t",apogeeapp.app.AceDataMode.prototype.createDisplay=function(){var e=this.doJsonFormatting?"ace/mode/json":"ace/mode/text";return new apogeeapp.app.AceTextEditor(this,e)},apogeeapp.app.AceDataMode.prototype.getDisplayData=function(){var e=this.member.getData();return null===e?"null":void 0===e?"undefined":JSON.stringify(e,null,apogeeapp.app.AceDataMode.formatString)},apogeeapp.app.AceDataMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.AceDataMode.prototype.onSave=function(e){var t;if(e.length>0)try{t=JSON.parse(e)}catch(e){return alert("There was an error parsing the JSON input: "+e.message),!1}else t="";var p={};p.action="updateData",p.member=this.member,p.data=t;apogee.action.doAction(p);return!0},apogeeapp.app.AceDescriptionMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.AceDescriptionMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceDescriptionMode.prototype.constructor=apogeeapp.app.AceDescriptionMode,apogeeapp.app.AceDescriptionMode.prototype.createDisplay=function(){return new apogeeapp.app.TextAreaEditor(this)},apogeeapp.app.AceDescriptionMode.prototype.getDisplayData=function(){return this.member.getDescription()},apogeeapp.app.AceDescriptionMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceDescriptionMode.prototype.onSave=function(e){null!==e&&void 0!==e||(e="");var t={};t.action="updateDescription",t.member=this.member,t.description=e;apogee.action.doAction(t);return!0},apogeeapp.app.AceTextMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.AceTextMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceTextMode.prototype.constructor=apogeeapp.app.AceTextMode,apogeeapp.app.AceTextMode.prototype.createDisplay=function(){return new apogeeapp.app.AceTextEditor(this,"ace/mode/text")},apogeeapp.app.AceTextMode.prototype.getDisplayData=function(){var e=this.member.getData();return null===e||void 0===e?"":e},apogeeapp.app.AceTextMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.AceTextMode.prototype.onSave=function(e){null!==e&&void 0!==e||(e="");var t={};t.action="updateData",t.member=this.member,t.data=e;apogee.action.doAction(t);return!0},apogeeapp.app.AceSupplementalMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.AceSupplementalMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceSupplementalMode.prototype.constructor=apogeeapp.app.AceSupplementalMode,apogeeapp.app.AceSupplementalMode.prototype.createDisplay=function(){return new apogeeapp.app.AceTextEditor(this,"ace/mode/javascript")},apogeeapp.app.AceSupplementalMode.prototype.getDisplayData=function(){return this.member.getSupplementalCode()},apogeeapp.app.AceSupplementalMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceSupplementalMode.prototype.onSave=function(e){var t={};return t.action="updateCode",t.member=this.member,t.argList=this.member.getArgList(),t.functionBody=this.member.getFunctionBody(),t.supplementalCode=e,apogee.action.doAction(t).getSuccess(),!0},apogeeapp.app.AceCustomControlMode=function(e,t){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED),this.component=e.getComponent(),this.codeField=t},apogeeapp.app.AceCustomControlMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceCustomControlMode.prototype.constructor=apogeeapp.app.AceCustomControlMode,apogeeapp.app.AceCustomControlMode.prototype.createDisplay=function(){var e;return e=this.codeField===apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML?"ace/mode/html":this.codeField===apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS?"ace/mode/css":"ace/mode/javascript",new apogeeapp.app.AceTextEditor(this,e)},apogeeapp.app.AceCustomControlMode.prototype.getDisplayData=function(){var e=this.component.getUiCodeFields()[this.codeField];return void 0!==e&&null!==e||(e=""),e},apogeeapp.app.AceCustomControlMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceCustomControlMode.prototype.onSave=function(e){var t=this.component.getUiCodeFields();t[this.codeField]=e;var p=this.component.update(t);if(!p.getSuccess()){var a=p.getErrorMsg();alert(a)}return!0},apogeeapp.app.HtmlJsDataDisplay=function(e,t,p){if(this.resource=t,this.outputMode=p,this.containerElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"}),this.outputElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.containerElement.appendChild(this.outputElement),e&&(this.outputElement.innerHTML=e),t.constructorAddition)try{t.constructorAddition.call(t,p)}catch(e){alert("Error in "+this.outputMode.getFullName()+" init function: "+e.message)}var a=this;if(this.resource.onLoad&&(this.onLoad=function(){try{t.onLoad.call(t,a.outputElement,a.outputMode)}catch(e){alert("Error in "+a.outputMode.getFullName()+" onLoad function: "+e.message)}}),this.resource.onUnload&&(this.onUnload=function(){try{a.resource.onHide&&t.onUnload.call(t,a.outputElement,a.outputMode)}catch(e){alert("Error in "+a.outputMode.getFullName()+" onUnload function: "+e.message)}}),this.resource.onResize&&(this.onResize=function(){try{t.onResize.call(t,a.outputElement,a.outputMode)}catch(e){console.log("Error in "+a.outputMode.getFullName()+" onResize function: "+e.message)}}),this.resource.setData?this.showData=function(e){try{this.resource.setData&&t.setData.call(t,e,a.outputElement,a.outputMode)}catch(e){alert("Error in "+a.outputMode.getFullName()+" setData function: "+e.message)}}:this.showData=function(e){},this.resource.isCloseOk&&(this.isCloseOk=function(){try{t.isCloseOk.call(t,a.outputElement,a.outputMode)}catch(e){alert("Error in "+a.outputMode.getFullName()+" isCloseOk function: "+e.message)}}),this.resource.destroy&&(this.destroy=function(){try{t.destroy.call(t,a.outputElement,a.outputMode)}catch(e){alert("Error in "+a.outputMode.getFullName()+" destroy function: "+e.message)}}),t.init)try{t.init.call(t,this.outputElement,p)}catch(e){alert("Error in "+this.outputMode.getFullName()+" init function: "+e.message)}},apogeeapp.app.HtmlJsDataDisplay.prototype.getElement=function(){return this.containerElement},apogeeapp.app.JsDataDisplay=function(e){this.outputMode=e,this.outputElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"})},apogeeapp.app.JsDataDisplay.prototype.getElement=function(){return this.outputElement},apogeeapp.app.JsDataDisplay.prototype.getOutputMode=function(){return this.outputMode},apogeeapp.app.JsonFormEditor=function(e){this.editorDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.workingData={d:"c"},this.editOk=!1,this.editor=null;var t=this;this.editCallback=function(){var p=t.editor.getCurrentValue();t.workingData=p,e.onSave(p)}},apogeeapp.app.JsonFormEditor.prototype.getElement=function(){return this.editorDiv},apogeeapp.app.JsonFormEditor.prototype.showData=function(e,t){e===this.workingData&&this.editOk===t||(void 0===e&&(e=null),this.workingData=apogee.util.jsonCopy(e),this.editOk=t,apogeeapp.ui.removeAllChildren(this.editorDiv),this.editor=new apogeeapp.jsonedit.JsonEditArea(this.editorDiv,e,t),this.editor.setEditCallback(this.editCallback),this.editOk?this.editorDiv.style.backgroundColor="":this.editorDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR)},apogeeapp.app.JsonFormEditor.prototype.destroy=function(){},apogeeapp.app.FormDataMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.FormDataMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.FormDataMode.prototype.constructor=apogeeapp.app.FormDataMode,apogeeapp.app.FormDataMode.prototype.createDisplay=function(){return new apogeeapp.app.JsonFormEditor(this)},apogeeapp.app.FormDataMode.prototype.getDisplayData=function(){return this.member.getData()},apogeeapp.app.FormDataMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.FormDataMode.prototype.onSave=function(e){var t={};t.action="updateData",t.member=this.member,t.data=e;apogee.action.doAction(t);return!0},apogeeapp.app.HandsonGridEditor=function(e){this.outsideDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"}),this.gridDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",width:"50px",height:"50px",overflow:"hidden",zIndex:0}),this.outsideDiv.appendChild(this.gridDiv),this.viewMode=e,this.inputData=null,this.editOk=!1,this.activeEditOk=void 0,this.dataCached=!1;var t=this;this.callbackAttached=!1,this.loaded=!1,this.gridEdited=function(e){t.save(arguments)},this.timerInProcess=!1;this.delayGridEdited=function(e){if(!t.timerInProcess){t.timerInProcess=!0;var p=function(e){t.timerInProcess=!1,t.gridEdited(arguments)};setTimeout(p,50)}}},apogeeapp.app.HandsonGridEditor.prototype.save=function(e){"loadData"!=e[1]&&(this.inputData=apogee.util.jsonCopy(this.gridControl.getData()),this.viewMode.onSave(this.inputData))},apogeeapp.app.HandsonGridEditor.prototype.cancel=function(){this.viewMode.onCancel()},apogeeapp.app.HandsonGridEditor.prototype.getElement=function(){return this.outsideDiv},apogeeapp.app.HandsonGridEditor.prototype.showData=function(e,t){this.inputData===e&&t||(this.editOk=t,this.inputData=e,this.dataCached=!0,this.loaded&&this.displayData())},apogeeapp.app.HandsonGridEditor.prototype.displayData=function(){this.dataCached=!1;var e=apogee.util.jsonCopy(this.inputData);e||(e=[[]]),this.gridControl&&this.activeEditOk===this.editOk?this.gridControl.loadData(e):(this.createNewGrid(e),this.activeEditOk=this.editOk),this.editOk?this.gridDiv.style.backgroundColor="":this.gridDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR},apogeeapp.app.HandsonGridEditor.prototype.onLoad=function(){this.loaded=!0,this.dataCached&&this.displayData()},apogeeapp.app.HandsonGridEditor.prototype.onUnload=function(){this.loaded=!1},apogeeapp.app.HandsonGridEditor.prototype.onResize=function(){this.setSize()},apogeeapp.app.HandsonGridEditor.prototype.setSize=function(){this.gridDiv&&(this.gridDiv.style.width=this.outsideDiv.clientWidth+"px",this.gridDiv.style.height=this.outsideDiv.clientHeight+"px",this.gridControl&&this.gridControl.render())},apogeeapp.app.HandsonGridEditor.prototype.destroy=function(){this.gridControl&&(this.gridControl.destroy(),this.gridControl=null)},apogeeapp.app.HandsonGridEditor.prototype.createNewGrid=function(e){this.gridControl&&(this.gridControl.destroy(),this.gridControl=null);var t;this.editOk?(t={data:e,rowHeaders:!0,colHeaders:!0,contextMenu:!0,afterChange:this.gridEdited,afterCreateCol:this.delayGridEdited,afterCreateRow:this.delayGridEdited,afterRemoveCol:this.gridEdited,afterRemoveRow:this.gridEdited},this.gridEditable=!0):(t={data:e,readOnly:!0,rowHeaders:!0,colHeaders:!0},this.gridEditable=!1),this.gridControl=new Handsontable(this.gridDiv,t),this.setSize()},apogeeapp.app.HandsonGridMode=function(e){apogeeapp.app.ViewMode.call(this,e,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED)},apogeeapp.app.HandsonGridMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.HandsonGridMode.prototype.constructor=apogeeapp.app.HandsonGridMode,apogeeapp.app.HandsonGridMode.prototype.createDisplay=function(){return new apogeeapp.app.HandsonGridEditor(this)},apogeeapp.app.HandsonGridMode.prototype.getDisplayData=function(){return this.member.getData()},apogeeapp.app.HandsonGridMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.HandsonGridMode.prototype.onSave=function(e){var t={};t.action="updateData",t.member=this.member,t.data=e;apogee.action.doAction(t);return!0},apogeeapp.app.ControlOutputMode=function(e,t){apogeeapp.app.ViewMode.call(this,e,t),this.component=e.getComponent(),this.member=this.component.getMember()},apogeeapp.app.ControlOutputMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.ControlOutputMode.prototype.constructor=apogeeapp.app.ControlOutputMode,apogeeapp.app.ControlOutputMode.prototype.createDisplay=function(){return this.component.getDataDisplay(this)},apogeeapp.app.ControlOutputMode.prototype.getDisplayData=function(){return this.member.getData()},apogeeapp.app.ControlOutputMode.prototype.getFullName=function(){return this.member.getFullName()},apogeeapp.app.ControlOutputMode.prototype.getMessenger=function(){return new apogee.action.Messenger(this.member)},apogeeapp.app.ControlOutputMode.prototype.getIsDataEditable=function(){return!1},apogeeapp.app.dialog.showConfigurableDialog=function(e,t){var p=apogeeapp.ui.createDialog({movable:!0}),a=[],o={};o.onClose=function(){for(var e=0;e<a.length;e++)(s=a[e]).onClose&&s.onClose();apogeeapp.ui.closeDialog(p)},o.onCancel=function(){o.onClose()},o.onSubmit=function(){for(var e,p={},n=0;n<a.length;n++)(e=a[n]).addToResult&&e.addToResult(p);t(p)&&o.onClose()};for(var n=apogeeapp.ui.createElement("div",{className:"dialogBody"}),i=0;i<e.lines.length;i++){var r=e.lines[i],s=apogeeapp.app.dialog.showConfigurableDialog.createLine(r,o);a.push(s),s.element&&n.appendChild(s.element)}p.setContent(n),apogeeapp.ui.showDialog(p),p.fitToContent(),p.centerInParent()},apogeeapp.app.dialog.showConfigurableDialog.createLine=function(e,t){var p=apogeeapp.app.dialog.showConfigurableDialog.lineFunctions[e.type];return p?p(e,t):(alert("Error: Unknown for element type: "+e.type),null)},apogeeapp.app.dialog.showConfigurableDialog.lineFunctions={title:function(e,t){var p={},a=apogeeapp.ui.createElement("div",{className:"dialogLine"});return a.appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:e.title})),p.element=a,p},dropdown:function(e,t){var p={},a=apogeeapp.ui.createElement("div",{className:"dialogLine"});e.heading&&a.appendChild(document.createTextNode(e.heading));for(var o=apogeeapp.ui.createElement("select"),n=0;n<e.entries.length;n++){var i=e.entries[n];o.add(apogeeapp.ui.createElement("option",{text:i}))}return e.initial&&(o.value=e.initial),e.disabled&&(o.disabled=!0),a.appendChild(o),p.element=a,p.addToResult=function(t){var p=o.value;t[e.resultKey]=p},p},inputElement:function(e,t){var p={},a=apogeeapp.ui.createElement("div",{className:"dialogLine"});e.heading&&a.appendChild(document.createTextNode(e.heading));var o=apogeeapp.ui.createElement("input",{type:"text"});return e.initial&&(o.value=e.initial),e.disabled&&(o.disabled=!0),a.appendChild(o),p.element=a,p.addToResult=function(t){var p=o.value.trim();t[e.resultKey]=p},p},aceEditor:function(e,t){},radioButton:function(e,t){},checkbox:function(e,t){var p={},a=apogeeapp.ui.createElement("div",{className:"dialogLine"});e.heading&&a.appendChild(document.createTextNode(e.heading));var o=apogeeapp.ui.createElement("input");return o.type="checkbox",e.name&&(o.name=e.name),e.value&&(o.value=e.value),e.initial&&(o.checked=!0),a.appendChild(o),p.element=a,p.addToResult=function(t){var p=o.checked;t[e.resultKey]=p},p},submit:function(e,t){var p={},a=apogeeapp.ui.createElement("div",{className:"dialogLine"});return e.submit&&a.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:e.submit,onclick:t.onSubmit})),e.cancel&&a.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:e.cancel,onclick:t.onCancel})),p.element=a,p},custom:function(e,t){return e.createLineObject(t)},invisible:function(e,t){var p={};return p.element=null,p.addToResult=function(t){t[e.resultKey]=e.initial},p}},apogeeapp.app.dialog.showUpdateLinksDialog=function(e){var t=apogeeapp.ui.createDialog({minimizable:!0,maximizable:!0,movable:!0}),p=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",height:"100%",overflow:"auto"});t.setContent(p);var a=apogeeapp.ui.createElement("div",null,{display:"table",overflow:"hidden"});p.appendChild(a);var o;(o=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:"Update Links"})),a.appendChild(o),o=apogeeapp.ui.createElement("div",{className:"dialogLine"});var n=apogeeapp.ui.createElement("input",{type:"radio",name:"componentContent",value:"jsLinks"});o.appendChild(n),o.appendChild(document.createTextNode("JS Links")),a.appendChild(o);var i=apogeeapp.ui.createElement("input",{type:"radio",name:"componentContent",value:"cssLinks"});o.appendChild(i),o.appendChild(document.createTextNode("CSS Links")),o=apogeeapp.ui.createElement("div",{className:"dialogLine"});var r=apogeeapp.ui.createElement("div",null,{position:"relative",width:"500px",height:"300px",border:"1px solid darkgray"});o.appendChild(r),a.appendChild(o);var s=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px"}),l=null;r.appendChild(s);var d=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px"}),u=null;r.appendChild(d);var c=function(){apogeeapp.ui.closeDialog(t),l&&(l.destroy(),l=null),u&&(u.destroy(),u=null)};(o=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Save",onclick:function(){var t,p;if(l){var a=l.getSession().getValue().trim();t=apogeeapp.app.dialog.createLinkArray(a)}else t=[];if(u){var o=u.getSession().getValue().trim();p=apogeeapp.app.dialog.createLinkArray(o)}else p=[];e.setLinks(t,p),c()}})),o.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Cancel",onclick:function(){c()}})),a.appendChild(o),t.setContent(a),apogeeapp.ui.showDialog(t),t.fitToContent(),t.centerInParent();var g=function(){if(d.style.display="none",s.style.display="",!l){(l=ace.edit(s)).$blockScrolling=1/0,l.setTheme("ace/theme/eclipse"),l.getSession().setMode("ace/mode/text");var t=e.getJsLinks();if(t){var p=t.join("\n");l.getSession().setValue(p)}}},h=function(){if(d.style.display="",s.style.display="none",!u){(u=ace.edit(d)).$blockScrolling=1/0,u.setTheme("ace/theme/eclipse"),u.getSession().setMode("ace/mode/text");var t=e.getCssLinks();if(t){var p=t.join("\n");u.getSession().setValue(p)}}};n.checked=!0,g();var m=function(){i.checked?h():n.checked&&g()};i.onchange=m,n.onchange=m},apogeeapp.app.dialog.createLinkText=function(e){return e.join("\n")},apogeeapp.app.dialog.createLinkArray=function(e){return e&&0!==e.length?e.split(/\s/):[]},apogeeapp.app.dialog.showSelectComponentDialog=function(e,t){var p=apogeeapp.ui.createDialog({movable:!0}),a=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",height:"100%",overflow:"auto"});p.setContent(a);var o=apogeeapp.ui.createElement("div",null,{display:"table",overflow:"hidden"});a.appendChild(o);var n;(n=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:"Select Component Type"})),o.appendChild(n),(n=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(document.createTextNode("Component:"));var i=apogeeapp.ui.createElement("select");n.appendChild(i);for(var r=0;r<e.length;r++){var s=e[r];i.add(apogeeapp.ui.createElement("option",{text:s}))}o.appendChild(n);(n=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Create",onclick:function(){var e=i.value;t(e),apogeeapp.ui.closeDialog(p)}})),n.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Cancel",onclick:function(){apogeeapp.ui.closeDialog(p)}})),o.appendChild(n),p.setContent(o),apogeeapp.ui.showDialog(p),p.fitToContent(),p.centerInParent()},apogeeapp.app.propdialog={},apogeeapp.app.propdialog.getDialogLayout=function(e,t,p,a){var o=apogee.util.jsonCopy(t.propertyDialogLines),n={},i=[];n.lines=i;var r={};if(r.type="title",r.title=p?"New "+t.displayName:"Update "+t.displayName,i.push(r),e){var s={};s.type="dropdown",s.heading="Folder: ",s.entries=e,s.resultKey="parentName",i.push(s)}var l={};if(l.type="inputElement",l.heading="Name: ",l.resultKey="name",i.push(l),o)for(u=0;u<o.length;u++)i.push(o[u]);var d={};if(d.type="submit",d.submit=p?"Create":"Update",d.cancel="Cancel",i.push(d),a)for(var u=0;u<i.length;u++){var c=i[u];c.resultKey&&(c.initial=a[c.resultKey])}return n};