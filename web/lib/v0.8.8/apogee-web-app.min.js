/*! apogee 0.8.8 */

var apogeeapp={ui:{}};apogeeapp.ui.initResourcePath=function(e){apogeeapp.ui.RESOURCE_DIR=e},apogeeapp.ui.getResourcePath=function(e){return apogeeapp.ui.RESOURCE_DIR+e},apogeeapp.ui.MENU_ZINDEX=100,apogeeapp.ui.WINDOW_FRAME_ZINIDEX=10,apogeeapp.ui.DIALOG_ZINDEX=200,apogeeapp.ui.idIndex=0,apogeeapp.ui.idBase="_visiui_id_",apogeeapp.ui.createId=function(){return apogeeapp.ui.idBase+apogeeapp.ui.idIndex++},apogeeapp.ui.applyStyle=function(e,t){for(var a in t)e.style[a]=t[a]},apogeeapp.ui.MINIMIZE_CMD_IMAGE="/minimize.png",apogeeapp.ui.RESTORE_CMD_IMAGE="/restore.png",apogeeapp.ui.MAXIMIZE_CMD_IMAGE="/maximize.png",apogeeapp.ui.CLOSE_CMD_IMAGE="/close.png",apogeeapp.ui.MENU_IMAGE="/hamburger.png",apogeeapp.ui.removeAllChildren=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},apogeeapp.ui.createElement=function(e,t,a){var p=document.createElement(e);if(t)for(var o in t)p[o]=t[o];return a&&apogeeapp.ui.applyStyle(p,a),p},apogeeapp.ui.createElementWithClass=function(e,t,a){var p=document.createElement(e);return p.className=t,a&&a.appendChild(p),p},apogeeapp.ui.dialogLayer=null,apogeeapp.ui.BASE_ELEMENT_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",zIndex:1},apogeeapp.ui.DIALOG_LAYER_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",zIndex:2,pointerEvents:"none"},apogeeapp.ui.DIALOG_SHIELD_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",pointerEvents:"auto"},apogeeapp.ui.initWindows=function(e){var t=document.getElementById(e);if(!t)throw apogee.base.createError("Container ID not found: "+e);var a={};return a.baseElement=apogeeapp.ui.createElement("div",null,apogeeapp.ui.BASE_ELEMENT_STYLE),a.dialogLayer=apogeeapp.ui.createElement("div",null,apogeeapp.ui.DIALOG_LAYER_STYLE),t.appendChild(a.baseElement),t.appendChild(a.dialogLayer),apogeeapp.ui.dialogLayer=a.dialogLayer,a},apogeeapp.ui.createDialog=function(e){return new apogeeapp.ui.WindowFrame(e)},apogeeapp.ui.showDialog=function(e){var t=apogeeapp.ui.createElement("div",null,apogeeapp.ui.DIALOG_SHIELD_STYLE),a=new apogeeapp.ui.WindowParent(t);apogeeapp.ui.dialogLayer.appendChild(t),a.addWindow(e)},apogeeapp.ui.closeDialog=function(e){var t=e.getParent();e.close(),apogeeapp.ui.dialogLayer.removeChild(t.getOuterElement())},apogeeapp.ui.WINDOW_STATE_MINIMIZED=-1,apogeeapp.ui.WINDOW_STATE_NORMAL=0,apogeeapp.ui.WINDOW_STATE_MAXIMIZED=1,apogeeapp.ui.WINDOW_STATE_CHANGED="window state change",apogeeapp.ui.MINIMIZABLE=1,apogeeapp.ui.MAXIMIZABLE=2,apogeeapp.ui.CLOSEABLE=4,apogeeapp.ui.REQUEST_CLOSE="request_close",apogeeapp.ui.DENY_CLOSE=-1,apogeeapp.ui.CLOSE_EVENT="closed",apogeeapp.ui.RESIZED_EVENT="resized",apogeeapp.ui.SHOWN_EVENT="shown",apogeeapp.ui.HIDDEN_EVENT="hidden",apogeeapp.ui.setMemberCssData=function(e,t){var a="css_"+e,p=document.getElementById(a);""!=t?(p||((p=document.createElement("style")).id=a,document.head.appendChild(p)),p.innerHTML=t):p&&document.head.removeChild(p)},apogeeapp.ui.RESIZABLE=1,apogeeapp.ui.FIXED_SIZE=2,apogeeapp.ui.SIZE_WINDOW_TO_CONTENT=3,apogeeapp.ui.WindowParent=function(e){apogee.EventManager.init.call(this),this.containerElement=e,this.windowFrameStack=[],this.showing=!1,this.prevNewChildX=0,this.prevNewChildY=0,this.wrapCount=0},apogee.base.mixin(apogeeapp.ui.WindowParent,apogee.EventManager),apogeeapp.ui.WindowParent.BASE_ZINDEX=0,apogeeapp.ui.WindowParent.DELTA_CHILD_X=25,apogeeapp.ui.WindowParent.DELTA_CHILD_Y=25,apogeeapp.ui.WindowParent.MAX_WRAP_WIDTH=400,apogeeapp.ui.WindowParent.MAX_WRAP_HEIGHT=400,apogeeapp.ui.WindowParent.prototype.elementIsShown=function(){this.showing=!0,this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,this)},apogeeapp.ui.WindowParent.prototype.elementIsHidden=function(){this.showing=!1,this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,this)},apogeeapp.ui.WindowParent.prototype.getIsShowing=function(){return this.showing},apogeeapp.ui.WindowParent.prototype.getOuterElement=function(){return this.containerElement},apogeeapp.ui.WindowParent.prototype.addWindow=function(e){this.containerElement.appendChild(e.getElement()),this.windowFrameStack.push(e),this.updateOrder(),e.onAddedToParent(this)},apogeeapp.ui.WindowParent.prototype.removeWindow=function(e){this.containerElement.removeChild(e.getElement());var t=this.windowFrameStack.indexOf(e);this.windowFrameStack.splice(t,1),this.updateOrder()},apogeeapp.ui.WindowParent.prototype.bringToFront=function(e){var t=this.windowFrameStack.indexOf(e);this.windowFrameStack.splice(t,1),this.windowFrameStack.push(e),this.updateOrder()},apogeeapp.ui.WindowParent.prototype.getCenterOnPagePosition=function(e){var t=e.getElement();return[(this.containerElement.offsetWidth-t.clientWidth)/2,(this.containerElement.offsetHeight-t.clientHeight)/2]},apogeeapp.ui.WindowParent.prototype.getNextWindowPosition=function(){var e=this.prevNewChildX+apogeeapp.ui.WindowParent.DELTA_CHILD_X,t=this.prevNewChildY+apogeeapp.ui.WindowParent.DELTA_CHILD_Y;(e>apogeeapp.ui.WindowParent.MAX_WRAP_WIDTH||t>apogeeapp.ui.WindowParent.MAX_WRAP_HEIGHT)&&(this.wrapCount++,e=apogeeapp.ui.WindowParent.DELTA_CHILD_X*(this.wrapCount+1),t=apogeeapp.ui.WindowParent.DELTA_CHILD_Y),this.prevNewChildX=e,this.prevNewChildY=t;var a={};return a.x=e,a.y=t,a},apogeeapp.ui.WindowParent.prototype.updateOrder=function(){for(var e=apogeeapp.ui.WindowParent.BASE_ZINDEX,t=0;t<this.windowFrameStack.length;t++){this.windowFrameStack[t].setZIndex(e++)}},apogeeapp.ui.WindowFrame=function(e){e||(e={}),apogee.EventManager.init.call(this),this.windowParent=null,this.parentElement=null,this.options=e,this.windowState=void 0!==e.initialState?e.initialState:apogeeapp.ui.WINDOW_STATE_NORMAL,this.posInfo={},this.posInfo.x=0,this.posInfo.y=0,this.sizeInfo={},this.sizeInfo.width=apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_WIDTH,this.sizeInfo.height=apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_HEIGHT,this.frame=null,this.titleCell=null,this.headerCell=null,this.bodyCell=null,this.headerContent=null,this.content=null,this.windowDragActive=!1,this.moveOffsetX=null,this.moveOffsetX=null,this.moveOnMouseMove=null,this.moveOnMouseLeave=null,this.moveOnMouseUp=null,this.resizeEastActive=!1,this.resizeWestActive=!1,this.resizeNorthActive=!1,this.resizeSouthActive=!1,this.resizeOffsetWidth=null,this.resizeOffsetHeight=null,this.resizeOnMouseUp=null,this.resizeOnMouseMove=null,this.resizeOnMouseLeave=null,this.minWidth=0,this.minHeight=0,this.initUI();var t=this;this.getElement().addEventListener("mousedown",function(e){t.windowParent.bringToFront(t)})},apogee.base.mixin(apogeeapp.ui.WindowFrame,apogee.EventManager),apogeeapp.ui.WindowFrame.RESIZE_LOCATION_SIZE=10,apogeeapp.ui.WindowFrame.RESIZE_TOLERANCE=5,apogeeapp.ui.WindowFrame.RESIZE_EAST=1,apogeeapp.ui.WindowFrame.RESIZE_WEST=2,apogeeapp.ui.WindowFrame.RESIZE_SOUTH=4,apogeeapp.ui.WindowFrame.RESIZE_NORTH=8,apogeeapp.ui.WindowFrame.RESIZE_NE=apogeeapp.ui.WindowFrame.RESIZE_NORTH+apogeeapp.ui.WindowFrame.RESIZE_EAST,apogeeapp.ui.WindowFrame.RESIZE_NW=apogeeapp.ui.WindowFrame.RESIZE_NORTH+apogeeapp.ui.WindowFrame.RESIZE_WEST,apogeeapp.ui.WindowFrame.RESIZE_SE=apogeeapp.ui.WindowFrame.RESIZE_SOUTH+apogeeapp.ui.WindowFrame.RESIZE_EAST,apogeeapp.ui.WindowFrame.RESIZE_SW=apogeeapp.ui.WindowFrame.RESIZE_SOUTH+apogeeapp.ui.WindowFrame.RESIZE_WEST,apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_HEIGHT=300,apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_WIDTH=300,apogeeapp.ui.WindowFrame.prototype.getTitle=function(){return this.title},apogeeapp.ui.WindowFrame.prototype.setTitle=function(e){this.title=e,this.titleBarTitleElement.innerHTML=e},apogeeapp.ui.WindowFrame.prototype.createMenu=function(e){return e||(e=apogeeapp.ui.getResourcePath(apogeeapp.ui.MENU_IMAGE)),this.menu=apogeeapp.ui.Menu.createMenuFromImage(e),this.titleBarMenuElement.appendChild(this.menu.getElement()),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_win_icon_overlay_style",this.titleBarMenuElement),this.menu},apogeeapp.ui.WindowFrame.prototype.getMenu=function(){return this.menu},apogeeapp.ui.WindowFrame.prototype.setIconOverlay=function(e){this.iconOverlayElement&&(this.clearIconOverlay(),e&&this.iconOverlayElement.appendChild(e))},apogeeapp.ui.WindowFrame.prototype.clearIconOverlay=function(){this.iconOverlayElement&&apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.WindowFrame.prototype.setHeaderContent=function(e){apogeeapp.ui.removeAllChildren(this.headerCell),this.headerCell.appendChild(e),this.headerContent=e},apogeeapp.ui.WindowFrame.prototype.setContent=function(e,t){if(this.contentContainer||(this.contentContainer=apogeeapp.ui.createElement("div"),apogeeapp.ui.removeAllChildren(this.bodyCell),this.bodyCell.appendChild(this.contentContainer)),t==apogeeapp.ui.RESIZABLE)this.contentContainer.className="visiui_win_container_fixed";else if(t==apogeeapp.ui.FIXED_SIZE)this.contentContainer.className="visiui_win_container_scrolling";else{if(t!=apogeeapp.ui.SIZE_WINDOW_TO_CONTENT)throw new Error("Unknown content type: "+t);this.contentContainer.className="visiui_win_container_fit_content"}apogeeapp.ui.removeAllChildren(this.contentContainer),this.contentContainer.appendChild(e),this.content=e},apogeeapp.ui.WindowFrame.prototype.safeRemoveContent=function(e){for(var t=0;t<this.bodyCell.childNodes.length;t++){this.bodyCell.childNodes[t]===e&&(this.bodyCell.removeChild(e),this.content=null)}},apogeeapp.ui.WindowFrame.prototype.addTitleToolElement=function(e){this.titleBarToolElement.appendChild(e)},apogeeapp.ui.WindowFrame.prototype.removeTitleToolElement=function(e){this.titleBarToolElement.removeChild(e)},apogeeapp.ui.WindowFrame.prototype.getParent=function(){return this.windowParent},apogeeapp.ui.WindowFrame.prototype.getIsShowing=function(){return!!this.windowParent&&this.windowParent.getIsShowing()},apogeeapp.ui.WindowFrame.prototype.close=function(e){if(this.windowParent){if(!e)if(this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this)==apogeeapp.ui.DENY_CLOSE)return;this.windowParent.removeListener(apogeeapp.ui.SHOWN_EVENT,this.windowShownListener),this.windowParent.removeListener(apogeeapp.ui.HIDDEN_EVENT,this.windowHiddenListener),this.windowParent.removeWindow(this),this.windowParent=null,this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this)}},apogeeapp.ui.WindowFrame.prototype.setPosition=function(e,t){e<0&&(e=0),t<0&&(t=0),this.posInfo.x=e,this.posInfo.y=t,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setSize=function(e,t){this.sizeInfo.width=e,this.sizeInfo.height=t,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.getPosInfo=function(){return this.posInfo},apogeeapp.ui.WindowFrame.prototype.setPosInfo=function(e){this.posInfo=e,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.getSizeInfo=function(){return this.sizeInfo},apogeeapp.ui.WindowFrame.prototype.setSizeInfo=function(e){this.sizeInfo=e,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setCoordinateInfo=function(e,t){this.posInfo=e,this.sizeInfo=t,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setZIndex=function(e){this.frame.style.zIndex=String(e)},apogeeapp.ui.WindowFrame.prototype.getElement=function(){return this.frame},apogeeapp.ui.WindowFrame.prototype.fitToContent=function(){this.sizeInfo.width=void 0,this.sizeInfo.height=void 0},apogeeapp.ui.WindowFrame.prototype.centerInParent=function(){var e=this.windowParent.getCenterOnPagePosition(this);this.setPosition(e[0],e[1])},apogeeapp.ui.WindowFrame.prototype.getWindowState=function(){return this.windowState},apogeeapp.ui.WindowFrame.prototype.setWindowState=function(e){switch(e){case apogeeapp.ui.WINDOW_STATE_NORMAL:this.restoreContent();break;case apogeeapp.ui.WINDOW_STATE_MINIMIZED:this.minimizeContent();break;case apogeeapp.ui.WINDOW_STATE_MAXIMIZED:this.maximizeContent();break;default:alert("Unknown window state: "+e)}},apogeeapp.ui.WindowFrame.prototype.onAddedToParent=function(e){this.windowParent=e,this.parentElement=e.getOuterElement();var t=this;this.windowShownListener=function(e){t.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,t)},this.windowParent.addListener(apogeeapp.ui.SHOWN_EVENT,this.windowShownListener),this.windowHiddenListener=function(e){t.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t)},this.windowParent.addListener(apogeeapp.ui.HIDDEN_EVENT,this.windowHiddenListener),this.windowParent.getIsShowing()&&this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,this),void 0!==this.sizeInfo.height&&this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.moveMouseDown=function(e){this.windowState!==apogeeapp.ui.WINDOW_STATE_MAXIMIZED&&this.parentElement&&(this.windowDragActive=!0,this.moveOffsetX=e.clientX-this.frame.offsetLeft,this.moveOffsetY=e.clientY-this.frame.offsetTop,this.parentElement.addEventListener("mousemove",this.moveOnMouseMove),this.parentElement.addEventListener("mouseleave",this.moveOnMouseLeave),this.parentElement.addEventListener("mouseup",this.moveOnMouseUp))},apogeeapp.ui.WindowFrame.prototype.moveMouseMoveImpl=function(e){if(this.windowDragActive){var t=e.clientX-this.moveOffsetX;t<0&&(t=0);var a=e.clientY-this.moveOffsetY;a<0&&(a=0),this.posInfo.x=t,this.posInfo.y=a,this.updateCoordinates()}},apogeeapp.ui.WindowFrame.prototype.moveMouseUpImpl=function(e){this.endMove()},apogeeapp.ui.WindowFrame.prototype.moveMouseLeaveImpl=function(e){this.endMove()},apogeeapp.ui.WindowFrame.prototype.resizeMouseDownImpl=function(e,t){this.windowState!==apogeeapp.ui.WINDOW_STATE_MAXIMIZED&&t&&(t&apogeeapp.ui.WindowFrame.RESIZE_EAST?(this.resizeEastActive=!0,this.resizeOffsetWidth=e.clientX-this.bodyCell.clientWidth):t&apogeeapp.ui.WindowFrame.RESIZE_WEST&&(this.resizeWestActive=!0,this.resizeOffsetWidth=e.clientX+this.bodyCell.clientWidth,this.moveOffsetX=e.clientX-this.frame.offsetLeft),t&apogeeapp.ui.WindowFrame.RESIZE_SOUTH?(this.resizeSouthActive=!0,this.resizeOffsetHeight=e.clientY-this.bodyCell.clientHeight):t&apogeeapp.ui.WindowFrame.RESIZE_NORTH&&(this.resizeNorthActive=!0,this.resizeOffsetHeight=e.clientY+this.bodyCell.clientHeight,this.moveOffsetY=e.clientY-this.frame.offsetTop),this.parentElement.addEventListener("mouseup",this.resizeOnMouseUp),this.parentElement.addEventListener("mousemove",this.resizeOnMouseMove),this.parentElement.addEventListener("mouseleave",this.resizeOnMouseLeave))},apogeeapp.ui.WindowFrame.prototype.resizeMouseMoveImpl=function(e){var t,a,p,o,n=!1;this.resizeEastActive?(a=e.clientX-this.resizeOffsetWidth,this.sizeInfo.width=a,n=!0):this.resizeWestActive&&(a=this.resizeOffsetWidth-e.clientX,(p=e.clientX-this.moveOffsetX)<0&&(p=0),this.sizeInfo.width=a,this.posInfo.x=p,n=!0),this.resizeSouthActive?(t=e.clientY-this.resizeOffsetHeight,this.sizeInfo.height=t,n=!0):this.resizeNorthActive&&(t=this.resizeOffsetHeight-e.clientY,(o=e.clientY-this.moveOffsetY)<0&&(o=0),this.sizeInfo.height=t,this.posInfo.y=o,n=!0),n&&this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.resizeMouseUpImpl=function(e){this.endResize()},apogeeapp.ui.WindowFrame.prototype.resizeMouseLeaveImpl=function(e){this.endResize()},apogeeapp.ui.WindowFrame.prototype.endMove=function(e){this.windowDragActive=!1,this.parentElement.removeEventListener("mousemove",this.moveOnMouseMove),this.parentElement.removeEventListener("mouseup",this.moveOnMouseUp),this.parentElement.removeEventListener("mouseleave",this.moveOnMouseLeave)},apogeeapp.ui.WindowFrame.prototype.endResize=function(){this.resizeEastActive=!1,this.resizeWestActive=!1,this.resizeSouthActive=!1,this.resizeNorthActive=!1,this.parentElement.removeEventListener("mouseup",this.resizeOnMouseUp),this.parentElement.removeEventListener("mousemove",this.resizeOnMouseMove),this.parentElement.removeEventListener("mouseleave",this.resizeOnMouseLeave)},apogeeapp.ui.WindowFrame.prototype.minimizeContent=function(){this.headerCell.style.display="none",this.bodyCell.style.display="none";var e=this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_MINIMIZED,this.updateCoordinates(),this.setMinMaxButtons(),e||this.dispatchEvent(apogeeapp.ui.WINDOW_STATE_CHANGED,this)},apogeeapp.ui.WindowFrame.prototype.restoreContent=function(){this.headerCell.style.display="",this.bodyCell.style.display="";var e=this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED,t=this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_NORMAL,this.updateCoordinates(),this.setMinMaxButtons(),(e||t)&&this.dispatchEvent(apogeeapp.ui.WINDOW_STATE_CHANGED,this)},apogeeapp.ui.WindowFrame.prototype.maximizeContent=function(){this.headerCell.style.display="",this.bodyCell.style.display="";var e=this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_MAXIMIZED,this.updateCoordinates(),this.setMinMaxButtons(),e||this.dispatchEvent(apogeeapp.ui.WINDOW_STATE_CHANGED,this)},apogeeapp.ui.WindowFrame.prototype.updateCoordinates=function(){var e=this.bodyCell.style.height,t=this.bodyCell.style.width;this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED?(this.frame.style.left="0px",this.frame.style.top="0px",this.frame.style.height="100%",this.frame.style.width="100%",this.bodyCell.style.height="100%",this.bodyCell.style.width="100%"):this.windowState===apogeeapp.ui.WINDOW_STATE_NORMAL?(this.frame.style.left=this.posInfo.x+"px",this.frame.style.top=this.posInfo.y+"px",this.frame.style.height="",this.frame.style.width="",void 0!==this.sizeInfo.height?this.bodyCell.style.height=this.sizeInfo.height+"px":this.bodyCell.style.height="",void 0!==this.sizeInfo.width?this.bodyCell.style.width=this.sizeInfo.width+"px":this.bodyCell.style.width=""):this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED&&(this.frame.style.left=this.posInfo.x+"px",this.frame.style.top=this.posInfo.y+"px",this.frame.style.height="",this.frame.style.width="",this.bodyCell.style.height="0px",this.bodyCell.style.width="0px"),e==this.bodyCell.style.height&&t==this.bodyCell.style.width||this.dispatchEvent(apogeeapp.ui.RESIZED_EVENT,this)},apogeeapp.ui.WindowFrame.prototype.initUI=function(){var e,t,a;(e=document.createElement("table")).className="visiui_win_main",this.frame=e,t=document.createElement("tr"),e.appendChild(t),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_topLeft",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_WEST|apogeeapp.ui.WindowFrame.RESIZE_NORTH),t.appendChild(a),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_top",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_NORTH),t.appendChild(a),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_topRight",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_EAST|apogeeapp.ui.WindowFrame.RESIZE_NORTH),t.appendChild(a),t=document.createElement("tr"),e.appendChild(t),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_left",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_WEST),a.rowSpan=3,t.appendChild(a),(a=document.createElement("td")).className="visiui_win_windowColorClass",this.titleBarCell=a,t.appendChild(a),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_right",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_EAST),a.rowSpan=3,t.appendChild(a),(t=document.createElement("tr")).className="visiui_win_headerRow",e.appendChild(t),(a=document.createElement("td")).className="visiui_win_headerCell",this.headerCell=a,t.appendChild(a),(t=document.createElement("tr")).className="visiui_win_bodyRow",e.appendChild(t),(a=document.createElement("td")).className="visiui_win_bodyCell",this.bodyCell=a,t.appendChild(a),t=document.createElement("tr"),e.appendChild(t),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_bottomLeft",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_WEST|apogeeapp.ui.WindowFrame.RESIZE_SOUTH),t.appendChild(a),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_bottom",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_SOUTH),t.appendChild(a),(a=document.createElement("td")).className="visiui_win_windowColorClass visiui_win_bottomRight",this.addResizeHandlers(a,apogeeapp.ui.WindowFrame.RESIZE_EAST|apogeeapp.ui.WindowFrame.RESIZE_SOUTH),t.appendChild(a),this.createTitleBar()},apogeeapp.ui.WindowFrame.prototype.addResizeHandlers=function(e,t){if(this.options.resizable){var a=this;e.onmousedown=function(e){a.resizeMouseDownImpl(e,t)},this.resizeOnMouseMove||(this.resizeOnMouseMove=function(e){a.resizeMouseMoveImpl(e)},this.resizeOnMouseUp=function(e){a.resizeMouseUpImpl(e)},this.resizeOnMouseLeave=function(e){a.resizeMouseLeaveImpl(e)})}},apogeeapp.ui.WindowFrame.prototype.createTitleBar=function(){this.titleBarElement=apogeeapp.ui.createElementWithClass("div","visiui_win_titleBarClass",this.titleBarCell),this.titleBarLeftElements=apogeeapp.ui.createElementWithClass("div","visiui_win_left_style",this.titleBarElement),this.titleBarMenuElement=apogeeapp.ui.createElementWithClass("div","visiui_win_menu_style",this.titleBarLeftElements),this.titleBarTitleElement=apogeeapp.ui.createElementWithClass("div","visiui_win_title",this.titleBarLeftElements),this.titleBarRightElements=apogeeapp.ui.createElementWithClass("div","visiui_win_right_style",this.titleBarElement),this.titleBarToolElement=apogeeapp.ui.createElementWithClass("div","visiui_win_tool_style",this.titleBarRightElements);var e=this;this.options.minimizable&&(this.minimizeButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.minimizeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.MINIMIZE_CMD_IMAGE),this.minimizeButton.onclick=function(){e.minimizeContent()}),(this.options.minimizable||this.options.maximizable)&&(this.restoreButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.restoreButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.RESTORE_CMD_IMAGE),this.restoreButton.onclick=function(){e.restoreContent()}),this.windowState=apogeeapp.ui.WINDOW_STATE_NORMAL,this.setMinMaxButtons(),this.options.closable&&(this.closeButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.closeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.CLOSE_CMD_IMAGE),this.closeButton.onclick=function(){e.close()}),this.setTitle(""),this.options.movable&&(this.titleBarElement.onmousedown=function(t){e.moveMouseDown(t)},this.moveOnMouseMove=function(t){e.moveMouseMoveImpl(t)},this.moveOnMouseUp=function(t){e.moveMouseUpImpl(t)},this.moveOnMouseLeave=function(t){e.moveMouseLeaveImpl(t)})},apogeeapp.ui.WindowFrame.prototype.setMinMaxButtons=function(){this.minimizeButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_MINIMIZED?this.minimizeButton.style.display="none":this.minimizeButton.style.display=""),this.restoreButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_NORMAL?this.restoreButton.style.display="none":this.restoreButton.style.display=""),this.maximizeButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_MAXIMIZED?this.maximizeButton.style.display="none":this.maximizeButton.style.display="")},apogeeapp.ui.PlainFrame=function(e){e||(e={}),apogee.EventManager.init.call(this),this.options=e,this.displayAndHeader=null,this.headerCell=null,this.bodyCell=null,this.isShowing=!1,this.headerContent=null,this.content=null,this.initUI()},apogee.base.mixin(apogeeapp.ui.PlainFrame,apogee.EventManager),apogeeapp.ui.PlainFrame.prototype.setHeaderContent=function(e){apogeeapp.ui.removeAllChildren(this.headerCell),this.headerCell.appendChild(e),this.headerContent=e},apogeeapp.ui.PlainFrame.prototype.setContent=function(e,t){var a;if(apogeeapp.ui.removeAllChildren(this.bodyCell),t==apogeeapp.ui.RESIZABLE)a="visiui-dnh-fixed";else{if(t!=apogeeapp.ui.FIXED_SIZE)throw new Error("Unknown content type: "+t);a="visiui-dnh-shrink-to-fit"}this.displayAndHeader.setBodyType(a),this.bodyCell.appendChild(e),this.content=e},apogeeapp.ui.PlainFrame.prototype.safeRemoveContent=function(e){for(var t=0;t<this.bodyCell.childNodes.length;t++){this.bodyCell.childNodes[t]===e&&(this.bodyCell.removeChild(e),this.content=null)}},apogeeapp.ui.PlainFrame.prototype.setIsShowing=function(e){e?this.isShowing||(this.isShowing=!0,this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,this)):this.isShowing&&(this.isShowing=!1,this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,this))},apogeeapp.ui.PlainFrame.prototype.getIsShowing=function(){return this.isShowing},apogeeapp.ui.PlainFrame.prototype.close=function(e){if(!e&&this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this)==apogeeapp.ui.DENY_CLOSE)return;this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this)},apogeeapp.ui.PlainFrame.prototype.getElement=function(){return this.displayAndHeader.getOuterElement()},apogeeapp.ui.PlainFrame.prototype.getWindowState=function(){return apogeeapp.ui.WINDOW_STATE_NORMAL},apogeeapp.ui.PlainFrame.prototype.initUI=function(){this.displayAndHeader=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.SCROLLING_PANE,null),this.headerCell=this.displayAndHeader.getHeaderContainer(),this.bodyCell=this.displayAndHeader.getBody(),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.headerCell.appendChild(this.windowHeaderManager.getHeaderElement())},apogeeapp.ui.TabFrame=function(){apogee.EventManager.init.call(this),this.tabTable={},this.activeTab=null,this.tabFrameControl=apogeeapp.ui.createElementWithClass("div","visiui-tf-frame"),this.tabBar=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-bar",this.tabFrameControl),this.tabFrame=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-container",this.tabFrameControl)},apogee.base.mixin(apogeeapp.ui.TabFrame,apogee.EventManager),apogeeapp.ui.TabFrame.CONTAINER_FRAME_MARGIN_PX=5,apogeeapp.ui.TabFrame.prototype.getElement=function(){return this.tabFrameControl},apogeeapp.ui.TabFrame.prototype.getTab=function(e){return this.tabTable[e]},apogeeapp.ui.TabFrame.prototype.addTab=function(e,t){var a=e.getId();if(this.tabTable[a])return alert("There is already a tab with this id!"),null;e.setTabFrame(this),this.tabFrame.appendChild(e.getMainElement());var p=e.getLabelElement();this.tabBar.appendChild(p);var o=this;p.onclick=function(){o.setActiveTab(a)},p.onmousedown=function(e){e.preventDefault()},this.tabTable[a]=e,t||null==this.activeTab?this.setActiveTab(a):this.updateTabDisplay()},apogeeapp.ui.TabFrame.prototype.closeTab=function(e){var t=this.tabTable[e];if(t){this.tabFrame.removeChild(t.getMainElement());var a=t.getLabelElement();if(this.tabBar.removeChild(a),delete a.onclick,delete a.onmousedown,delete this.tabTable[e],this.activeTab==e)for(var p in this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t),this.activeTab=null,this.tabTable){this.setActiveTab(p);break}this.updateTabDisplay()}},apogeeapp.ui.TabFrame.prototype.getActiveTab=function(){return this.activeTab},apogeeapp.ui.TabFrame.prototype.setActiveTab=function(e){var t,a=this.tabTable[e];a&&(this.activeTab&&(t=this.tabTable[this.activeTab]),this.activeTab=e,this.tabFrame.appendChild(a.getMainElement()),this.updateTabDisplay(),t&&this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t),this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,a))},apogeeapp.ui.TabFrame.prototype.updateTabDisplay=function(){var e;for(e in this.tabTable){var t=this.tabTable[e];e==this.activeTab?(t.getMainElement().style.display="",t.getLabelElement().className="visiui-tf-tab-base visiui-tf-tab-active"):(t.getMainElement().style.display="none",t.getLabelElement().className="visiui-tf-tab-base visiui-tf-tab-inactive")}},apogeeapp.ui.Tab=function(e){apogee.EventManager.init.call(this),this.tabFrame=null,this.id=e,this.tabLabelElement=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-base visiui-tf-tab-inactive"),this.menuContainer=apogeeapp.ui.createElementWithClass("div","visiui-tf_tab-menuDiv",this.tabLabelElement),this.titleElement=apogeeapp.ui.createElementWithClass("div","visiui_tf_tab_title",this.tabLabelElement),this.closeButton=apogeeapp.ui.createElementWithClass("img","visiui_tf_tab_cmd_button",this.tabLabelElement),this.closeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.CLOSE_CMD_IMAGE);var t=this;this.closeButton.onclick=function(){t.close()},this.displayFrame=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-window"),this.tabInsideContainer=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null),this.displayFrame.appendChild(this.tabInsideContainer.getOuterElement()),this.headerContainer=this.tabInsideContainer.getHeaderContainer(),this.bodyContainer=this.tabInsideContainer.getBodyContainer(),this.isShowing=!1},apogee.base.mixin(apogeeapp.ui.Tab,apogee.EventManager),apogeeapp.ui.Tab.prototype.setTabFrame=function(e){this.tabFrame=e;var t=this;this.tabShownListener=function(e){e==t&&t.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,t)},this.tabFrame.addListener(apogeeapp.ui.SHOWN_EVENT,this.tabShownListener),this.tabHiddenListener=function(e){e==t&&t.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,t)},this.tabFrame.addListener(apogeeapp.ui.HIDDEN_EVENT,this.tabHiddenListener)},apogeeapp.ui.Tab.prototype.makeActive=function(){return!!this.tabFrame&&(this.tabFrame.setActiveTab(this.id),!0)},apogeeapp.ui.Tab.prototype.getId=function(){return this.id},apogeeapp.ui.Tab.prototype.setTitle=function(e){this.titleElement.innerHTML=e,this.title=e},apogeeapp.ui.Tab.prototype.setHeaderContent=function(e){apogeeapp.ui.removeAllChildren(this.headerContainer),this.headerContainer.appendChild(e),this.headerContent=e},apogeeapp.ui.Tab.prototype.setContent=function(e,t){if(this.contentContainer||(this.contentContainer=apogeeapp.ui.createElement("div"),apogeeapp.ui.removeAllChildren(this.bodyContainer),this.bodyContainer.appendChild(this.contentContainer)),t==apogeeapp.ui.RESIZABLE)this.contentContainer.className="visiui_tf_tab_contents_fixed";else{if(t!=apogeeapp.ui.FIXED_SIZE)throw new Error("Unknown content type: "+t);this.contentContainer.className="visiui_tf_tab_contents_scrolling"}apogeeapp.ui.removeAllChildren(this.contentContainer),this.contentContainer.appendChild(e),this.content=e},apogeeapp.ui.Tab.prototype.getTitle=function(){return this.title},apogeeapp.ui.Tab.prototype.createMenu=function(e){return e||(e=apogeeapp.ui.getResourcePath(apogeeapp.ui.MENU_IMAGE)),this.menu=apogeeapp.ui.Menu.createMenuFromImage(e),this.menuContainer.appendChild(this.menu.domElement),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_tf_icon_overlay",this.menuContainer),this.menu},apogeeapp.ui.Tab.prototype.getMenu=function(){return this.menu},apogeeapp.ui.Tab.prototype.setIconOverlay=function(e){this.iconOverlayElement&&(this.clearIconOverlay(),e&&this.iconOverlayElement.appendChild(e))},apogeeapp.ui.Tab.prototype.clearIconOverlay=function(){this.iconOverlayElement&&apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.Tab.prototype.close=function(e){if(this.tabFrame){if(!e)if(this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this)==apogeeapp.ui.DENY_CLOSE)return;this.tabFrame.closeTab(this.id),this.tabFrame.removeListener(apogeeapp.ui.SHOWN_EVENT,this.tabShownListener),this.tabFrame.removeListener(apogeeapp.ui.HIDDEN_EVENT,this.tabHiddenListener),this.tabFrame=null,this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this)}},apogeeapp.ui.Tab.prototype.getMainElement=function(){return this.displayFrame},apogeeapp.ui.Tab.prototype.getLabelElement=function(){return this.tabLabelElement},apogeeapp.ui.Menu={},apogeeapp.ui.Menu.initialized=!1,apogeeapp.ui.Menu.activeMenu=null,apogeeapp.ui.Menu.createMenu=function(e){var t=apogeeapp.ui.createElementWithClass("div","visiui-menu-heading visiui-menu-text");return t.innerHTML=e,new apogeeapp.ui.MenuHeader(t)},apogeeapp.ui.Menu.createMenuFromImage=function(e){var t=document.createElement("img");t.src=e;var a=apogeeapp.ui.createElementWithClass("div","visiui-menu-heading visiui-menu-image");return a.appendChild(t),new apogeeapp.ui.MenuHeader(a)},apogeeapp.ui.Menu.showContextMenu=function(e,t){e.setPosition(t.clientX,t.clientY,document.body),t.preventDefault(),apogeeapp.ui.Menu.show(e)},apogeeapp.ui.Menu.menuHeaderPressed=function(e){apogeeapp.ui.Menu.activeMenu===e?apogeeapp.ui.Menu.hideActiveMenu():apogeeapp.ui.Menu.show(e.getMenuBody())},apogeeapp.ui.Menu.nonMenuPressed=function(){apogeeapp.ui.Menu.activeMenu&&apogeeapp.ui.Menu.hideActiveMenu()},apogeeapp.ui.Menu.show=function(e){apogeeapp.ui.Menu.activeMenu&&apogeeapp.ui.Menu.hideActiveMenu();var t=e.getParentElement();e.prepareShow();var a=e.getMenuElement();if(t&&a){t.appendChild(a),apogeeapp.ui.Menu.activeMenu=e;var p=e.getMenuHeader();p&&(p.className="visiui-menu-heading visiui-menu-heading-active")}},apogeeapp.ui.Menu.hideActiveMenu=function(){if(apogeeapp.ui.Menu.activeMenu){var e=apogeeapp.ui.Menu.activeMenu,t=e.getMenuHeader();t&&(t.className="visiui-menu-heading");var a=e.getParentElement(),p=e.getMenuElement();a&&p&&(a.removeChild(p),apogeeapp.ui.Menu.activeMenu=null),e.menuHidden()}},apogeeapp.ui.Menu.nonMenuMouseHandler=null,apogeeapp.ui.Menu.initialize=function(){window.addEventListener("mousedown",apogeeapp.ui.Menu.nonMenuPressed),apogeeapp.ui.Menu.initialized=!0},apogeeapp.ui.Menu.deinitialize=function(){window.removeEventListener("mousedown",apogeeapp.ui.Menu.nonMenuPressed),apogeeapp.ui.Menu.initialized=!1},apogeeapp.ui.MenuHeader=function(e){apogeeapp.ui.Menu.initialized||apogeeapp.ui.Menu.initialize(),this.domElement=e,this.menuBody=new apogeeapp.ui.MenuBody,this.initHeadingElement(),this.menuBody.attachToMenuHeader(this)},apogeeapp.ui.MenuHeader.prototype.getElement=function(){return this.domElement},apogeeapp.ui.MenuHeader.prototype.setChildLocation=function(e){this.childLocation=e},apogeeapp.ui.MenuHeader.prototype.getChildLocation=function(){return this.childLocation},apogeeapp.ui.MenuHeader.prototype.getMenuBody=function(){return this.menuBody},apogeeapp.ui.MenuHeader.prototype.addEventMenuItem=function(e,t,a,p){this.menuBody.addEventMenuItem(e,t,a,p)},apogeeapp.ui.MenuHeader.prototype.addCallbackMenuItem=function(e,t){this.menuBody.addCallbackMenuItem(e,t)},apogeeapp.ui.MenuHeader.prototype.addMenuItem=function(e){this.menuBody.addMenuItem(e)},apogeeapp.ui.MenuHeader.prototype.setMenuItems=function(e){this.menuBody.setMenuItems(e)},apogeeapp.ui.MenuHeader.prototype.removeMenuItem=function(e){this.menuBody.removeMenuItem(e)},apogeeapp.ui.MenuHeader.prototype.setAsOnTheFlyMenu=function(e){this.menuBody.setAsOnTheFlyMenu(e)},apogeeapp.ui.MenuHeader.prototype.initHeadingElement=function(){var e=this;this.domElement.onmousedown=function(t){apogeeapp.ui.Menu.menuHeaderPressed(e),t.stopPropagation()}},apogeeapp.ui.MenuBody=function(){apogeeapp.ui.Menu.initialized||apogeeapp.ui.Menu.initialize(),this.menuDiv=null,this.parentElement=null,this.menuItems={},this.createMenuElement(),this.menuHeader=null},apogeeapp.ui.MenuBody.prototype.getMenuElement=function(){return this.menuDiv},apogeeapp.ui.MenuBody.prototype.getParentElement=function(){return this.parentElement},apogeeapp.ui.MenuBody.prototype.getMenuHeader=function(){return this.menuHeader},apogeeapp.ui.MenuBody.prototype.getIsContext=function(){return null==this.menuHeader},apogeeapp.ui.MenuBody.prototype.prepareShow=function(){this.isOnTheFlyMenu&&this.constructItemsForShow()},apogeeapp.ui.MenuBody.prototype.menuHidden=function(){this.isOnTheFlyMenu&&this.destroyItemsForHides()},apogeeapp.ui.MenuBody.prototype.attachToMenuHeader=function(e){this.parentElement=e.getElement(),this.menuDiv.style.left="0%",this.menuDiv.style.top="100%",this.menuHeader=e},apogeeapp.ui.MenuBody.prototype.setPosition=function(e,t,a){this.parentElement=a,a.appendChild(this.menuDiv);var p=a.offsetWidth,o=a.offsetHeight,n=this.menuDiv.clientWidth,i=this.menuDiv.clientHeight;a.appendChild(this.menuDiv),this.menuDiv.style.left=e+n>p&&e>p/2?e-n+"px":e+"px",this.menuDiv.style.top=t+i>o&&t>o/2?t-i+"px":t+"px"},apogeeapp.ui.MenuBody.prototype.setAsOnTheFlyMenu=function(e){this.isOnTheFlyMenu=!0,this.menuItemsCallback=e},apogeeapp.ui.MenuBody.prototype.addEventMenuItem=function(e,t,a,p){var o={};o.title=e,o.eventName=t,o.eventData=a,o.eventManager=p,this.addMenuItem(o)},apogeeapp.ui.MenuBody.prototype.addCallbackMenuItem=function(e,t){var a={};a.title=e,a.callback=t,this.addMenuItem(a)},apogeeapp.ui.MenuBody.prototype.addMenuItem=function(e){if(e.element=apogeeapp.ui.createElementWithClass("div","visiui-menu-item"),e.element.innerHTML=e.title,e.childMenuItems){var t=this.createChildMenuBody(e.childMenuItems).getMenuElement();t.style.left="100%",t.style.top="0%",e.element.appendChild(t),e.element.onmousedown=function(e){e.stopPropagation()},e.element.onclick=function(e){e.stopPropagation()}}else e.element.onmousedown=function(e){e.stopPropagation()},e.element.onclick=function(t){apogeeapp.ui.Menu.hideActiveMenu(),e.eventName?e.eventManager.dispatchEvent(e.eventName,e.eventData):e.callback&&e.callback(),t.stopPropagation()};this.menuDiv.appendChild(e.element),this.menuItems[e.title]=e},apogeeapp.ui.MenuBody.prototype.setMenuItems=function(e){for(var t=0;t<e.length;t++)this.addMenuItem(e[t])},apogeeapp.ui.MenuBody.prototype.removeMenuItem=function(e){var t=this.menuItems[e];t&&(this.menuDiv.removeChild(t.element),delete this.menuItems[e])},apogeeapp.ui.MenuBody.prototype.createMenuElement=function(){this.menuDiv=apogeeapp.ui.createElementWithClass("div","visiui-menu-body")},apogeeapp.ui.MenuBody.prototype.constructItemsForShow=function(){if(this.menuItemsCallback){var e=this.menuItemsCallback();this.setMenuItems(e)}},apogeeapp.ui.MenuBody.prototype.destroyItemsForHides=function(){this.menuDiv&&apogeeapp.ui.removeAllChildren(this.menuDiv),this.menuItems={}},apogeeapp.ui.MenuBody.prototype.createChildMenuBody=function(e){var t=new apogeeapp.ui.MenuBody;return t.setMenuItems(e),t},apogeeapp.jsonedit={};var OBJECT_CONSTRUCTOR={}.constructor,ARRAY_CONSTRUCTOR=[].constructor,STRING_CONSTRUCTOR="".constructor,NUMBER_CONSTRUCTOR=(0).constructor,BOOLEAN_CONSTRUCTOR=(!0).constructor;apogeeapp.jsonedit.getObjectType=function(e){return null==e?"value":e.constructor==OBJECT_CONSTRUCTOR?"object":e.constructor==ARRAY_CONSTRUCTOR?"array":"value"},apogeeapp.jsonedit.getValueType=function(e){return null==e?"null":e.constructor==STRING_CONSTRUCTOR?"string":e.constructor==NUMBER_CONSTRUCTOR?"number":e.constructor==BOOLEAN_CONSTRUCTOR?"boolean":"other"},apogeeapp.jsonedit.isBoolString=function(e){return"false"===e||"true"===e},apogeeapp.jsonedit.isNullString=function(e){return"null"===e},apogeeapp.jsonedit.canBeConvertedToNonString=function(e){return isFinite(e)||apogeeapp.jsonedit.isBoolString(e)||apogeeapp.jsonedit.isNullString(e)},apogeeapp.jsonedit.stringToNonString=function(stringValue){var stringToValueCode="value = "+stringValue,value;try{return eval(stringToValueCode),value}catch(e){return stringValue}};var PIXELS_PER_INDENT=10;apogeeapp.jsonedit.createIndentElement=function(e){var t=document.createElement("div");return t.className="indentCell",t.style.width=PIXELS_PER_INDENT*e+"px",t},apogeeapp.jsonedit.createObjectDelimiter=function(e){var t=document.createElement("div");return t.className="objectDelimCell",t.innerHTML=e,t},apogeeapp.jsonedit.createExpandButton=function(e){var t=document.createElement("div");return t.className="buttonCell",t.innerHTML="+",t.onclick=function(){e.setExpanded(!0)},t},apogeeapp.jsonedit.createContractButton=function(e){var t=document.createElement("div");return t.className="buttonCell",t.innerHTML="-",t.onclick=function(){e.setExpanded(!1)},t},apogeeapp.jsonedit.KeyEntry=function(e,t,a,p,o,n,i){this.editArea=e,this.key=a,this.type=p,this.data=o,this.isEditable=n,this.indentLevel=t.getIndentLevel()+1,this.parentValue=t,this.isVirtual=i,this.body=null,this.keyEditObject=null,this.valueEntry=null,this.createBody(this.data)},apogeeapp.jsonedit.KeyEntry.prototype.setKey=function(e){this.key=e,this.keyEditObject.setValue(e)},apogeeapp.jsonedit.KeyEntry.prototype.getInitialKey=function(){return this.key},apogeeapp.jsonedit.KeyEntry.prototype.getCurrentKey=function(){return this.keyEditObject.getValue()},apogeeapp.jsonedit.KeyEntry.prototype.getCurrentValue=function(){return this.valueEntry.getCurrentValue()},apogeeapp.jsonedit.KeyEntry.prototype.getElement=function(){return this.body},apogeeapp.jsonedit.KeyEntry.prototype.getParentValueObject=function(){return this.parentValue},apogeeapp.jsonedit.KeyEntry.prototype.getIndentLevel=function(){return this.indentLevel},apogeeapp.jsonedit.KeyEntry.prototype.setIsVirtual=function(e){this.isVirtual=e,this.keyEditObject.setIsVirtual(e),this.valueEntry.setIsVirtual(e)},apogeeapp.jsonedit.KeyEntry.prototype.updateValueElements=function(){apogeeapp.ui.removeAllChildren(this.body),this.formatBody()},apogeeapp.jsonedit.KeyEntry.prototype.createBody=function(e){this.body=document.createElement("div"),this.body.className="jsonBody",this.createKeyElement(),this.valueEntry=new apogeeapp.jsonedit.ValueEntry(this.editArea,this,e,this.isEditable,this.isVirtual),this.formatBody()},apogeeapp.jsonedit.KeyEntry.prototype.formatBody=function(){this.body.appendChild(apogeeapp.jsonedit.createIndentElement(this.indentLevel)),this.body.appendChild(this.keyEditObject.getElement());for(var e=this.valueEntry.getElementList(),t=0;t<e.length;t++)this.body.appendChild(e[t])},apogeeapp.jsonedit.KeyEntry.prototype.createKeyElement=function(){var e=this.type===apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY&&this.isEditable;if(this.keyEditObject=new apogeeapp.jsonedit.EditField(this.key,this.type,e,this.isVirtual),e){var t=this;this.keyEditObject.setOnEditCallback(function(e){t.isVirtual&&t.parentValue.makeVirtualEntryReal(),t.editArea.valueEdited()});this.keyEditObject.setNavCallback(function(e){t.navigateCells(e)})}},apogeeapp.jsonedit.KeyEntry.prototype.navigateCells=function(e){this.parentValue&&this.parentValue.navigateChildren(this,!0,e)},apogeeapp.jsonedit.KeyEntry.prototype.loadContextMenu=function(e,t){var a=this,p=this.parentValue,o=this.keyEditObject.getElement(),n=this.valueEntry,i=n.getType(),r=this.isVirtual;(o.oncontextmenu=function(o){if(o.preventDefault(),o.stopPropagation(),a.isEditable){var s=new apogeeapp.ui.MenuBody;r||(s.addCallbackMenuItem("Insert Above",function(){p.insertElement("","",t)}),s.addCallbackMenuItem("Insert Below",function(){p.insertElement("","",t+1)}),t>0&&s.addCallbackMenuItem("Move Up",function(){p.moveChildKeyToNextIndex(t-1)}),t<e-1&&s.addCallbackMenuItem("Move Down",function(){p.moveChildKeyToNextIndex(t)}),a.isVirtual||s.addCallbackMenuItem("Delete Entry",function(){p.deleteChildElement(a)}),"value"==i?(s.addCallbackMenuItem("Convert To Object",function(){n.valueToObject()}),s.addCallbackMenuItem("Convert To Array",function(){n.valueToArray()}),n.convertibleToNumber()&&s.addCallbackMenuItem("Convert To Number",function(){n.valueToNonString()}),n.convertibleToBool()&&s.addCallbackMenuItem("Convert To Boolean",function(){n.valueToNonString()}),n.convertibleToNull()&&s.addCallbackMenuItem("Convert To Null",function(){n.valueToNonString()}),n.convertibleToString()&&s.addCallbackMenuItem("Convert To String",function(){n.valueToString()})):"object"==i?(s.addCallbackMenuItem("Convert To Value",function(){n.convertToValue()}),s.addCallbackMenuItem("Convert To Array",function(){n.objectToArray()})):"array"==i&&(s.addCallbackMenuItem("Convert To Value",function(){n.convertToValue()}),s.addCallbackMenuItem("Convert To Object",function(){n.arrayToObject()}))),apogeeapp.ui.Menu.showContextMenu(s,o)}},"value"==i)&&(this.valueEntry.getValueEditObject().getElement().oncontextmenu=o.oncontextmenu)},apogeeapp.jsonedit.KeyEntry.prototype.convertToKeyType=function(e){this.type!=apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY&&(this.type=apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY,this.key=String(e),this.createKeyElement(),apogeeapp.ui.removeAllChildren(this.body),this.formatBody())},apogeeapp.jsonedit.KeyEntry.prototype.convertToIndexType=function(e){this.type!=apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX&&(this.type=apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX,this.key=e,this.createKeyElement(),apogeeapp.ui.removeAllChildren(this.body),this.formatBody())},apogeeapp.jsonedit.ValueEntry=function(e,t,a,p,o){this.editArea=e,this.parent=t,this.data=a,this.isEditable=p,this.type=apogeeapp.jsonedit.getObjectType(a),this.indentLevel=t.getIndentLevel()+1,this.elementList=[],this.isVirtual=o,this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.listDiv=null,this.isExpanded=!0,this.expandedList=[],this.contractedList=[],"value"==this.type?this.createValueEntry(this.data):(this.createChildKeyEntries(this.data),this.updateChildKeys(),this.createElementList())},apogeeapp.jsonedit.ValueEntry.prototype.getInitialValue=function(){return this.data},apogeeapp.jsonedit.ValueEntry.prototype.getCurrentValue=function(){var e,t,a;if("value"==this.type)e=this.valueEditObject.getValue();else if("object"==this.type)for(e={},t=0;t<this.childKeyEntries.length;t++)e[(a=this.childKeyEntries[t]).getCurrentKey()]=a.getCurrentValue();else if("array"==this.type)for(e=[],t=0;t<this.childKeyEntries.length;t++)a=this.childKeyEntries[t],e[t]=a.getCurrentValue();return e},apogeeapp.jsonedit.ValueEntry.prototype.getType=function(){return this.type},apogeeapp.jsonedit.ValueEntry.prototype.setExpanded=function(e){this.isExpanded=e,this.doExpandContract()},apogeeapp.jsonedit.ValueEntry.prototype.getElementList=function(){return this.elementList},apogeeapp.jsonedit.ValueEntry.prototype.getValueEditObject=function(){return this.valueEditObject},apogeeapp.jsonedit.ValueEntry.prototype.getIndentLevel=function(){return this.indentLevel},apogeeapp.jsonedit.ValueEntry.prototype.setIsVirtual=function(e){this.isVirtual=e,this.valueEditObject.setIsVirtual(e)},apogeeapp.jsonedit.ValueEntry.prototype.navigateCells=function(e){var t=this.parent.getParentValueObject();t&&t.navigateChildren(this.parent,!1,e)},apogeeapp.jsonedit.ValueEntry.prototype.navigateChildren=function(e,t,a){var p,o=!1,n=0;if("array"==this.type?a==apogeeapp.jsonedit.EditField.DIRECTION_NEXT||a==apogeeapp.jsonedit.EditField.DIRECTION_DOWN?(p=!t)&&(o=!1,n=1):a==apogeeapp.jsonedit.EditField.DIRECTION_PREV||a==apogeeapp.jsonedit.EditField.DIRECTION_UP?(p=!t)&&(o=!1,n=-1):a!=apogeeapp.jsonedit.EditField.DIRECTION_RIGHT&&a!=apogeeapp.jsonedit.EditField.DIRECTION_LEFT||(p=!1):"object"==this.type&&(a==apogeeapp.jsonedit.EditField.DIRECTION_NEXT?(p=!0,o=!t,n=t?0:1):a==apogeeapp.jsonedit.EditField.DIRECTION_PREV?(p=!0,o=!t,n=t?-1:0):a==apogeeapp.jsonedit.EditField.DIRECTION_RIGHT?(p=t)&&(o=!1,n=0):a==apogeeapp.jsonedit.EditField.DIRECTION_LEFT?(p=!t)&&(o=!0,n=0):a==apogeeapp.jsonedit.EditField.DIRECTION_UP?(p=!0,o=t,n=-1):a==apogeeapp.jsonedit.EditField.DIRECTION_DOWN&&(p=!0,o=t,n=1)),p){var i,r,s=-1,l=null;if((i=e==this.virtualChildKey?this.childKeyEntries.length:this.childKeyEntries.indexOf(e))>=0&&((s=i+n)>=0&&s<this.childKeyEntries.length?l=this.childKeyEntries[s]:s==this.childKeyEntries.length&&(l=this.virtualChildKey)),l)if(o)r=l.keyEditObject;else{var d=l.valueEntry;"value"==d.getType()&&(r=d.valueEditObject)}r&&r.startEdit()}},apogeeapp.jsonedit.ValueEntry.prototype.insertElement=function(e,t,a){var p,o;if(void 0===a&&(a=this.childKeyEntries.length),o=a>=this.childKeyEntries.length?this.virtualChildKey.getElement():this.childKeyEntries[a].getElement(),"object"==this.type)p=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,e,"key",t,this.isEditable,!1);else if("array"==this.type){p=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,a,"index",t,this.isEditable,!1);for(var n=a+1;n<this.childKeyEntries.length;n++)this.childKeyEntries[n].setKey(n);this.virtualChildKey.setKey(this.childKeyEntries.length+1)}this.childKeyEntries.splice(a,0,p),this.updateChildKeys(),this.listDiv.insertBefore(p.getElement(),o)},apogeeapp.jsonedit.ValueEntry.prototype.moveChildKeyToNextIndex=function(e){if(e<0||e>=this.childKeyEntries.length-1)alert("Can not make the specified key move");else{var t=this.childKeyEntries[e],a=this.childKeyEntries[e+1];this.childKeyEntries[e]=a,this.childKeyEntries[e+1]=t,this.updateChildKeys(),this.listDiv.insertBefore(a.getElement(),t.getElement())}},apogeeapp.jsonedit.ValueEntry.prototype.deleteChildElement=function(e){var t=this.childKeyEntries.indexOf(e);-1!=t?(this.childKeyEntries.splice(t,1),this.updateChildKeys(),this.listDiv.removeChild(e.getElement())):alert("Element not found!")},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToNumber=function(){if("value"===this.type){var e=this.getCurrentValue();if("string"===apogeeapp.jsonedit.getValueType(e))return isFinite(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToBool=function(){if("value"===this.type){var e=this.getCurrentValue();if("string"===apogeeapp.jsonedit.getValueType(e))return apogeeapp.jsonedit.isBoolString(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToNull=function(){if("value"===this.type){var e=this.getCurrentValue();if("string"===apogeeapp.jsonedit.getValueType(e))return apogeeapp.jsonedit.isNullString(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.valueToNonString=function(){var e=this.getCurrentValue(),t=apogeeapp.jsonedit.stringToNonString(e);this.valueEditObject.setValue(t),this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToString=function(){if("value"===this.type){var e=this.getCurrentValue();return"string"!==apogeeapp.jsonedit.getValueType(e)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.valueToString=function(){var e=this.getCurrentValue(),t=String(e);this.valueEditObject.setValue(t),this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.valueToArray=function(){if("value"==!this.type)throw"Type value expected. Found "+this.type;this.type="array";var e=[this.valueEditObject.getValue()];if(this.createChildKeyEntries(e),this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.valueToObject=function(){if("value"==!this.type)throw"Type value expected. Found "+this.type;this.type="object";var e={a:this.valueEditObject.getValue()};if(this.createChildKeyEntries(e),this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.objectToArray=function(){if("object"==!this.type)throw"Type object expected. Found "+this.type;this.type="array";var e=0;if(this.childKeyEntries)for(e=0;e<this.childKeyEntries.length;e++){this.childKeyEntries[e].convertToIndexType(e)}if(this.virtualChildKey&&this.virtualChildKey.convertToIndexType(e),this.valueEditObject=null,this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.arrayToObject=function(){if("array"==!this.type)throw"Type array expected. Found "+this.type;this.type="object";var e=0;if(this.childKeyEntries)for(e=0;e<this.childKeyEntries.length;e++){this.childKeyEntries[e].convertToKeyType(String(e))}if(this.virtualChildKey&&this.virtualChildKey.convertToKeyType(""),this.updateChildKeys(),this.createElementList(),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.convertToValue=function(){if("value"!=this.type){var e;if(this.type="value",this.childKeyEntries&&this.childKeyEntries.length>0)e=this.childKeyEntries[0].getCurrentValue();else e="";if(this.createValueEntry(e),this.parent){var t=this.parent.getParentValueObject();t&&t.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()}},apogeeapp.jsonedit.ValueEntry.prototype.createValueEntry=function(e){"value"==this.type&&(this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.elementList=[],this.createValueElement(e),this.listDiv=null,this.contractedList=null,this.expandedList=null)},apogeeapp.jsonedit.ValueEntry.prototype.createChildKeyEntries=function(e){var t;if("value"!=this.type)if(this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.elementList=[],"object"==this.type){for(var a in e)t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,a,"key",e[a],this.isEditable,!1),this.childKeyEntries.push(t);this.isEditable&&(t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,"","key","",this.isEditable,!0),this.virtualChildKey=t)}else if("array"==this.type){for(var p=0;p<e.length;p++)t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,p,"index",e[p],this.isEditable,!1),this.childKeyEntries.push(t);this.isEditable&&(t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,p,"index","",this.isEditable,!0),this.virtualChildKey=t)}},apogeeapp.jsonedit.ValueEntry.prototype.createElementList=function(){var e,t,a;this.listDiv=document.createElement("div"),this.elementList=[],this.contractedList=[],this.expandedList=[];for(var p,o=apogeeapp.jsonedit.createIndentElement(this.indentLevel),n=0;n<this.childKeyEntries.length;n++)p=this.childKeyEntries[n],this.listDiv.appendChild(p.getElement());this.virtualChildKey&&this.listDiv.appendChild(this.virtualChildKey.getElement());var i=apogeeapp.jsonedit.createExpandButton(this),r=apogeeapp.jsonedit.createContractButton(this);"object"==this.type?(e=apogeeapp.jsonedit.createObjectDelimiter("{"),t=apogeeapp.jsonedit.createObjectDelimiter("}"),a=apogeeapp.jsonedit.createObjectDelimiter("}")):"array"==this.type&&(e=apogeeapp.jsonedit.createObjectDelimiter("["),t=apogeeapp.jsonedit.createObjectDelimiter("]"),a=apogeeapp.jsonedit.createObjectDelimiter("]")),this.elementList.push(e),this.elementList.push(i),this.contractedList.push(i),this.elementList.push(t),this.contractedList.push(t),this.elementList.push(r),this.expandedList.push(r),(this.childKeyEntries.length>0||this.virtualChildKey)&&(this.elementList.push(this.listDiv),this.expandedList.push(this.listDiv),this.elementList.push(o),this.expandedList.push(o)),this.elementList.push(a),this.expandedList.push(a),this.doExpandContract()},apogeeapp.jsonedit.ValueEntry.prototype.updateChildKeys=function(){var e,t;if("object"==this.type){var a;for(a in e=0,this.childKeyEntries)e++;for(a in t=0,this.childKeyEntries){var p=this.childKeyEntries[a];p.loadContextMenu(e,t),t++}this.virtualChildKey&&this.virtualChildKey.loadContextMenu(e,e)}else if("array"==this.type){for(e=this.childKeyEntries.length,t=0;t<e;t++)(p=this.childKeyEntries[t]).getCurrentKey()!=t&&p.setKey(t),p.loadContextMenu(e,t);this.virtualChildKey&&(this.virtualChildKey.getCurrentKey()!=e&&this.virtualChildKey.setKey(e),this.virtualChildKey.loadContextMenu(e,e))}},apogeeapp.jsonedit.ValueEntry.prototype.doExpandContract=function(){if(this.expandedList&&this.contractedList){var e,t=this.isExpanded?this.expandedList:this.contractedList,a=this.isExpanded?this.contractedList:this.expandedList;for(e=0;e<t.length;e++)t[e].style.display="";for(e=0;e<a.length;e++)a[e].style.display="none"}},apogeeapp.jsonedit.ValueEntry.prototype.createValueElement=function(e){this.valueEditObject=new apogeeapp.jsonedit.EditField(e,apogeeapp.jsonedit.EditField.FIELD_TYPE_VALUE,this.isEditable,this.isVirtual);var t=this;this.valueEditObject.setOnEditCallback(function(e){if(t.isVirtual){var a=t.parent.getParentValueObject();a&&a.makeVirtualEntryReal()}t.editArea.valueEdited()});this.valueEditObject.setNavCallback(function(e){t.navigateCells(e)});var a=this.valueEditObject.getElement();this.elementList.push(a)},apogeeapp.jsonedit.ValueEntry.prototype.makeVirtualEntryReal=function(e){var t,a=this.virtualChildKey;a.setIsVirtual(!1),this.childKeyEntries.push(a),"object"==this.type?(t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,"","key","",this.isEditable,!0),this.virtualChildKey=t):"array"==this.type&&(t=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,this.childKeyEntries.length,"index","",this.isEditable,!0),this.virtualChildKey=t),this.updateChildKeys(),this.createElementList(),this.parent.updateValueElements()},apogeeapp.jsonedit.EditField=function(e,t,a,p){this.fieldType=t,this.isEditable=a,this.isVirtual=p,this.element=document.createElement("div"),this.onEdit=null,this.onNavigate=null,this.editField=null;var o=this;this.element.onclick=function(){o.onClick()},this.setValue(e)},apogeeapp.jsonedit.EditField.FIELD_TYPE_VALUE="value",apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY="key",apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX="index",apogeeapp.jsonedit.EditField.prototype.setOnEditCallback=function(e){return this.onEdit=e},apogeeapp.jsonedit.EditField.prototype.setNavCallback=function(e){this.onNavigate=e},apogeeapp.jsonedit.EditField.prototype.setIsVirtual=function(e){this.isVirtual=e,this.setCssClass()},apogeeapp.jsonedit.EditField.prototype.getValue=function(){return this.value},apogeeapp.jsonedit.EditField.prototype.setValue=function(e){void 0===e&&(e=null,console.log("The value undefined is not valid for a JSON. It has been converted to null.")),this.value=e,this.isString="string"===apogeeapp.jsonedit.getValueType(e),this.setCssClass(),this.element.innerHTML=null===e?"null":""===e?"&nbsp;":e},apogeeapp.jsonedit.EditField.prototype.setCssClass=function(){var e="cell_base cell_"+this.fieldType;this.isVirtual?e+="_virtual":"value"===this.fieldType&&(this.isString?e+="_string":e+="_nonstring"),this.element.className=e},apogeeapp.jsonedit.EditField.prototype.getElement=function(){return this.element},apogeeapp.jsonedit.EditField.prototype.onClick=function(){this.isEditable&&!this.editField&&this.startEdit()},apogeeapp.jsonedit.EditField.prototype.startEdit=function(){if(!this.editField){var e,t=getSelection();t.anchorNode.parentNode==this.element?(e={},t.anchorOffset<=t.focusOffset?(e.start=t.anchorOffset,e.end=t.focusOffset):(e.start=t.focusOffset,e.end=t.anchorOffset)):e=null,this.editField=document.createElement("input"),this.editField.type="text",void 0!==this.value&&(this.editField.value=this.value),apogeeapp.ui.removeAllChildren(this.element),this.element.appendChild(this.editField),e?this.editField.setSelectionRange(e.start,e.end):this.editField.select(),this.editField.focus();var a=this;this.editField.onblur=function(){a.endEdit()},this.editField.onkeydown=function(e){a.onKeyDown(e)}}},apogeeapp.jsonedit.EditField.prototype.endEdit=function(){if(this.editField)if(this.editField.value!=this.value){var e,t=this.editField.value;e=this.isString&&""!==this.value?t:apogeeapp.jsonedit.canBeConvertedToNonString(t)?apogeeapp.jsonedit.stringToNonString(t):t,this.editField=null,this.setValue(e),this.onEdit&&this.onEdit(this.value)}else this.editField=null,this.element.innerHTML=this.value},apogeeapp.jsonedit.EditField.DIRECTION_NONE=0,apogeeapp.jsonedit.EditField.DIRECTION_UP=1,apogeeapp.jsonedit.EditField.DIRECTION_DOWN=2,apogeeapp.jsonedit.EditField.DIRECTION_RIGHT=3,apogeeapp.jsonedit.EditField.DIRECTION_LEFT=4,apogeeapp.jsonedit.EditField.DIRECTION_NEXT=5,apogeeapp.jsonedit.EditField.DIRECTION_PREV=6,apogeeapp.jsonedit.EditField.ENTER_KEY=13,apogeeapp.jsonedit.EditField.TAB_KEY=9,apogeeapp.jsonedit.EditField.UP_KEY=38,apogeeapp.jsonedit.EditField.DOWN_KEY=40,apogeeapp.jsonedit.EditField.RIGHT_KEY=39,apogeeapp.jsonedit.EditField.LEFT_KEY=37,apogeeapp.jsonedit.EditField.prototype.onKeyDown=function(e){var t=!1,a=apogeeapp.jsonedit.EditField.DIRECTION_NONE,p=!1;e.keyCode==apogeeapp.jsonedit.EditField.ENTER_KEY?(t=!0,a=e.shiftKey?apogeeapp.jsonedit.EditField.DIRECTION_PREV:apogeeapp.jsonedit.EditField.DIRECTION_NEXT,p=!0):e.keyCode==apogeeapp.jsonedit.EditField.TAB_KEY?(t=!0,a=e.shiftKey?apogeeapp.jsonedit.EditField.DIRECTION_PREV:apogeeapp.jsonedit.EditField.DIRECTION_NEXT,p=!0):e.keyCode==apogeeapp.jsonedit.EditField.UP_KEY?(t=!0,a=apogeeapp.jsonedit.EditField.DIRECTION_UP,p=!0):e.keyCode==apogeeapp.jsonedit.EditField.DOWN_KEY?(t=!0,a=apogeeapp.jsonedit.EditField.DIRECTION_DOWN,p=!0):e.keyCode==apogeeapp.jsonedit.EditField.RIGHT_KEY?this.cursorAtEndOfEditField()&&(t=!0,a=apogeeapp.jsonedit.EditField.DIRECTION_RIGHT,p=!0):e.keyCode==apogeeapp.jsonedit.EditField.LEFT_KEY&&this.cursorAtStartOfEditField()&&(t=!0,a=apogeeapp.jsonedit.EditField.DIRECTION_LEFT,p=!0),p&&(e.preventDefault(),e.stopPropagation()),t&&(this.endEdit(),a!=apogeeapp.jsonedit.EditField.DIRECTION_NONE&&this.onNavigate&&this.onNavigate(a))},apogeeapp.jsonedit.EditField.prototype.cursorAtStartOfEditField=function(){return 0==this.editField.selectionStart&&0==this.editField.selectionEnd},apogeeapp.jsonedit.EditField.prototype.cursorAtEndOfEditField=function(){var e=String(this.editField.value).length;return this.editField.selectionStart==e&&this.editField.selectionEnd==e},apogeeapp.jsonedit.JsonEditArea=function(e,t,a){this.body=e,this.isEditable=a,void 0===t&&(t=""),this.valueEntry=new apogeeapp.jsonedit.ValueEntry(this,this,t,this.isEditable),this.valueEntry.setExpanded(!0),this.formatBody()},apogeeapp.jsonedit.JsonEditArea.prototype.setEditCallback=function(e){this.editCallback=e},apogeeapp.jsonedit.JsonEditArea.prototype.getCurrentValue=function(){return this.valueEntry.getCurrentValue()},apogeeapp.jsonedit.JsonEditArea.prototype.getElement=function(){return this.body},apogeeapp.jsonedit.JsonEditArea.prototype.getParentValueObject=function(){},apogeeapp.jsonedit.JsonEditArea.prototype.getIndentLevel=function(){return 0},apogeeapp.jsonedit.JsonEditArea.prototype.formatBody=function(){for(var e=this.valueEntry.getElementList(),t=0;t<e.length;t++)this.body.appendChild(e[t]);this.loadContextMenu()},apogeeapp.jsonedit.JsonEditArea.prototype.loadContextMenu=function(){var e=this,t=this.body,a=this.valueEntry,p=a.getType();t.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation();var o=new apogeeapp.ui.MenuBody;o.addCallbackMenuItem("Get Value",function(){alert(JSON.stringify(a.getCurrentValue()))}),e.isEditable&&("value"==p?(o.addCallbackMenuItem("Convert To Object",function(){a.valueToObject()}),o.addCallbackMenuItem("Convert To Array",function(){a.valueToArray()}),a.convertibleToNumber()&&o.addCallbackMenuItem("Convert To Number",function(){a.valueToNonString()}),a.convertibleToBool()&&o.addCallbackMenuItem("Convert To Boolean",function(){a.valueToNonString()}),a.convertibleToNull()&&o.addCallbackMenuItem("Convert To Null",function(){a.valueToNonString()}),a.convertibleToString()&&o.addCallbackMenuItem("Convert To String",function(){a.valueToString()})):"object"==p?(o.addCallbackMenuItem("Convert To Value",function(){a.convertToValue()}),o.addCallbackMenuItem("Convert To Array",function(){a.objectToArray()})):"array"==p&&(o.addCallbackMenuItem("Convert To Value",function(){a.convertToValue()}),o.addCallbackMenuItem("Convert To Object",function(){a.arrayToObject()}))),apogeeapp.ui.Menu.showContextMenu(o,t)}},apogeeapp.jsonedit.JsonEditArea.prototype.updateValueElements=function(){apogeeapp.ui.removeAllChildren(this.body),this.formatBody()},apogeeapp.jsonedit.JsonEditArea.prototype.valueEdited=function(){this.editCallback&&this.editCallback()},apogeeapp.ui.setLoadListener=function(e,t,a){var p=apogeeapp.ui.createElement("iframe",null,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",overflow:"hidden",zIndex:-1});p.onload=function(){var e=p.contentDocument.body;t&&t(),a&&(a(),e.onresize=a)},e.appendChild(p)},apogeeapp.ui.removeResizeListener=function(e,t){alert("implement this!")},apogeeapp.ui.DisplayAndHeader=function(e,t,a,p){this.container=apogeeapp.ui.createElementWithClass("div","visiui-dnh-container"),this.header=apogeeapp.ui.createElementWithClass("div","visiui-dnh-header",this.container),this.body=apogeeapp.ui.createElementWithClass("div","visiui-dnh-body",this.container),this.headerStyleClass=t,this.bodyStyleClass=p,this.headerContent=document.createElement("div"),this.header.appendChild(this.headerContent),this.bodyContent=document.createElement("div"),this.body.appendChild(this.bodyContent),this.setHeaderType(e),this.setBodyType(a)},apogeeapp.ui.DisplayAndHeader.FIXED_PANE="visiui-dnh-fixed",apogeeapp.ui.DisplayAndHeader.SCROLLING_PANE="visiui-dnh-scrolling",apogeeapp.ui.DisplayAndHeader.prototype.setHeaderType=function(e){var t=e;this.headerStyleClass&&(t+=" "+this.headerStyleClass),this.headerContent.className=t},apogeeapp.ui.DisplayAndHeader.prototype.setBodyType=function(e){var t=e;this.bodyStyleClass&&(t+=" "+this.bodyStyleClass),this.bodyContent.className=t},apogeeapp.ui.DisplayAndHeader.prototype.getOuterElement=function(){return this.container},apogeeapp.ui.DisplayAndHeader.prototype.getHeaderContainer=function(){return this.header},apogeeapp.ui.DisplayAndHeader.prototype.getBodyContainer=function(){return this.body},apogeeapp.ui.DisplayAndHeader.prototype.getHeader=function(){return this.headerContent},apogeeapp.ui.DisplayAndHeader.prototype.getBody=function(){return this.bodyContent},apogeeapp.ui.SplitPane=function(e,t){this.container1=apogeeapp.ui.createElementWithClass("div","visiui-sp-parent");var a=apogeeapp.ui.createElementWithClass("div","visiui-sp-parent2",this.container1),p=apogeeapp.ui.createElementWithClass("table","visiui-sp-table",a),o=apogeeapp.ui.createElementWithClass("tr","visiui-sp-row",p),n=apogeeapp.ui.createElementWithClass("td","visiui-sp-left",o),i=apogeeapp.ui.createElementWithClass("td","visiui-sp-divider",o),r=apogeeapp.ui.createElementWithClass("td","visiui-sp-right",o),s=apogeeapp.ui.createElementWithClass("div","visiui-sp-inner",n);this.leftOuterPane=apogeeapp.ui.createElementWithClass("div",e,s);var l=apogeeapp.ui.createElementWithClass("div","visiui-sp-inner",r);this.rightOuterPane=apogeeapp.ui.createElementWithClass("div",t,l);var d=!1,u=0,g=0,c=function(e){if(d){var t=e.clientX-u;n.style.width=g+t+"px"}},h=function(e){E()},m=function(e){E()},E=function(){d=!1,p.removeEventListener("mouseup",h),p.removeEventListener("mousemove",c),p.removeEventListener("mouseleave",m)};i.addEventListener("mousedown",function(e){d=!0,u=e.clientX,g=n.offsetWidth,p.addEventListener("mouseup",h),p.addEventListener("mousemove",c),p.addEventListener("mouseleave",m)})},apogeeapp.ui.SplitPane.SCROLLING_PANE="visiui-sp-scrolling",apogeeapp.ui.SplitPane.FIXED_PANE="visiui-sp-fixed",apogeeapp.ui.SplitPane.prototype.getOuterElement=function(){return this.container1},apogeeapp.ui.SplitPane.prototype.getLeftPaneContainer=function(){return this.leftOuterPane},apogeeapp.ui.SplitPane.prototype.getRightPaneContainer=function(){return this.rightOuterPane},apogeeapp.ui.treecontrol||(apogeeapp.ui.treecontrol={}),apogeeapp.ui.treecontrol.TreeControl=function(){this.list=apogeeapp.ui.createElementWithClass("ul","visiui-tc-child-list",this.element)},apogeeapp.ui.treecontrol.TreeControl.prototype.getElement=function(){return this.list},apogeeapp.ui.treecontrol.TreeControl.prototype.setRootEntry=function(e){this.clearRootEntry(),this.list.appendChild(e.getElement())},apogeeapp.ui.treecontrol.TreeControl.prototype.clearRootEntry=function(){apogeeapp.ui.removeAllChildren(this.list)},apogeeapp.ui.treecontrol||(apogeeapp.ui.treecontrol={}),apogeeapp.ui.treecontrol.TreeEntry=function(e,t,a,p,o){var n;this.contractUrl=apogeeapp.ui.getResourcePath("/contractPlus2.png"),this.expandUrl=apogeeapp.ui.getResourcePath("/expandPlus2.png"),this.noControlUrl=apogeeapp.ui.getResourcePath("/nothingPlus2.png"),this.emptyControlUrl=apogeeapp.ui.getResourcePath("/emptyPlus2.png"),this.isRoot=o,n=o?"visiui-tc-root":"visiui-tc-child",this.element=apogeeapp.ui.createElementWithClass("li",n),this.control=apogeeapp.ui.createElementWithClass("img","visiui-tc-control",this.element),t&&(this.iconContainerElement=apogeeapp.ui.createElementWithClass("div","visiui-tc-icon-container",this.element),p?(this.menu=apogeeapp.ui.Menu.createMenuFromImage(t),this.menu.setAsOnTheFlyMenu(p),this.iconContainerElement.appendChild(this.menu.getElement())):(this.icon=apogeeapp.ui.createElementWithClass("img","visiui-tc-icon",this.iconContainerElement),this.icon.src=t),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_tc_icon_overlay",this.iconContainerElement)),this.label=apogeeapp.ui.createElementWithClass("div","visiui-tc-label",this.element),e&&this.setLabel(e),this.childContainer=null,this.childEntries=[],this.parent=null,this.sortFunction=null,this.extraSortParam=null,this.nonEmptyState=apogeeapp.ui.treecontrol.DEFAULT_STATE,this.setState(apogeeapp.ui.treecontrol.NO_CONTROL);this.label.oncontextmenu=function(e){var t=new apogeeapp.ui.MenuBody,a=p();t.setMenuItems(a),apogeeapp.ui.Menu.showContextMenu(t,e)},a&&(this.label.ondblclick=a)},apogeeapp.ui.treecontrol.NO_CONTROL=0,apogeeapp.ui.treecontrol.EXPANDED=1,apogeeapp.ui.treecontrol.COLLAPSED=-1,apogeeapp.ui.treecontrol.DEFAULT_STATE=apogeeapp.ui.treecontrol.COLLAPSED,apogeeapp.ui.treecontrol.TreeEntry.prototype.getElement=function(){return this.element},apogeeapp.ui.treecontrol.TreeEntry.prototype.setSortFunction=function(e){this.sortFunction=e},apogeeapp.ui.treecontrol.TreeEntry.prototype.setLabel=function(e){this.labelText=e,this.label.innerHTML=e,this.parent&&this.parent._notifyNameChange(this)},apogeeapp.ui.treecontrol.TreeEntry.prototype.getLabel=function(){return this.labelText},apogeeapp.ui.treecontrol.TreeEntry.prototype.setExtraSortParam=function(e){this.extraSortParam=e},apogeeapp.ui.treecontrol.TreeEntry.prototype.getExtraSortParam=function(){return this.extraSortParam},apogeeapp.ui.treecontrol.TreeEntry.prototype.addChild=function(e){this.childEntries.push(e),this._insertChildIntoList(e),e._setParent(this)},apogeeapp.ui.treecontrol.TreeEntry.prototype.removeChild=function(e){if(this.childContainer){var t=this.childEntries.indexOf(e);t>=0&&(this.childEntries.splice(t,1),this._removeChildFromList(e),e._setParent(null))}},apogeeapp.ui.treecontrol.TreeEntry.prototype.getState=function(){return this.state},apogeeapp.ui.treecontrol.TreeEntry.prototype.setState=function(e){if(this.childContainer&&0!=this.childContainer.length?this.state=e:this.state=apogeeapp.ui.treecontrol.NO_CONTROL,e!=apogeeapp.ui.treecontrol.NO_CONTROL&&(this.nonEmptyState=e),this.state==apogeeapp.ui.treecontrol.NO_CONTROL)this.isRoot?this.control.src=this.emptyControlUrl:this.control.src=this.noControlUrl;else if(this.state==apogeeapp.ui.treecontrol.EXPANDED){if(this.control.src=this.contractUrl,!this.collapse){var t=this;this.collapse=function(){t.setState(apogeeapp.ui.treecontrol.COLLAPSED)}}this.control.onclick=this.collapse,this.childContainer.style.display=""}else if(this.state==apogeeapp.ui.treecontrol.COLLAPSED){if(this.control.src=this.expandUrl,!this.expand){t=this;this.expand=function(){t.setState(apogeeapp.ui.treecontrol.EXPANDED)}}this.control.onclick=this.expand,this.childContainer.style.display="none"}},apogeeapp.ui.treecontrol.TreeEntry.prototype.setIconOverlay=function(e){this.clearIconOverlay(),e&&this.iconOverlayElement.appendChild(e)},apogeeapp.ui.treecontrol.TreeEntry.prototype.clearIconOverlay=function(){apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.treecontrol.TreeEntry.prototype._setParent=function(e){this.parent=e},apogeeapp.ui.treecontrol.TreeEntry.prototype._insertChildIntoList=function(e){this.childContainer||(this.childContainer=apogeeapp.ui.createElementWithClass("ul","visiui-tc-child-list",this.element),this.setState(this.nonEmptyState)),this.sortFunction?this._updateChildElements():this.childContainer.appendChild(e.getElement())},apogeeapp.ui.treecontrol.TreeEntry.prototype._removeChildFromList=function(e){this.childContainer.removeChild(e.getElement()),0===this.childContainer.childElementCount&&(this.element.removeChild(this.childContainer),this.childContainer=null,this.nonEmtpyState=this.state,this.setState(apogeeapp.ui.treecontrol.NO_CONTROL))},apogeeapp.ui.treecontrol.TreeEntry.prototype._notifyNameChange=function(e){this.sortFunction&&this._updateChildElements()},apogeeapp.ui.treecontrol.TreeEntry.prototype._updateChildElements=function(){var e=this.childEntries.map(e=>e);e.sort(this.sortFunction),apogeeapp.ui.removeAllChildren(this.childContainer),e.forEach(e=>this.childContainer.appendChild(e.getElement()))},apogeeapp.ui.ConfigurablePanel=class{constructor(e=apogeeapp.ui.ConfigurablePanel.CONTAINER_CLASS_SELF_SIZED){this.elementObjects=[],this.panelElement=this.createPanelElement(e)}configureForm(e){e&&e.constructor==Array&&(e={layout:e}),e&&e.layout&&e.layout.constructor==Array||(e=apogeeapp.ui.ConfigurablePanel.INVALID_INIT_DATA),apogeeapp.ui.removeAllChildren(this.panelElement),this.elementObjects=[];try{e.layout.forEach(e=>this.addToPanel(e)),e.onChange&&this.addOnChange(e.onChange),e.onSubmitInfo&&this.addSubmit(e.onSubmitInfo.onSubmit,e.onSubmitInfo.onCancel,e.onSubmitInfo.submitLabel,e.onSubmitInfo.cancelLabel),e.disabled&&this.setDisabled(!0)}catch(e){var t="Error in panel: "+e.message,a=apogeeapp.ui.ConfigurablePanel.getErrorMessageLayoutInfo(t);this.configureForm(a)}}getEntry(e){return this.elementObjects.find(t=>t.getKey()==e)}getValue(){var e={};return this.elementObjects.forEach(t=>{if(t.getState()!=apogeeapp.ui.ConfigurableElement.STATE_INACTIVE){var a=t.getValue();if(void 0!==a){var p=t.getKey();e[p]=a}}}),e}setValue(e){for(var t in e){var a=this.getEntry(t);a&&a.setValue(e[t])}}getElement(){return this.panelElement}getChildEntries(){return this.elementObjects}addSubmit(e,t,a=apogeeapp.ui.SubmitElement.DEFAULT_SUBMIT_LABEL,p=apogeeapp.ui.SubmitElement.DEFAULT_CANCEL_LABEL){var o={};o.type=apogeeapp.ui.SubmitElement.TYPE_NAME,e&&(o.onSubmit=e,o.submitLabel=a),t&&(o.onCancel=t,o.cancelLabel=p),this.addToPanel(o)}addOnChange(e){var t=(t,a)=>{var p=this.getValue();e(p,a)};this.elementObjects.forEach(e=>{e.addOnChange&&e.addOnChange(t)})}setDisabled(e){var t=e?apogeeapp.ui.ConfigurableElement.STATE_DISABLED:apogeeapp.ui.ConfigurableElement.STATE_NORMAL;this.elementObjects.forEach(e=>e.setState(t))}static addConfigurableElement(e){var t=e.TYPE_NAME;apogeeapp.ui.ConfigurablePanel.elementMap[t]=e}static getErrorMessageLayoutInfo(e){var t=[],a={type:"htmlDisplay"};return a.html="<em style='color:red'>"+e+"</em>",t.push(a),{layout:t}}createPanelElement(e){var t=document.createElement("div");return t.className=e,t}addToPanel(e){var t,a=e.type;if(!a)throw new Error("Type not found for configurable form entry!");if("custom"==a)t=new apogeeapp.ui.ConfigurableElement(this,e),e.builderFunction(t);else{var p=apogeeapp.ui.ConfigurablePanel.getTypeConstructor(a);if(!p)throw new Error("Type not found for configurable element: "+a);t=new p(this,e)}this.elementObjects.push(t);var o=t.getElement();o&&this.panelElement.appendChild(o)}static getTypeConstructor(e){return apogeeapp.ui.ConfigurablePanel.elementMap[e]}},apogeeapp.ui.ConfigurablePanel.elementMap={},apogeeapp.ui.ConfigurablePanel.CONTAINER_CLASS_FILL_PARENT="apogee_configurablePanelBody_fillParent",apogeeapp.ui.ConfigurablePanel.CONTAINER_CLASS_SELF_SIZED="apogee_configurablePanelBody_selfSized",apogeeapp.ui.ConfigurablePanel.INVALID_INIT_DATA={layout:[{type:"heading",text:"INVALID FORM LAYOUT!",level:4}]},apogeeapp.ui.ConfigurableElement=class{constructor(e,t,a=apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_STANDARD){this.form=e,this.key=t.key,this.domElement=apogeeapp.ui.createElement("div",{className:a})}getKey(){return this.key}getValue(){}getState(){return this.state}setState(e){switch(this.state=e,e){case apogeeapp.ui.ConfigurableElement.STATE_NORMAL:this._setVisible(!0),this._setDisabled(!1);break;case apogeeapp.ui.ConfigurableElement.STATE_DISABLED:this._setVisible(!0),this._setDisabled(!0);break;case apogeeapp.ui.ConfigurableElement.STATE_HIDDEN:case apogeeapp.ui.ConfigurableElement.STATE_INACTIVE:this._setVisible(!1)}}setValue(e){}getElement(){return this.domElement}getForm(){return this.form}addSelectionChild(e,t,a){this.childSelectionElements||this._initAsParent();var p={};p.element=e,p.value=t,p.keepActiveOnHide=a,this.childSelectionElements.push(p),this.setChildState(p,this.getValue())}checkChildSelection(e){this.childSelectionElements&&this.setChildState&&this.childSelectionElements.forEach(t=>this.setChildState(t,e))}static setChildStateSingleValue(e,t){if(e.value==t)e.element.setState(apogeeapp.ui.ConfigurableElement.STATE_NORMAL);else{var a=e.keepActiveOnHide?apogeeapp.ui.ConfigurableElement.STATE_HIDDEN:apogeeapp.ui.ConfigurableElement.STATE_INACTIVE;e.element.setState(a)}}static setChildStateArrayValue(e,t){if(t.indexOf(e.value)>=0)e.element.setState(apogeeapp.ui.ConfigurableElement.STATE_NORMAL);else{var a=e.keepActiveOnHide?apogeeapp.ui.ConfigurableElement.STATE_HIDDEN:apogeeapp.ui.ConfigurableElement.STATE_INACTIVE;e.element.setState(a)}}_postInstantiateInit(e){void 0!==e.value&&this.setValue(e.value);var t=void 0!=e.state?e.state:apogeeapp.ui.ConfigurableElement.STATE_NORMAL;if(this.setState(t),e.onChange&&this.addOnChange(e.onChange),e.selector){if(!e.selector.parentKey)throw new Error("Parent key is required for a selectable child element:"+e.key);if(void 0===e.selector.parentValue)throw new Error("A child selectable element must contain a value: "+e.key);var a=this.form.getEntry(e.selector.parentKey);if(!a)throw new Error("Parent element "+e.selector.parentKey+" not found for selectable child element "+e.key);if(!a.setChildState)throw new Error("Parent element "+e.selector.parentKey+" does not support selection of a child element - in element = "+e.key);a.addSelectionChild(this,e.selector.parentValue,e.keepActiveOnHide)}}_setDisabled(e){}_setVisible(e){this.domElement.style.display=e?"":"none"}_initAsParent(){this.childSelectionElements=[],this.parentOnChangeHandler=((e,t)=>this.childSelectionElements.forEach(t=>this.setChildState(t,e))),this.addOnChange(this.parentOnChangeHandler)}},apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_STANDARD="apogee_configurablePanelLine_standard",apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_NO_MARGIN="apogee_configurablePanelPanelLine_noMargin",apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_INVISIBLE="apogee_configurablePanelPanelLine_hidden",apogeeapp.ui.ConfigurableElement.STATE_NORMAL="normal",apogeeapp.ui.ConfigurableElement.STATE_DISABLED="disabled",apogeeapp.ui.ConfigurableElement.STATE_HIDDEN="hidden",apogeeapp.ui.ConfigurableElement.STATE_INACTIVE="inactive",apogeeapp.ui.HeadingElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement(),p="h"+(t.level?t.level:apogeeapp.ui.HeadingElement.DEFAULT_HEADING_LEVEL);this.headingElement=apogeeapp.ui.createElement(p,{className:"apogee_configurablePanelHeading",innerHTML:t.text}),a.appendChild(this.headingElement)}updateData(e){}},apogeeapp.ui.HeadingElement.DEFAULT_HEADING_LEVEL=2,apogeeapp.ui.HeadingElement.TYPE_NAME="heading",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.HeadingElement),apogeeapp.ui.TextFieldElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();t.label?(this.labelElement=document.createElement("span"),this.labelElement.className="apogee_configurablePanelLabel",this.labelElement.innerHTML=t.label,a.appendChild(this.labelElement)):this.labelElement=null;var p=!0===t.password?"password":"text";this.inputElement=apogeeapp.ui.createElement("input",{type:p}),a.appendChild(this.inputElement),void 0!==t.size&&(this.inputElement.size=t.size),t.onChangeCompleted&&this.addOnChangeCompleted(t.onChangeCompleted),this._postInstantiateInit(t)}getValue(){return this.inputElement.value.trim()}setValue(e){this.inputElement.value=e}addOnChange(e){this.inputElement.addEventListener("input",()=>{e(this.getValue(),this.getForm())})}addOnChangeCompleted(e){this.inputElement.addEventListener("change",()=>{e(this.getValue(),this.getForm())})}_setDisabled(e){this.inputElement.disabled=e}},apogeeapp.ui.TextFieldElement.TYPE_NAME="textField",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.TextFieldElement),apogeeapp.ui.TextareaElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();t.label?(this.labelElement=document.createElement("span"),this.labelElement.className="apogee_configurablePanelLabel",this.labelElement.innerHTML=t.label,a.appendChild(this.labelElement)):this.labelElement=null,this.inputElement=apogeeapp.ui.createElement("textarea"),t.rows&&(this.inputElement.rows=t.rows),t.cols&&(this.inputElement.cols=t.cols),a.appendChild(this.inputElement),t.onChangeCompleted&&this.addOnChangeCompleted(t.onChangeCompleted),this._postInstantiateInit(t)}getValue(){return this.inputElement.value.trim()}setValue(e){this.inputElement.value=e}addOnChange(e){this.inputElement.addEventListener("input",()=>{e(this.getValue(),this.getForm())})}addOnChangeCompleted(e){this.inputElement.addEventListener("change",()=>{e(this.getValue(),this.getForm())})}_setDisabled(e){this.inputElement.disabled=e}},apogeeapp.ui.TextareaElement.TYPE_NAME="textarea",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.TextareaElement),apogeeapp.ui.DropdownElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();t.label?(this.labelElement=document.createElement("span"),this.labelElement.className="apogee_configurablePanelLabel",this.labelElement.innerHTML=t.label,a.appendChild(this.labelElement)):this.labelElement=null,this.select=apogeeapp.ui.createElement("select");t.entries&&t.entries.forEach(e=>{var t,a;"Array"==apogee.util.getObjectType(e)?(t=e[0],a=e[1]):(t=e,a=e);var p=document.createElement("option");p.text=t,p.value=a,this.select.appendChild(p)}),a.appendChild(this.select),this._postInstantiateInit(t),this.setChildState=apogeeapp.ui.ConfigurableElement.setChildStateSingleValue}getValue(){return this.select.value}setValue(e){this.select.value=e,this.checkChildSelection(e)}addOnChange(e){this.select.addEventListener("change",()=>{e(this.getValue(),this.getForm())})}_setDisabled(e){this.select.disabled=e}},apogeeapp.ui.DropdownElement.TYPE_NAME="dropdown",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.DropdownElement),apogeeapp.ui.CheckboxElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();t.label?(this.labelElement=document.createElement("span"),this.labelElement.className="apogee_configurablePanelLabel",this.labelElement.innerHTML=t.label,a.appendChild(this.labelElement)):this.labelElement=null,this.checkbox=apogeeapp.ui.createElement("input",{type:"checkbox"}),a.appendChild(this.checkbox),this._postInstantiateInit(t),this.setChildState=apogeeapp.ui.ConfigurableElement.setChildStateSingleValue}getValue(){return this.checkbox.checked}setValue(e){this.checkbox.checked=!0===e,this.checkChildSelection(e)}addOnChange(e){this.checkbox.addEventListener("change",()=>{e(this.getValue(),this.getForm())})}_setDisabled(e){this.checkbox.disabled=e}},apogeeapp.ui.CheckboxElement.TYPE_NAME="checkbox",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.CheckboxElement),apogeeapp.ui.CheckboxGroupElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();t.label?(this.labelElement=document.createElement("span"),this.labelElement.className="apogee_configurablePanelLabel",this.labelElement.innerHTML=t.label,a.appendChild(this.labelElement),t.horizontal||a.appendChild(document.createElement("br"))):this.labelElement=null,this.checkboxList=[];t.entries.forEach(e=>{var p,o,n=apogeeapp.ui.createElement("input");n.type="checkbox","Array"==apogee.util.getObjectType(e)?(p=e[0],o=e[1]):(p=e,o=e),n.value=o,this.checkboxList.push(n),a.appendChild(n),a.appendChild(document.createTextNode(p)),t.horizontal||a.appendChild(document.createElement("br")),t.disabled&&(n.disabled=!0)}),this._postInstantiateInit(t),this.setChildState=apogeeapp.ui.ConfigurableElement.setChildStateArrayValue}getValue(){return this.checkboxList.filter(e=>e.checked).map(e=>e.value)}setValue(e){this.checkboxList.forEach(t=>t.checked=e.indexOf(t.value)>=0),this.checkChildSelection(e)}addOnChange(e){var t=()=>{e(this.getValue(),this.getForm())};this.checkboxList.forEach(e=>e.addEventListener("change",t))}_setDisabled(e){this.checkboxList.forEach(t=>t.disabled=e)}},apogeeapp.ui.CheckboxGroupElement.TYPE_NAME="checkboxGroup",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.CheckboxGroupElement),apogeeapp.ui.RadioGroupElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();t.label?(this.labelElement=document.createElement("span"),this.labelElement.className="apogee_configurablePanelLabel",this.labelElement.innerHTML=t.label,a.appendChild(this.labelElement),t.horizontal||a.appendChild(document.createElement("br"))):this.labelElement=null,this.buttonList=[];var p=t.groupName;t.entries.forEach(e=>{var o,n,i=apogeeapp.ui.createElement("input");i.type="radio",i.name=p,"Array"==apogee.util.getObjectType(e)?(o=e[0],n=e[1]):(o=e,n=e),i.value=n,this.buttonList.push(i),a.appendChild(i),a.appendChild(document.createTextNode(o)),t.horizontal||a.appendChild(document.createElement("br"))}),this._postInstantiateInit(t),this.setChildState=apogeeapp.ui.ConfigurableElement.setChildStateSingleValue}getValue(){var e=this.buttonList.find(e=>e.checked);return e?e.value:void 0}setValue(e){var t=this.buttonList.find(t=>t.value==e);t&&(t.checked=!0),this.checkChildSelection(e)}addOnChange(e){var t=()=>{e(this.getValue(),this.getForm())};this.buttonList.forEach(e=>e.addEventListener("change",t))}_setDisabled(e){this.buttonList.forEach(t=>t.disabled=e)}},apogeeapp.ui.RadioGroupElement.TYPE_NAME="radioButtonGroup",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.RadioGroupElement),apogeeapp.ui.InvisibleElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t,apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_INVISIBLE),this._postInstantiateInit(t)}getValue(){return this.value}setValue(e){this.value=e}},apogeeapp.ui.InvisibleElement.TYPE_NAME="invisible",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.InvisibleElement),apogeeapp.ui.PanelElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t,apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_NO_MARGIN);var a=this.getElement();a.className="apogee_configurablePanelPanelLine";var p=t.formData;this.panel=new apogeeapp.ui.ConfigurablePanel,this.panel.configureForm(p);var o=this.panel.getElement();o.className="apogee_configurablePanelPanelLine",a.appendChild(o),this._postInstantiateInit(t)}getValue(){return this.panel.getValue()}setValue(e){this.panel.setValue(e)}addOnChange(e){this.panel.getChildEntries().forEach(t=>{t.addOnChange&&t.addOnChange(e)})}_setDisabled(e){this.panel.setDisabled(e)}},apogeeapp.ui.PanelElement.TYPE_NAME="panel",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.PanelElement),apogeeapp.ui.SubmitElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t);var a=this.getElement();if(this.submitDisabled=t.submitDisabled,this.cancelDisabled=t.cancelDisabled,t.onSubmit){var p;p=t.submitLabel?t.submitLabel:apogeeapp.ui.SubmitElement.DEFAULT_SUBMIT_LABEL,this.submitButton=apogeeapp.ui.createElement("button",{className:"apogee_configurablePanelButton",innerHTML:p,onclick:()=>{var a=e.getValue();t.onSubmit(a,e)}}),a.appendChild(this.submitButton)}else this.submitButton=null;if(t.onCancel){var o;o=t.cancelLabel?t.cancelLabel:apogeeapp.ui.SubmitElement.DEFAULT_CANCEL_LABEL,this.cancelButton=apogeeapp.ui.createElement("button",{className:"apogee_configurablePanelButton",innerHTML:o,onclick:()=>{t.onCancel(e)}}),a.appendChild(this.cancelButton)}else this.cancelButton=null;this._setButtonState(),this._postInstantiateInit(t)}submitDisable(e){this.submitDisabled=e,this._setButtonState()}cancelDisable(e){this.cancelDisabled=e,this._setButtonState()}_setDisabled(e){this.overallDisabled=e,this._setButtonState()}_setButtonState(){this.submitButton&&(this.submitButton.disabled=this.overallDisabled||this.submitDisabled),this.cancelButton&&(this.cancelButton.disabled=this.overallDisabled||this.cancelDisabled)}},apogeeapp.ui.SubmitElement.DEFAULT_SUBMIT_LABEL="OK",apogeeapp.ui.SubmitElement.DEFAULT_CANCEL_LABEL="Cancel",apogeeapp.ui.SubmitElement.TYPE_NAME="submit",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.SubmitElement),apogeeapp.ui.SpacerElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t,apogeeapp.ui.ConfigurableElement.CONTAINER_CLASS_NO_MARGIN);var a,p=this.getElement();this.spacerElement=document.createElement("div"),a=void 0!==t.height?t.height:apogeeapp.ui.SpacerElement.DEFAULT_HEIGHT,this.spacerElement.style.height=a+"px",p.appendChild(this.spacerElement),this._postInstantiateInit(t)}},apogeeapp.ui.SpacerElement.DEFAULT_HEIGHT=15,apogeeapp.ui.SpacerElement.TYPE_NAME="spacer",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.SpacerElement),apogeeapp.ui.HTMLDisplayElement=class extends apogeeapp.ui.ConfigurableElement{constructor(e,t){super(e,t),this.getElement().innerHTML=t.html}updateData(e){}},apogeeapp.ui.HTMLDisplayElement.TYPE_NAME="htmlDisplay",apogeeapp.ui.ConfigurablePanel.addConfigurableElement(apogeeapp.ui.HTMLDisplayElement),apogeeapp.app={},apogeeapp.app.dialog={},apogeeapp.app.Apogee=function(e){if(apogee.EventManager.init.call(this),null!=apogeeapp.app.Apogee.instance)throw new Error("Error: There is already an Apogee app instance - apogeeapp.app.Apogee is a singleton.");apogeeapp.app.Apogee.instance=this,this.workspaceUI=null,this.componentGenerators={},this.standardComponents=[],this.additionalComponents=[],this.loadComponentGenerators(),void 0!==e&&this.createUI(e);var t=apogee.util.readQueryField("url",document.URL);t&&apogeeapp.app.openworkspace.openWorkspaceFromUrl(this,t)},apogee.base.mixin(apogeeapp.app.Apogee,apogee.EventManager),apogeeapp.app.Apogee.DEFAULT_WORKSPACE_NAME="workspace",apogeeapp.app.Apogee.instance=null,apogeeapp.app.Apogee.createApp=function(e){return new apogeeapp.app.Apogee(e)},apogeeapp.app.Apogee.getInstance=function(){return apogeeapp.app.Apogee.instance},apogeeapp.app.Apogee.prototype.getWorkspaceUI=function(){return this.workspaceUI},apogeeapp.app.Apogee.prototype.getWorkspace=function(){return this.workspaceUI?this.workspaceUI.getWorkspace():null},apogeeapp.app.Apogee.prototype.getWorkspaceIsDirty=function(){var e=this.getWorkspace();return!!e&&e.getIsDirty()},apogeeapp.app.Apogee.prototype.clearWorkspaceIsDirty=function(){var e=this.getWorkspace();e&&e.clearIsDirty()},apogeeapp.app.Apogee.prototype.setWorkspaceUI=function(e){if(this.workspaceUI)throw apogee.base.createError("There is already an open workspace",!1);return e.setApp(this,this.tabFrame,this.treePane),this.workspaceUI=e,!0},apogeeapp.app.Apogee.prototype.clearWorkspaceUI=function(){return this.workspaceUI=null,!0},apogeeapp.app.Apogee.prototype.registerComponent=function(e){var t=e.uniqueName;this.componentGenerators[t]=e,this.additionalComponents.indexOf(t)<0&&this.additionalComponents.push(t)},apogeeapp.app.Apogee.prototype.getComponentGenerator=function(e){return this.componentGenerators[e]},apogeeapp.app.Apogee.prototype.loadComponentGenerators=function(){this.registerStandardComponent(apogeeapp.app.JsonTableComponent),this.registerStandardComponent(apogeeapp.app.FolderComponent),this.registerStandardComponent(apogeeapp.app.FunctionComponent),this.registerStandardComponent(apogeeapp.app.FolderFunctionComponent),this.registerStandardComponent(apogeeapp.app.DynamicForm),this.registerStandardComponent(apogeeapp.app.FormDataComponent),this.registerComponent(apogeeapp.app.CustomComponent),this.registerComponent(apogeeapp.app.CustomDataComponent),this.registerComponent(apogeeapp.app.JavascriptComponent),this.registerComponent(apogeeapp.app.GridTableComponent),this.registerComponent(apogeeapp.app.TextComponent),this.registerComponent(apogeeapp.app.CustomControlComponent)},apogeeapp.app.Apogee.prototype.registerStandardComponent=function(e){var t=e.uniqueName;if(this.componentGenerators[t]&&!confirm("There is already a registered component with this name. Would you like to continue?"))return;this.componentGenerators[t]=e,this.standardComponents.indexOf(t)<0&&this.standardComponents.push(t)},apogeeapp.app.Apogee.prototype.createUI=function(e){var t=apogeeapp.ui.initWindows(e).baseElement,a=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null);t.appendChild(a.getOuterElement());var p=this.createMenuBar();a.getHeader().appendChild(p);var o=new apogeeapp.ui.SplitPane(apogeeapp.ui.SplitPane.SCROLLING_PANE,apogeeapp.ui.SplitPane.FIXED_PANE);a.getBody().appendChild(o.getOuterElement()),this.treePane=o.getLeftPaneContainer(),this.tabFrame=new apogeeapp.ui.TabFrame,o.getRightPaneContainer().appendChild(this.tabFrame.getElement());var n=this;this.tabFrame.addListener(apogeeapp.ui.SHOWN_EVENT,function(e){n.onTabShown(e)}),this.tabFrame.addListener(apogeeapp.ui.HIDDEN_EVENT,function(e){n.onTabHidden(e)})},apogeeapp.app.Apogee.prototype.onTabHidden=function(e){this.activeTabIconDisplay.style.display="none",this.activeTabTitleDisplay.style.display="none"},apogeeapp.app.Apogee.prototype.onTabShown=function(e){if(this.workspaceUI){var t=e.getId(),a=this.workspaceUI.getComponentById(t);a&&(this.activeTabIconDisplay.src=a.getIconUrl(),this.activeTabTitleDisplay.innerHTML=a.getMember().getDisplayName(!0),this.activeTabIconDisplay.style.display="",this.activeTabTitleDisplay.style.display="")}},apogeeapp.app.Apogee.prototype.createMenuBar=function(){var e,t,a={},p=apogeeapp.ui.createElementWithClass("div","menu_bar"),o=apogeeapp.ui.createElementWithClass("div","menu_bar_left",p),n=apogeeapp.ui.createElementWithClass("div","menu_bar_right",p);t="Workspace",e=apogeeapp.ui.Menu.createMenu(t),o.appendChild(e.getElement()),a[t]=e;var i=apogeeapp.app.createworkspace.getCreateCallback(this);e.addCallbackMenuItem("New",i);var r=apogeeapp.app.openworkspace.getOpenCallback(this);e.addCallbackMenuItem("Open",r);var s=apogeeapp.app.saveworkspace.getSaveCallback(this);e.addCallbackMenuItem("Save",s);var l=apogeeapp.app.closeworkspace.getCloseCallback(this);e.addCallbackMenuItem("Close",l),t="Components",e=apogeeapp.ui.Menu.createMenu(t),o.appendChild(e.getElement()),a[t]=e,e.setMenuItems(this.getAddChildMenuItems()),t="Import/Export",e=apogeeapp.ui.Menu.createMenu(t),o.appendChild(e.getElement()),a[t]=e;var d=apogeeapp.app.importworkspace.getImportCallback(this,apogeeapp.app.FolderComponent);e.addCallbackMenuItem("Import as Folder",d);var u=apogeeapp.app.importworkspace.getImportCallback(this,apogeeapp.app.FolderFunctionComponent);e.addCallbackMenuItem("Import as Folder Function",u);var g=apogeeapp.app.exportworkspace.getExportCallback(this);return e.addCallbackMenuItem("Export as Workspace",g),this.addToMenuBar&&this.addToMenuBar(p,a),this.activeTabIconDisplay=apogeeapp.ui.createElementWithClass("img","tab-icon-display",n),this.activeTabIconDisplay.style.display="none",this.activeTabTitleDisplay=apogeeapp.ui.createElementWithClass("div","tab-title-display",n),this.activeTabTitleDisplay.style.display="none",p},apogeeapp.app.Apogee.prototype.getAddChildMenuItems=function(e,t){for(var a,p=[],o=0;o<this.standardComponents.length;o++){var n=this.standardComponents[o],i=this.componentGenerators[n];(a={}).title="Add "+i.displayName,a.callback=apogeeapp.app.addcomponent.getAddComponentCallback(this,i,e,t),p.push(a)}return(a={}).title="Other Components...",a.callback=apogeeapp.app.addcomponent.getAddAdditionalComponentCallback(this,e,t),p.push(a),p},apogeeapp.app.WorkspaceUI=function(){this.workspace=null,this.app=null,this.tabFrame=null,this.tree=null,this.treeEntry=null,this.componentMap={},this.referencesManager=new apogeeapp.app.ReferenceManager},apogeeapp.app.WorkspaceUI.ICON_RES_PATH="/componentIcons/workspace.png",apogeeapp.app.WorkspaceUI.prototype.setApp=function(e,t,a){this.app=e,this.tabFrame=t,a&&(this.tree=new apogeeapp.ui.treecontrol.TreeControl,apogeeapp.ui.removeAllChildren(a),a.appendChild(this.tree.getElement())),this.treeEntry=null},apogeeapp.app.WorkspaceUI.prototype.getApp=function(){return this.app},apogeeapp.app.WorkspaceUI.prototype.load=function(e,t){var a,p;e?(a=e.workspace,p=e.components):(a=void 0,p=apogeeapp.app.FolderComponent.EMPTY_FOLDER_COMPONENT_JSON),this.workspace=new apogee.Workspace(a,t);var o=this.workspace.getRoot(),n=this.loadComponentFromJson(o,p);if(this.tree&&(this.treeEntry=this.createTreeEntry(),this.treeEntry.setState(apogeeapp.ui.treecontrol.EXPANDED),this.tree.setRootEntry(this.treeEntry),this.treeEntry.addChild(n.getTreeEntry(!0)),this.treeEntry.addChild(this.referencesManager.getTreeEntry(!0))),this.workspace.addListener(apogee.updatemember.MEMBER_UPDATED_EVENT,e=>this.memberUpdated(e)),this.workspace.addListener(apogee.deletemember.MEMBER_DELETED_EVENT,e=>this.childDeleted(e)),this.workspace.addListener(apogee.updateworkspace.WORKSPACE_UPDATED_EVENT,()=>this.workspaceUpdated()),e&&e.activeTabMember&&this.tabFrame){var i=this.workspace.getMemberByFullName(e.activeTabMember);i&&this.tabFrame.setActiveTab(i.getId())}},apogeeapp.app.WorkspaceUI.prototype.getWorkspace=function(){return this.workspace},apogeeapp.app.WorkspaceUI.prototype.getTabFrame=function(){return this.tabFrame},apogeeapp.app.WorkspaceUI.prototype.close=function(){for(var e in this.componentMap){var t=this.componentMap[e];t&&t.component&&!t.componentMember&&t.component.onDelete()}this.tree&&this.tree.clearRootEntry(),this.referencesManager.close()},apogeeapp.app.WorkspaceUI.prototype.getComponent=function(e){var t=this.componentMap[e.getId()];return t?t.component:null},apogeeapp.app.WorkspaceUI.prototype.getComponentById=function(e){var t=this.componentMap[e];return t?t.component:null},apogeeapp.app.WorkspaceUI.prototype.getFolders=function(){var e={};for(var t in this.componentMap){var a=this.componentMap[t].member;a.isParent&&a.getChildrenWriteable()&&(e[a.getFullName()]=a)}return e},apogeeapp.app.WorkspaceUI.prototype.registerMember=function(e,t,a){if(e.getWorkspace()!==this.workspace)throw apogee.base.createError("Component registered in wrong workspace: "+e.getFullName());var p=e.getId();if(this.componentMap[p])throw apogee.base.createError("There is already a member with the given ID.",!0);var o={};o.member=e,o.component=t,a&&(o.componentMember=a),this.componentMap[p]=o},apogeeapp.app.WorkspaceUI.prototype.memberUpdated=function(e){var t=e.getId(),a=this.componentMap[t];a&&a.component&&a.component.memberUpdated()},apogeeapp.app.WorkspaceUI.prototype.childDeleted=function(e){var t=e.getId(),a=this.componentMap[t];delete this.componentMap[t],a&&a.component&&a.component.onDelete()},apogeeapp.app.WorkspaceUI.prototype.workspaceUpdated=function(){this.treeEntry&&this.treeEntry.setLabel(this.workspace.getName())},apogeeapp.app.WorkspaceUI.prototype.toJson=function(e){var t,a={};a.fileType="apogee app js workspace",a.version="0.40",a.references=this.referencesManager.saveEntries(),a.workspace=this.workspace.toJson(e),t=e||this.workspace.getRoot();var p=this.getComponent(t);if(a.components=p.toJson(),this.tabFrame){var o=this.tabFrame.getActiveTab();o&&(a.activeTabMember=this.getMemberNameFromId(o))}return a},apogeeapp.app.WorkspaceUI.prototype.getMemberNameFromId=function(e){var t=this.getComponentById(e);if(t){var a=t.getMember();if(a)return a.getFullName()}},apogeeapp.app.WorkspaceUI.prototype.getFolderComponentContentJson=function(e){var t={},a=e.getChildMap();for(var p in a){var o=a[p],n=this.getComponent(o);t[o.getName()]=n.toJson()}return t},apogeeapp.app.WorkspaceUI.prototype.loadComponentFromJson=function(e,t){var a=t.type,p=this.app.getComponentGenerator(a);return p&&e.constructor!=apogee.ErrorTable||(p=apogeeapp.app.ErrorTableComponent),apogeeapp.app.Component.createComponentFromMember(p,this,e,null,t)},apogeeapp.app.WorkspaceUI.prototype.loadFolderComponentContentFromJson=function(e,t){for(var a in t){var p=t[a],o=e.lookupChild(a);this.loadComponentFromJson(o,p)}},apogeeapp.app.WorkspaceUI.prototype.createTreeEntry=function(){var e=this.workspace.getName(),t=this.getIconUrl();return new apogeeapp.ui.treecontrol.TreeEntry(e,t,null,()=>this.getMenuItems(),!0)},apogeeapp.app.WorkspaceUI.prototype.getIconUrl=function(){return apogeeapp.ui.getResourcePath(apogeeapp.app.WorkspaceUI.ICON_RES_PATH)},apogeeapp.app.WorkspaceUI.prototype.getMenuItems=function(){var e=[],t={title:"Edit Properties"};return t.callback=apogeeapp.app.updateworkspace.getUpdateWorkspaceCallback(this),e.push(t),(t={}).title="Print Dependencies",t.callback=(()=>this.showDependencies()),e.push(t),e},apogeeapp.app.WorkspaceUI.prototype.loadReferences=function(e){return this.referencesManager.openEntries(e)},apogeeapp.app.WorkspaceUI.prototype.showDependencies=function(){console.log(JSON.stringify(this.createDependencies()))},apogeeapp.app.WorkspaceUI.prototype.createDependencies=function(){var e=[];for(var t in this.componentMap){var a=this.componentMap[t];if(a&&a.member&&a.member.isCodeable){var p=a.member,o={};o.member=p.getFullName(),o.memberType=p.generator.type,p.isDependent&&p.getDependsOn().length>0&&(o.dependsOn=p.getDependsOn().map(e=>e.getFullName())),e.push(o)}}return e},apogeeapp.app.ReferenceManager=function(){this.referencesTreeEntry=null,this.state=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NORMAL,this.referenceLists={};var e=apogeeapp.app.LinkEntry.JS_LINK_LIST_INFO,t=apogeeapp.app.LinkEntry.CSS_LINK_LIST_INFO;this.referenceLists[e.typeName]=this.getListStruct(e),this.referenceLists[t.typeName]=this.getListStruct(t)},apogeeapp.app.ReferenceManager.prototype.getTreeEntry=function(e){return e&&!this.referencesTreeEntry&&(this.referencesTreeEntry=this.instantiateTreeEntry()),this.referencesTreeEntry},apogeeapp.app.ReferenceManager.prototype.openEntries=function(e){var t=[];return e.forEach(e=>{var a=this.referenceLists[e.entryType];if(!a.listEntries.some(t=>t.url==e.url)){var p=a.listInfo.createEntryFunction(this,e).loadEntry();t.push(p)}}),Promise.all(t)},apogeeapp.app.ReferenceManager.prototype.saveEntries=function(){var e=[],t=t=>{var a=t.saveEntry();e.push(a)};for(var a in this.referenceLists){this.referenceLists[a].listEntries.forEach(t)}return e},apogeeapp.app.ReferenceManager.prototype.addEntry=function(e){return this.referenceLists[e.entryType].listInfo.createEntryFunction(this,e).loadEntry()},apogeeapp.app.ReferenceManager.prototype.close=function(){for(var e in this.referenceLists){this.referenceLists[e].listEntries.forEach(e=>e.remove())}},apogeeapp.app.ReferenceManager.prototype.entryInserted=function(e){var t=e.getEntryType(),a=this.referenceLists[t];if(!a)throw new Error("Unrecognized link type: "+t);if(a.listEntries.push(e),a.treeEntry){var p=e.getTreeEntry(!0);a.treeEntry.addChild(p)}},apogeeapp.app.ReferenceManager.prototype.entryStatusChange=function(e){this.processReferenceState()},apogeeapp.app.ReferenceManager.prototype.entryRemoved=function(e){var t=e.getEntryType(),a=this.referenceLists[t];if(!a)throw new Error("Unrecognized link type: "+t);a.listEntries=a.listEntries.filter(t=>t!=e),a.treeEntry.removeChild(e.getTreeEntry())},apogeeapp.app.ReferenceManager.REFERENCES_ICON_PATH="/componentIcons/references.png",apogeeapp.app.ReferenceManager.prototype.getListStruct=function(e){var t={};return t.listInfo=e,t.listEntries=[],t.treeEntry=null,t.state=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NORMAL,t},apogeeapp.app.ReferenceManager.prototype.instantiateTreeEntry=function(){var e=apogeeapp.ui.getResourcePath(apogeeapp.app.ReferenceManager.REFERENCES_ICON_PATH),t=new apogeeapp.ui.treecontrol.TreeEntry("References",e,null,null,!1);for(var a in this.referenceLists){var p=this.referenceLists[a];this.addListTreeEntry(t,p)}return apogeeapp.app.ReferenceManager.applyBannerState(t,this.state),t},apogeeapp.app.ReferenceManager.prototype.addListTreeEntry=function(e,t){var a=t.listInfo,p=apogeeapp.ui.getResourcePath(a.listIconPath),o=new apogeeapp.ui.treecontrol.TreeEntry(a.listName,p,null,()=>this.getListMenuItems(a),!1);for(var n in t.listEntries){var i=t.listEntries[n].getTreeEntry(!0);o.addChild(i)}apogeeapp.app.ReferenceManager.applyBannerState(o,t.state),t.treeEntry=o,e.addChild(o)},apogeeapp.app.ReferenceManager.prototype.getListMenuItems=function(e){var t=[],a={};return a.title=e.addEntryText,a.callback=(()=>e.addEntry(this)),t.push(a),t},apogeeapp.app.ReferenceManager.prototype.processReferenceState=function(){var e,t=!1,a=!1;for(var p in this.referenceLists){var o=this.referenceLists[p],n=this.getListState(o);n==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?t=!0:n==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING&&(a=!0)}e=t?apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR:a?apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING:apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NORMAL,this.state!=e&&(this.state=e,this.referencesTreeEntry&&apogeeapp.app.ReferenceManager.applyBannerState(this.referencesTreeEntry,e))},apogeeapp.app.ReferenceManager.prototype.getListState=function(e){var t,a=!1,p=!1;return e.listEntries.forEach(e=>{var t=e.getState();t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?a=!0:t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING&&(p=!0)}),(t=a?apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR:p?apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING:apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NORMAL)!=e.state&&(e.state=t,e.treeEntry&&apogeeapp.app.ReferenceManager.applyBannerState(e.treeEntry,t)),t},apogeeapp.app.ReferenceManager.nextId=1,apogeeapp.app.ReferenceManager._createId=function(){return apogeeapp.app.ReferenceManager.nextId++},apogeeapp.app.ReferenceManager.applyBannerState=function(e,t){var a=apogeeapp.app.WindowHeaderManager.getIconOverlay(t);a?e.setIconOverlay(a):e.clearIconOverlay()},apogeeapp.app.LinkEntry=function(e,t,a){this.id=apogeeapp.app.ReferenceManager._createId(),this.referenceManager=e,this.linkType=a,this.url=t.url,this.state=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE;var p=t.nickname;p&&0!==p.length||(p=this.createLinkNameFromUrl(this.url)),this.nickname=p,this.treeEntry=null},apogeeapp.app.LinkEntry.LINK_TYPE_JS="js link",apogeeapp.app.LinkEntry.LINK_TYPE_CSS="css link",apogeeapp.app.LinkEntry.JS_ELEMENT_TYPE="script",apogeeapp.app.LinkEntry.CSS_ELEMENT_TYPE="link",apogeeapp.app.LinkEntry.JS_ICON_RES_PATH="/componentIcons/javascriptLink.png",apogeeapp.app.LinkEntry.CSS_ICON_RES_PATH="/componentIcons/cssLink.png",apogeeapp.app.LinkEntry.JS_LINK_LIST_INFO={typeName:apogeeapp.app.LinkEntry.LINK_TYPE_JS,addEntry:e=>{apogeeapp.app.updatelink.getAddLinkCallback(e,apogeeapp.app.LinkEntry.LINK_TYPE_JS)()},createEntryFunction:(e,t)=>new apogeeapp.app.LinkEntry(e,t,apogeeapp.app.LinkEntry.LINK_TYPE_JS),listName:"JS Links",addEntryText:"Add JS Link",listIconPath:"/componentIcons/folder.png"},apogeeapp.app.LinkEntry.CSS_LINK_LIST_INFO={typeName:apogeeapp.app.LinkEntry.LINK_TYPE_CSS,addEntry:e=>{apogeeapp.app.updatelink.getAddLinkCallback(e,apogeeapp.app.LinkEntry.LINK_TYPE_CSS)()},createEntryFunction:(e,t)=>new apogeeapp.app.LinkEntry(e,t,apogeeapp.app.LinkEntry.LINK_TYPE_CSS),listName:"CSS Links",addEntryText:"Add CSS Link",listIconPath:"/componentIcons/folder.png"},apogeeapp.app.LinkEntry.prototype.getId=function(){return this.id},apogeeapp.app.LinkEntry.prototype.getEntryType=function(){return this.linkType},apogeeapp.app.LinkEntry.prototype.getState=function(){return this.state},apogeeapp.app.LinkEntry.prototype.getTreeEntry=function(e){return e&&!this.treeEntry&&(this.treeEntry=this.instantiateTreeEntry()),this.treeEntry},apogeeapp.app.LinkEntry.prototype.getUrl=function(){return this.url},apogeeapp.app.LinkEntry.prototype.getNickname=function(){return this.nickname},apogeeapp.app.LinkEntry.prototype.loadEntry=function(){return this.referenceManager.entryInserted(this),new Promise((e,t)=>{var a,p;if(this.linkType==apogeeapp.app.LinkEntry.LINK_TYPE_JS)a=this.getJsLinkProps(),p=apogeeapp.app.LinkEntry.JS_ELEMENT_TYPE;else{if(this.linkType!=apogeeapp.app.LinkEntry.LINK_TYPE_CSS){var o="Unknown link type "+this.linkType;return this.setError(o),void t(o)}a=this.getCssLinkProps(),p=apogeeapp.app.LinkEntry.CSS_ELEMENT_TYPE}a.onload=(()=>{this.setClearState(),e(this.url)}),a.onerror=(e=>{var a="Failed to load link '"+this.url+"'";this.setError(a),t(a)}),this.setPendingState(),element=apogeeapp.ui.createElement(p,a),document.head.appendChild(element)})},apogeeapp.app.LinkEntry.prototype.saveEntry=function(){var e={};return e.url=this.url,this.nickname!=this.url&&(e.nickname=this.nickname),e.entryType=this.linkType,e},apogeeapp.app.LinkEntry.prototype.remove=function(){var e=document.getElementById(this.getElementId());e&&document.head.removeChild(e),this.referenceManager.entryRemoved(this)},apogeeapp.app.LinkEntry.prototype.updateData=function(e,t){if(this.treeEntry&&(t&&0!==t.length||(t=this.createLinkNameFromUrl(e)),this.nickname!=t&&(this.nickname=t,this.treeEntry.setLabel(this.nickname))),this.url!=e){this.url=e,this.remove();var a=this.loadEntry()}return a||(a=Promise.resolve("No url update")),a},apogeeapp.app.LinkEntry.prototype.createLinkNameFromUrl=function(e){return e},apogeeapp.app.LinkEntry.prototype.getJsLinkProps=function(){var e={};return e.id=this.getElementId(),e.src=this.url,e},apogeeapp.app.LinkEntry.prototype.getCssLinkProps=function(){var e={};return e.id=this.getElementId(),e.rel="stylesheet",e.type="text/css",e.href=this.url,e},apogeeapp.app.LinkEntry.ELEMENT_ID_BASE="__apogee_link_element_",apogeeapp.app.LinkEntry.prototype.getElementId=function(){return apogeeapp.app.LinkEntry.ELEMENT_ID_BASE+this.id},apogeeapp.app.LinkEntry.prototype.setClearState=function(){this.setState(apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE)},apogeeapp.app.LinkEntry.prototype.setError=function(e){this.setState(apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR,e)},apogeeapp.app.LinkEntry.prototype.setPendingState=function(){this.setState(apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING,"loading")},apogeeapp.app.LinkEntry.prototype.setState=function(e,t){this.state=e,this.treeEntry&&apogeeapp.app.ReferenceManager.applyBannerState(this.treeEntry,this.state),this.referenceManager.entryStatusChange(this)},apogeeapp.app.LinkEntry.prototype.instantiateTreeEntry=function(){var e=this.getIconUrl(),t=new apogeeapp.ui.treecontrol.TreeEntry(this.nickname,e,null,()=>this.getMenuItems(),!1);return apogeeapp.app.ReferenceManager.applyBannerState(t,this.state),t},apogeeapp.app.LinkEntry.prototype.getIconUrl=function(){var e;return e=this.linkType==apogeeapp.app.LinkEntry.LINK_TYPE_JS?apogeeapp.app.LinkEntry.JS_ICON_RES_PATH:this.linkType==apogeeapp.app.LinkEntry.LINK_TYPE_CSS?apogeeapp.app.LinkEntry.CSS_ICON_RES_PATH:apogeeapp.app.Component.DEFAULT_ICON_RES_PATH,apogeeapp.ui.getResourcePath(e)},apogeeapp.app.LinkEntry.prototype.getMenuItems=function(){var e,t=[];return(e={title:"Update Link"}).callback=apogeeapp.app.updatelink.getUpdateLinkCallback(this),t.push(e),(e={title:"Remove Link"}).callback=apogeeapp.app.updatelink.getRemoveLinkCallback(this),t.push(e),t},apogeeapp.app.WindowHeaderManager=function(){this.toolbarDiv=null,this.toolbarActive=!1,this.bannerDiv=null,this.bannerBarActive=!1,this.headerContainer=document.createElement("div")},apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR="error",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_ERROR="red",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_ERROR="white",apogeeapp.app.WindowHeaderManager.ERROR_ICON_IMAGE="/error.png",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING="pending",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_PENDING="yellow",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_PENDING="black",apogeeapp.app.WindowHeaderManager.PENDING_ICON_IMAGE="/pending.png",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_INVALID="invalid",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_INVALID="gray",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_INVALID="white",apogeeapp.app.WindowHeaderManager.INVALID_ICON_IMAGE="/invalid.png",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_UNKNOWN="yellow",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_UNKNOWN="black",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE="none",apogeeapp.app.WindowHeaderManager.PENDING_MESSAGE="Calculation pending...",apogeeapp.app.WindowHeaderManager.INVALID_MESSAGE="Result not valid!",apogeeapp.app.WindowHeaderManager.prototype.showBannerBar=function(e,t){var a,p;this.bannerDiv||(this.bannerDiv=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",backgroundColor:a,color:p})),t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_INVALID?(a=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_INVALID,p=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_INVALID):t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?(a=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_ERROR,p=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_ERROR):t==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING?(a=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_PENDING,p=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_PENDING):(a=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_UNKNOWN,p=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_UNKNOWN);var o={};o.backgroundColor=a,o.color=p,apogeeapp.ui.applyStyle(this.bannerDiv,o),this.bannerDiv.innerHTML=e,this.bannerBarActive=!0,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.hideBannerBar=function(){this.bannerBarActive=!1,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.showToolbar=function(e){this.toolbarActive=!0,this.toolbarDiv=e,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.hideToolbar=function(){this.toolbarActive=!1,this.toolbarDiv=null,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.updateHeaderElement=function(){var e=[];if(this.toolbarActive&&this.toolbarDiv&&e.push(this.toolbarDiv),this.saveBarActive&&this.saveDiv&&e.push(this.saveDiv),this.bannerBarActive&&this.bannerDiv&&e.push(this.bannerDiv),apogeeapp.ui.removeAllChildren(this.headerContainer),e.length>0)for(var t=0;t<e.length;t++)this.headerContainer.appendChild(e[t])},apogeeapp.app.WindowHeaderManager.prototype.getHeaderElement=function(){return this.headerContainer},apogeeapp.app.WindowHeaderManager.getIconOverlay=function(e){var t;if(e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_INVALID?t=apogeeapp.app.WindowHeaderManager.INVALID_ICON_IMAGE:e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?t=apogeeapp.app.WindowHeaderManager.ERROR_ICON_IMAGE:e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING&&(t=apogeeapp.app.WindowHeaderManager.PENDING_ICON_IMAGE),!t)return null;var a=apogeeapp.ui.getResourcePath(t),p=document.createElement("img");return p.src=a,p},apogeeapp.app.Component=function(e,t,a){this.workspaceUI=e,this.member=t,this.uiActiveParent=null,this.componentGenerator=a,this.workspaceUI.registerMember(this.member,this),this.openActions=[],this.saveActions=[],this.cleanupActions=[],this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE,this.bannerMessage="",this.windowDisplay=null,this.windowDisplayStateJson=null,this.tabDisplay=null,this.treeDisplay=null},apogeeapp.app.Component.DEFAULT_COMPONENT_TYPE_SORT_ORDER=5,apogeeapp.app.Component.FOLDER_COMPONENT_TYPE_SORT_ORDER=0,apogeeapp.app.Component.prototype.addOpenAction=function(e){this.openActions.push(e)},apogeeapp.app.Component.prototype.addSaveAction=function(e){this.saveActions.push(e)},apogeeapp.app.Component.prototype.addCleanupAction=function(e){this.cleanupActions.push(e)},apogeeapp.app.Component.DEFAULT_ICON_RES_PATH="/genericIcon.png",apogeeapp.app.Component.MENU_ITEM_OPEN=1,apogeeapp.app.Component.prototype.getMember=function(){return this.member},apogeeapp.app.Component.prototype.getIconUrl=function(){if(this.componentGenerator.ICON_URL)return this.componentGenerator.ICON_URL;var e=this.componentGenerator.ICON_RES_PATH;return e||(e=apogeeapp.app.Component.DEFAULT_ICON_RES_PATH),apogeeapp.ui.getResourcePath(e)},apogeeapp.app.Component.prototype.getWorkspace=function(){return this.member.getWorkspace()},apogeeapp.app.Component.prototype.getWorkspaceUI=function(){return this.workspaceUI},apogeeapp.app.Component.prototype.getTreeEntry=function(e){return e&&!this.treeDisplay&&(this.treeDisplay=this.instantiateTreeEntry(),this.treeDisplay.setBannerState(this.bannerState,this.bannerMessage),this.options&&void 0!==this.options.treeState&&this.treeDisplay.setState(this.options.treeState)),this.treeDisplay?this.treeDisplay.getTreeEntry():null},apogeeapp.app.Component.prototype.instantiateTreeEntry=function(){var e=new apogeeapp.app.TreeComponentDisplay(this),t=void 0!==this.componentGenerator.TREE_ENTRY_SORT_ORDER?this.componentGenerator.TREE_ENTRY_SORT_ORDER:apogeeapp.app.Component.DEFAULT_COMPONENT_TYPE_SORT_ORDER;return e.setComponentTypeSortOrder(t),e},apogeeapp.app.Component.prototype.getWindowDisplay=function(e,t){return e&&!this.windowDisplay&&(this.windowDisplay=this.instantiateWindowDisplay(t),this.windowDisplay.setBannerState(this.bannerState,this.bannerMessage)),this.windowDisplay},apogeeapp.app.Component.prototype.closeWindowDisplay=function(){this.windowDisplay&&(this.windowDisplayStateJson=this.windowDisplay.getStateJson(),this.windowDisplay.deleteDisplay(),this.windowDisplay=null)},apogeeapp.app.Component.prototype.getMenuItems=function(e){var t,a=e||[];return(t={title:"Edit Properties"}).callback=apogeeapp.app.updatecomponent.getUpdateComponentCallback(this),a.push(t),(t={title:"Delete"}).callback=this.createDeleteCallback(t.title),a.push(t),a},apogeeapp.app.Component.prototype.getOpenMenuItem=function(){var e=this.createOpenCallback();if(e){var t={title:"Open"};return t.callback=e,t}return null},apogeeapp.app.Component.prototype.getTabDisplay=function(e){return e&&this.usesTabDisplay()&&!this.tabDisplay&&(this.tabDisplay=this.instantiateTabDisplay(),this.tabDisplay.setBannerState(this.bannerState,this.bannerMessage)),this.tabDisplay},apogeeapp.app.Component.prototype.closeTabDisplay=function(){this.tabDisplay&&(this.tabDisplay.closeTab(),this.tabDisplay=null)},apogeeapp.app.Component.prototype.toJson=function(){var e={};if(e.type=this.componentGenerator.uniqueName,null!=this.windowDisplay&&(this.windowDisplayStateJson=this.windowDisplay.getStateJson()),this.windowDisplayStateJson&&(e.windowState=this.windowDisplayStateJson),this.tabDisplay&&(e.tabOpen=!0),this.treeDisplay){var t=this.treeDisplay.getState();t!=apogeeapp.ui.treecontrol.NO_CONTROL&&(e.treeState=t)}for(var a=0;a<this.saveActions.length;a++)this.saveActions[a].call(this,e);return e},apogeeapp.app.Component.prototype.loadSerializedValues=function(e){if(e||(e={}),this.options=e,this.treeDisplay&&void 0!==e.treeState&&this.treeDisplay.setState(e.treeState),e.tabOpen&&this.usesTabDisplay()){var t=this.workspaceUI.getTabFrame();if(t){this.getTabDisplay(!0);var a=this.tabDisplay.getTab();t.addTab(a,!1)}}if(void 0!==e.windowState&&(this.windowDisplayStateJson=e.windowState),e)for(var p=0;p<this.openActions.length;p++)this.openActions[p].call(this,e)},apogeeapp.app.Component.prototype.onDelete=function(){if(this.uiActiveParent){var e=this.workspaceUI.getComponent(this.uiActiveParent);e&&e.removeChildComponent(this)}this.tabDisplay&&this.closeTabDisplay();for(var t=0;t<this.cleanupActions.length;t++)this.cleanupActions[t].call(this)},apogeeapp.app.Component.prototype.memberUpdated=function(){if(this.member.getParent()!==this.uiActiveParent){var e=this.uiActiveParent,t=this.member.getParent();if(this.uiActiveParent=t,e)this.workspaceUI.getComponent(e).removeChildComponent(this),this.windowDisplay&&(this.windowDisplay.deleteDisplay(),this.windowDisplay=null);if(t)this.workspaceUI.getComponent(t).addChildComponent(this)}var a=this.getMember();if(a.hasError()){for(var p="",o=a.getErrors(),n=0;n<o.length;n++)p+=o[n].msg+"\n";this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR,this.bannerMessage=p}else a.getResultPending()?(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING,this.bannerMessage=apogeeapp.app.WindowHeaderManager.PENDING_MESSAGE):a.getResultInvalid()?(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_INVALID,this.bannerMessage=apogeeapp.app.WindowHeaderManager.INVALID_MESSAGE):(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE,this.bannerMessage=null);this.treeDisplay&&(this.treeDisplay.updateData(),this.treeDisplay.setBannerState(this.bannerState,this.bannerMessage)),null!=this.windowDisplay&&(this.windowDisplay.updateData(),this.windowDisplay.setBannerState(this.bannerState,this.bannerMessage)),null!=this.tabDisplay&&(this.tabDisplay.updateData(),this.tabDisplay.setBannerState(this.bannerState,this.bannerMessage))},apogeeapp.app.Component.prototype.getPropertyValues=function(){var e=this.member,t={};t.name=e.getName();var a=e.getParent();return a&&(t.parentName=a.getFullName()),e.generator.addPropFunction&&e.generator.addPropFunction(e,t),this.componentGenerator.addPropFunction&&this.componentGenerator.addPropFunction(this,t),t},apogeeapp.app.Component.prototype.createOpenCallback=function(){var e=this,t=this.workspaceUI,a=function(e){if(a=e.getTabDisplay()){(p=a.getTab()).makeActive()}else{var a,p=(a=e.getTabDisplay(!0)).getTab();t.getTabFrame().addTab(p,!0)}};return this.usesTabDisplay()?function(){a(e)}:function(){var p=e.member.getParent();if(p){var o=t.getComponent(p);o&&o.usesTabDisplay()&&(a(o),o.showChildComponent(e))}}},apogeeapp.app.Component.prototype.createDeleteCallback=function(){var e=this.getMember();return function(){if(confirm("Are you sure you want to delete this object?")){var t={action:"deleteMember"};t.member=e;var a=apogee.action.doAction(t,!0);a.getSuccess()||apogeeapp.app.errorHandling.handleActionError(a)}}},apogeeapp.app.Component.createComponentFromMember=function(e,t,a,p,o){var n=new e(t,a);return o&&n.loadSerializedValues(o),p&&e.updateProperties&&e.updateProperties(n,null,p),n.memberUpdated(),n},apogeeapp.app.ParentComponent=function(e,t,a){apogeeapp.app.Component.call(this,e,t,a)},apogeeapp.app.ParentComponent.prototype=Object.create(apogeeapp.app.Component.prototype),apogeeapp.app.ParentComponent.prototype.constructor=apogeeapp.app.ParentComponent,apogeeapp.app.ParentComponent.prototype.instantiateWindowDisplay=function(e){var t=e||this.windowDisplayStateJson;return new apogeeapp.app.ParentWindowComponentDisplay(this,t)},apogeeapp.app.ParentComponent.prototype.instantiateTreeEntry=function(){var e=apogeeapp.app.Component.prototype.instantiateTreeEntry.call(this),t=e.getTreeEntry(),a=this.getMember().getChildMap();for(var p in a){var o=a[p],n=this.getWorkspaceUI().getComponent(o).getTreeEntry(!0);t.addChild(n)}return e},apogeeapp.app.ParentComponent.prototype.usesTabDisplay=function(){return!0},apogeeapp.app.ParentComponent.prototype.showChildComponent=function(e){e.getMember().getParent()==this.getMember()&&this.tabDisplay&&this.tabDisplay.showChildComponent(e)},apogeeapp.app.ParentComponent.prototype.getMenuItems=function(e){var t=e||[],a={},p=this.getWorkspaceUI().getApp(),o={};return o.parentName=this.member.getFullName(),a.title="Add Component...",a.childMenuItems=p.getAddChildMenuItems(o),t.push(a),t=apogeeapp.app.Component.prototype.getMenuItems.call(this,t)},apogeeapp.app.ParentComponent.prototype.isParentComponent=!0,apogeeapp.app.ParentComponent.prototype.removeChildComponent=function(e){var t=this.getTreeEntry();if(t){var a=e.getTreeEntry();a&&t.removeChild(a)}var p=e.getWindowDisplay();p&&p.deleteDisplay()},apogeeapp.app.ParentComponent.prototype.addChildComponent=function(e){var t=this.getTreeEntry();if(t){var a=e.getTreeEntry(!0);t.addChild(a)}this.tabDisplay&&this.tabDisplay.addChildComponent(e)},apogeeapp.app.EditComponent=function(e,t,a){apogeeapp.app.Component.call(this,e,t,a)},apogeeapp.app.EditComponent.prototype=Object.create(apogeeapp.app.Component.prototype),apogeeapp.app.EditComponent.prototype.constructor=apogeeapp.app.EditComponent,apogeeapp.app.EditComponent.prototype.instantiateWindowDisplay=function(e){var t=e||this.windowDisplayStateJson;return new apogeeapp.app.EditWindowComponentDisplay(this,t)},apogeeapp.app.EditComponent.prototype.usesTabDisplay=function(){return!1},apogeeapp.app.EditComponent.prototype.instantiateTabDisplay=function(){return null},apogeeapp.app.EditComponent.prototype.getMenuItems=function(e){var t=e||[];t=apogeeapp.app.Component.prototype.getMenuItems.call(this,t);if(this.member.isCodeable&&this.member.hasCode()){var a=this.getTableEditSettings();if(void 0!==a.clearFunctionMenuText){var p={};p.title=a.clearFunctionMenuText,p.callback=this.getClearFunctionCallback(a.emptyDataValue),t.push(p)}}return t},apogeeapp.app.EditComponent.prototype.getClearFunctionCallback=function(e){var t={};return t.member=this.member,t.data=e,t.action=apogee.updatemember.UPDATE_DATA_ACTION_NAME,function(){var e=apogee.action.doAction(t,!0);e.getSuccess()||apogeeapp.app.errorHandling.handleActionError(e)}},apogeeapp.app.TreeComponentDisplay=function(e){this.component=e,this.member=e.getMember(),this.treeEntry=this.createTreeEntry(),this.treeEntry.setSortFunction(apogeeapp.app.TreeComponentDisplay.treeSortFunction),this.treeEntry.setExtraSortParam(0)},apogeeapp.app.TreeComponentDisplay.prototype.getTreeEntry=function(){return this.treeEntry},apogeeapp.app.TreeComponentDisplay.prototype.getState=function(){return this.treeEntry.getState()},apogeeapp.app.TreeComponentDisplay.prototype.setState=function(e){this.treeEntry.setState(e)},apogeeapp.app.TreeComponentDisplay.prototype.setComponentTypeSortOrder=function(e){this.treeEntry.setExtraSortParam(e)},apogeeapp.app.TreeComponentDisplay.prototype.changeParent=function(e,t){t.getTreeEntry().removeChild(this.treeEntry),e.getTreeEntry().addChild(this.treeEntry)},apogeeapp.app.TreeComponentDisplay.prototype.deleteDisplay=function(){alert("Delete tree component display not implemneted")},apogeeapp.app.TreeComponentDisplay.prototype.setBannerState=function(e,t){var a=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);a?this.treeEntry.setIconOverlay(a):this.treeEntry.clearIconOverlay()},apogeeapp.app.TreeComponentDisplay.prototype.updateData=function(){this.treeEntry.setLabel(this.member.getName())},apogeeapp.app.TreeComponentDisplay.prototype.createTreeEntry=function(){var e=this,t=this.component.createOpenCallback(),a=this.member.getName(),p=this.component.getIconUrl(),o=this.member.isParent&&this.member.isRoot();return new apogeeapp.ui.treecontrol.TreeEntry(a,p,t,function(){var t=[],a=e.component.getOpenMenuItem();return a&&t.push(a),e.component.getMenuItems(t)},o)},apogeeapp.app.TreeComponentDisplay.treeSortFunction=function(e,t){var a=e.getExtraSortParam()-t.getExtraSortParam();return a||e.getLabel().localeCompare(t.getLabel())},apogeeapp.app.TabComponentDisplay=function(e,t,a){this.component=e,this.member=t,this.folder=a,this.loadTabEntry()},apogeeapp.app.TabComponentDisplay.prototype.getTab=function(){return this.tab},apogeeapp.app.TabComponentDisplay.prototype.closeTab=function(){this.tab&&(this.tab.close(),this.tab=null)},apogeeapp.app.TabComponentDisplay.prototype.setBannerState=function(e,t){if(e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE?this.windowHeaderManager.hideBannerBar():this.windowHeaderManager.showBannerBar(t,e),this.tab){var a=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);a?this.tab.setIconOverlay(a):this.tab.clearIconOverlay()}},apogeeapp.app.TabComponentDisplay.prototype.updateData=function(){this.tab.setTitle(this.member.getName())},apogeeapp.app.TabComponentDisplay.prototype.addChildComponent=function(e){var t=e.getWindowDisplay(!0),a=t.getDisplayFrame(),p=t.getPreferredPosition();p||(p=this.parentContainer.getNextWindowPosition()),a.setPosition(p.x,p.y),this.parentContainer.addWindow(a);var o=t.getPreferredState();a.setWindowState(o)},apogeeapp.app.TabComponentDisplay.prototype.showChildComponent=function(e){var t=e.getWindowDisplay();if(t){var a=t.getDisplayFrame();a&&this.parentContainer.bringToFront(a)}},apogeeapp.app.TabComponentDisplay.prototype.loadTabEntry=function(){this.tab=new apogeeapp.ui.Tab(this.member.getId()),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.tab.setHeaderContent(this.windowHeaderManager.getHeaderElement()),this.createDisplayContent(),this.tab.setContent(this.contentElement,apogeeapp.ui.FIXED_SIZE);this.tab.addListener(apogeeapp.ui.SHOWN_EVENT,function(){e.parentContainer.elementIsShown()});this.tab.addListener(apogeeapp.ui.HIDDEN_EVENT,function(){e.parentContainer.elementIsHidden()});var e=this;this.tab.createMenu(this.component.getIconUrl()).setAsOnTheFlyMenu(function(){return e.component.getMenuItems()}),this.tab.setTitle(this.member.getName());e=this;this.tab.addListener(apogeeapp.ui.CLOSE_EVENT,function(){e.component.closeTabDisplay(),e.destroy()})},apogeeapp.app.TabComponentDisplay.PARENT_CONTAINER_STYLE={position:"relative",display:"table",width:"100%",height:"100%",top:"0px",left:"0px"},apogeeapp.app.TabComponentDisplay.prototype.createDisplayContent=function(){if(this.contentElement=apogeeapp.ui.createElement("div",null,apogeeapp.app.TabComponentDisplay.PARENT_CONTAINER_STYLE),this.parentContainer=new apogeeapp.ui.WindowParent(this.contentElement),this.folder.isParent){this.setAddChildrenContextMenu();var e=this.component.getWorkspaceUI(),t=this.folder.getChildMap();for(var a in t){var p=t[a],o=e.getComponent(p);o&&this.addChildComponent(o)}}},apogeeapp.app.TabComponentDisplay.prototype.setAddChildrenContextMenu=function(){var e=this.component.getWorkspaceUI().getApp();this.contentElement.oncontextmenu=(t=>{if(t.preventDefault(),t.stopPropagation(),t.offsetX){var a={},p={};p.x=t.offsetX,p.y=t.offsetY,a.windowState={},a.windowState.posInfo=p}var o={};o.parentName=this.member.getFullName();var n=new apogeeapp.ui.MenuBody;n.setMenuItems(e.getAddChildMenuItems(o,a)),apogeeapp.ui.Menu.showContextMenu(n,t)})},apogeeapp.app.TabComponentDisplay.prototype.destroy=function(){var e=this.folder.getChildMap(),t=this.component.getWorkspaceUI();for(var a in e){var p=e[a];t.getComponent(p).closeWindowDisplay()}this.closeTab()},apogeeapp.app.ParentWindowComponentDisplay=function(e,t){this.component=e,this.member=e.getMember(),t||(t={}),this.options=t,this.loadWindowFrameEntry()},apogeeapp.app.ParentWindowComponentDisplay.prototype.getDisplayFrame=function(){return this.windowFrame},apogeeapp.app.ParentWindowComponentDisplay.prototype.getPreferredPosition=function(){return this.options?this.options.posInfo:void 0},apogeeapp.app.ParentWindowComponentDisplay.prototype.getPreferredState=function(){return apogeeapp.ui.WINDOW_STATE_MINIMIZED},apogeeapp.app.ParentWindowComponentDisplay.prototype.getComponent=function(){return this.component},apogeeapp.app.ParentWindowComponentDisplay.prototype.deleteDisplay=function(){this.windowFrame&&this.windowFrame.close()},apogeeapp.app.ParentWindowComponentDisplay.prototype.setBannerState=function(e,t){if(this.windowFrame){var a=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);a?this.windowFrame.setIconOverlay(a):this.windowFrame.clearIconOverlay()}},apogeeapp.app.ParentWindowComponentDisplay.prototype.updateData=function(){this.windowFrame&&this.windowFrame.setTitle(this.member.getDisplayName())},apogeeapp.app.ParentWindowComponentDisplay.prototype.getStateJson=function(){if(this.windowFrame){var e={};return e.posInfo=this.windowFrame.getPosInfo(),e}},apogeeapp.app.ParentWindowComponentDisplay.prototype.loadWindowFrameEntry=function(){var e={minimizable:!1,maximizable:!1,resizable:!1,movable:!0,frameColorClass:"visicomp_windowColor",titleBarClass:"visicomp_titleBarClass"};this.windowFrame=new apogeeapp.ui.WindowFrame(e),this.windowFrame.setWindowState(apogeeapp.ui.WINDOW_STATE_MINIMIZED);var t=apogeeapp.ui.createElement("div");this.windowFrame.setContent(t,apogeeapp.ui.RESIZABLE),this.windowFrame.setTitle(this.member.getDisplayName());var a=this;this.windowFrame.createMenu(this.component.getIconUrl()).setAsOnTheFlyMenu(function(){var e=[],t=a.component.getOpenMenuItem();return t&&e.push(t),a.component.getMenuItems(e)})},apogeeapp.app.ParentWindowComponentDisplay.prototype.destroy=function(){for(var e in viewModeElements){this.viewModeElemens[e].destroy()}},apogeeapp.app.EditWindowComponentDisplay=function(e,t){this.component=e,this.member=e.getMember(),t||(t={}),this.options=t,this.viewType=null,this.select=null,this.viewModeElements={},this.viewModeElement=null,t.PLAIN_FRAME_UI?this.loadPlainFrameEntry():this.loadWindowFrameEntry();var a=this.component.getTableEditSettings(),p=this.getInitialViewType(a.viewModes,a.defaultView);this.setViewType(p)},apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR="#f4f4f4",apogeeapp.app.EditWindowComponentDisplay.prototype.getDisplayFrame=function(){return this.windowFrame?this.windowFrame:this.plainFrame?this.plainFrame:null},apogeeapp.app.EditWindowComponentDisplay.prototype.getPreferredPosition=function(){return this.options?this.options.posInfo:void 0},apogeeapp.app.EditWindowComponentDisplay.prototype.getPreferredState=function(){return this.options&&void 0!==this.options.state?this.options.state:apogeeapp.ui.WINDOW_STATE_NORMAL},apogeeapp.app.EditWindowComponentDisplay.prototype.getComponent=function(){return this.component},apogeeapp.app.EditWindowComponentDisplay.prototype.getMember=function(){return this.member},apogeeapp.app.EditWindowComponentDisplay.prototype.getDataDisplay=function(e,t){return this.component.getDataDisplay(e,t)},apogeeapp.app.EditWindowComponentDisplay.prototype.deleteDisplay=function(){for(var e in this.viewModeElements){var t=this.viewModeElements[e];t&&t.destroy()}this.windowFrame&&this.windowFrame.close()},apogeeapp.app.EditWindowComponentDisplay.prototype.setBannerState=function(e,t){if(this.windowHeaderManager&&(e==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE?this.windowHeaderManager.hideBannerBar():this.windowHeaderManager.showBannerBar(t,e)),this.windowFrame){var a=apogeeapp.app.WindowHeaderManager.getIconOverlay(e);a?this.windowFrame.setIconOverlay(a):this.windowFrame.clearIconOverlay()}},apogeeapp.app.EditWindowComponentDisplay.prototype.updateData=function(){if(this.windowFrame&&this.windowFrame.setTitle(this.member.getDisplayName()),this.windowFrame||this.plainFrame)for(var e in this.viewModeElements)this.viewModeElements[e].memberUpdated()},apogeeapp.app.EditWindowComponentDisplay.prototype.updateViewModeElement=function(e){delete this.viewModeElements[e],this.viewType==e&&(this.viewType=null,this.setViewType(e))},apogeeapp.app.EditWindowComponentDisplay.prototype.getStateJson=function(){var e={},t=!1;return this.windowFrame&&(e.sizeInfo=this.windowFrame.getSizeInfo(),e.posInfo=this.windowFrame.getPosInfo(),e.state=this.windowFrame.getWindowState(),t=!0),this.viewType&&(e.viewType=this.viewType,t=!0),t?e:void 0},apogeeapp.app.EditWindowComponentDisplay.prototype.setStateJson=function(e){this.windowFrame&&(e.sizeInfo&&this.windowFrame.setSizeInfo(e.sizeInfo),e.posInfo&&this.windowFrame.setPosInfo(e.posInfo),e.state&&this.windowFrame.setWindowState(e.state)),e.viewType&&(this.viewType=e.viewType)},apogeeapp.app.EditWindowComponentDisplay.prototype.loadWindowFrameEntry=function(){var e={minimizable:!0,maximizable:!0,resizable:!0,movable:!0,frameColorClass:"visicomp_windowColor",titleBarClass:"visicomp_titleBarClass"};this.windowFrame=new apogeeapp.ui.WindowFrame(e),this.options&&this.options.sizeInfo?this.windowFrame.setSize(this.options.sizeInfo.width,this.options.sizeInfo.height):this.windowFrame.setSize(this.component.componentGenerator.DEFAULT_WIDTH,this.component.componentGenerator.DEFAULT_HEIGHT),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.windowFrame.setHeaderContent(this.windowHeaderManager.getHeaderElement()),this.windowFrame.setTitle(this.member.getDisplayName());var t=this.windowFrame.createMenu(this.component.getIconUrl()),a=this.component;t.setAsOnTheFlyMenu(function(){return a.getMenuItems()}),this.createSelectTool(),this.initContentUI()},apogeeapp.app.EditWindowComponentDisplay.prototype.loadPlainFrameEntry=function(){this.plainFrame=new apogeeapp.ui.PlainFrame,this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.plainFrame.setHeaderContent(this.windowHeaderManager.getHeaderElement())},apogeeapp.app.EditWindowComponentDisplay.prototype.createSelectTool=function(){this.select=apogeeapp.ui.createElement("select",null,{marginRight:"3px",backgroundColor:"transparent"});var e=this;this.select.onchange=function(t){e.setViewType(e.select.value)},this.windowFrame.addTitleToolElement(this.select)},apogeeapp.app.EditWindowComponentDisplay.prototype.initContentUI=function(){for(var e=this.component.getTableEditSettings().viewModes,t=0;t<e.length;t++){var a=e[t];this.select.add(apogeeapp.ui.createElement("option",{text:a}))}},apogeeapp.app.EditWindowComponentDisplay.prototype.getInitialViewType=function(e,t){return this.options&&this.options.viewType&&e.indexOf(this.options.viewType)>=0?this.options.viewType:t||e[0]},apogeeapp.app.EditWindowComponentDisplay.prototype.setViewType=function(e){if(this.viewType!==e){if(this.viewModeElement){var t=this.viewModeElement.isCloseOk();if(t!==apogeeapp.app.ViewMode.CLOSE_OK)return t===apogeeapp.app.ViewMode.UNSAVED_DATA?alert("You must save or cancel the edit session to change the view mode."):alert("close request rejected..."),void this.updateViewTypeSelect();this.viewModeElement.setInactive()}this.viewType=e,this.updateViewTypeSelect(),this.viewModeElement=this.viewModeElements[e],this.viewModeElement||(this.viewModeElement=new apogeeapp.app.ViewMode(this,e),this.viewModeElements[e]=this.viewModeElement),this.viewModeElement?this.viewModeElement.setActive():alert("Error: View mode element not found!")}},apogeeapp.app.EditWindowComponentDisplay.prototype.updateViewTypeSelect=function(){this.select&&this.select.value!=this.viewType&&(this.select.value=this.viewType)},apogeeapp.app.EditWindowComponentDisplay.prototype.showDataDisplay=function(e){this.windowFrame?this.windowFrame.setContent(e.getContent(),e.getContentType()):this.plainFrame&&this.plainFrame.setContent(e.getContent(),e.getContentType())},apogeeapp.app.EditWindowComponentDisplay.prototype.removeDisplayElement=function(e){this.windowFrame?this.windowFrame.safeRemoveContent(e):this.plainFrame&&this.plainFrame.safeRemoveContent(e)},apogeeapp.app.EditWindowComponentDisplay.prototype.startEditUI=function(e,t){this.select&&(this.select.disabled=!0),this.showSaveBar(e,t)},apogeeapp.app.EditWindowComponentDisplay.prototype.endEditUI=function(){this.hideSaveBar(),this.select&&(this.select.disabled=!1)},apogeeapp.app.EditWindowComponentDisplay.prototype.showSaveBar=function(e,t){this.saveDiv||(this.saveDiv=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",backgroundColor:"white",border:"solid 1px gray",padding:"3px"}),this.saveDiv.appendChild(document.createTextNode("Edit: ")),this.saveBarSaveButton=document.createElement("button"),this.saveBarSaveButton.innerHTML="Save",this.saveDiv.appendChild(this.saveBarSaveButton),this.saveDiv.appendChild(document.createTextNode(" ")),this.saveBarCancelButton=document.createElement("button"),this.saveBarCancelButton.innerHTML="Cancel",this.saveDiv.appendChild(this.saveBarCancelButton)),this.saveBarSaveButton.onclick=e,this.saveBarCancelButton.onclick=t,this.saveBarActive=!0,this.windowHeaderManager.showToolbar(this.saveDiv)},apogeeapp.app.EditWindowComponentDisplay.prototype.hideSaveBar=function(){this.saveBarActive=!1,this.windowHeaderManager.showToolbar(this.normalToolbarDiv)},apogeeapp.app.FolderComponent=function(e,t){apogeeapp.app.ParentComponent.call(this,e,t,apogeeapp.app.FolderComponent),this.addOpenAction(apogeeapp.app.FolderComponent.readFromJson),this.addSaveAction(apogeeapp.app.FolderComponent.writeToJson)},apogeeapp.app.FolderComponent.prototype=Object.create(apogeeapp.app.ParentComponent.prototype),apogeeapp.app.FolderComponent.prototype.constructor=apogeeapp.app.FolderComponent,apogeeapp.app.FolderComponent.prototype.instantiateTabDisplay=function(){var e=this.getMember();return this.tabDisplay=new apogeeapp.app.TabComponentDisplay(this,e,e),this.tabDisplay},apogeeapp.app.FolderComponent.writeToJson=function(e){var t=this.getMember(),a=this.getWorkspaceUI();e.children=a.getFolderComponentContentJson(t)},apogeeapp.app.FolderComponent.readFromJson=function(e){if(e.children){var t=this.getWorkspaceUI(),a=this.getMember();t.loadFolderComponentContentFromJson(a,e.children)}},apogeeapp.app.FolderComponent.EMPTY_FOLDER_COMPONENT_JSON={type:"apogeeapp.app.FolderComponent"},apogeeapp.app.FolderComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,e.children&&(t.children=e.children),t.type=apogee.Folder.generator.type,t},apogeeapp.app.FolderComponent.displayName="Folder",apogeeapp.app.FolderComponent.uniqueName="apogeeapp.app.FolderComponent",apogeeapp.app.FolderComponent.DEFAULT_WIDTH=500,apogeeapp.app.FolderComponent.DEFAULT_HEIGHT=500,apogeeapp.app.FolderComponent.ICON_RES_PATH="/componentIcons/folder.png",apogeeapp.app.FolderComponent.TREE_ENTRY_SORT_ORDER=apogeeapp.app.Component.FOLDER_COMPONENT_TYPE_SORT_ORDER,apogeeapp.app.FolderComponent.propertyDialogLines=[{type:"invisible",resultKey:"children"}],apogeeapp.app.FolderComponent.appendWorkspaceChildren=function(e,t){e.children=t},apogeeapp.app.JsonTableComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.JsonTableComponent),this.dataView=apogeeapp.app.JsonTableComponent.DEFAULT_DATA_VIEW,this.addOpenAction(apogeeapp.app.JsonTableComponent.readFromJson),this.addSaveAction(apogeeapp.app.JsonTableComponent.writeToJson)},apogeeapp.app.JsonTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.JsonTableComponent.prototype.constructor=apogeeapp.app.JsonTableComponent,apogeeapp.app.JsonTableComponent.prototype.getDataView=function(){return this.dataView||(this.dataView=apogeeapp.app.JsonTableComponent.DEFAULT_DATA_VIEW),this.dataView},apogeeapp.app.JsonTableComponent.prototype.setDataView=function(e){this.dataView=e;var t=this.getWindowDisplay();t&&t.updateViewModeElement(apogeeapp.app.JsonTableComponent.VIEW_DATA)},apogeeapp.app.JsonTableComponent.VIEW_DATA="Data",apogeeapp.app.JsonTableComponent.VIEW_CODE="Formula",apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.JsonTableComponent.VIEW_MODES=[apogeeapp.app.JsonTableComponent.VIEW_DATA,apogeeapp.app.JsonTableComponent.VIEW_CODE,apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION],apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.JsonTableComponent.VIEW_MODES,defaultView:apogeeapp.app.JsonTableComponent.VIEW_DATA,clearFunctionMenuText:"Clear Formula",emptyDataValue:""},apogeeapp.app.JsonTableComponent.PLAIN_DATA_VEW="Plain",apogeeapp.app.JsonTableComponent.COLORIZED_DATA_VEW="Colorized",apogeeapp.app.JsonTableComponent.TEXT_DATA_VEW="Text Data",apogeeapp.app.JsonTableComponent.GRID_DATA_VEW="Grid",apogeeapp.app.JsonTableComponent.FORM_DATA_VIEW="Form",apogeeapp.app.JsonTableComponent.DEFAULT_DATA_VIEW=apogeeapp.app.JsonTableComponent.COLORIZED_DATA_VEW,apogeeapp.app.JsonTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.JsonTableComponent.prototype.getDataDisplay=function(e,t){var a;switch(t){case apogeeapp.app.JsonTableComponent.VIEW_DATA:switch(this.dataView){case apogeeapp.app.JsonTableComponent.COLORIZED_DATA_VEW:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataTextCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/json");case apogeeapp.app.JsonTableComponent.TEXT_DATA_VEW:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataJsonCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/text");case apogeeapp.app.JsonTableComponent.GRID_DATA_VEW:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataJsonCallbacks(this.member),new apogeeapp.app.HandsonGridEditor(e,a);case apogeeapp.app.JsonTableComponent.FORM_DATA_VIEW:alert("FORM EDITOR NOT IMPLEMENTED YET!"),a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataJsonCallbacks(this.member);case apogeeapp.app.JsonTableComponent.PLAIN_DATA_VEW:default:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataTextCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/text")}case apogeeapp.app.JsonTableComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member,apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member,apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.JsonTableComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.JsonTable.generator.type,t},apogeeapp.app.JsonTableComponent.writeToJson=function(e){e.dataView=this.dataView},apogeeapp.app.JsonTableComponent.readFromJson=function(e){void 0!==e.dataView&&(this.dataView=e.dataView)},apogeeapp.app.JsonTableComponent.addPropFunction=function(e,t){t.dataView=e.getDataView()},apogeeapp.app.JsonTableComponent.updateProperties=function(e,t,a){e.setDataView(a.dataView)},apogeeapp.app.JsonTableComponent.displayName="Data Table",apogeeapp.app.JsonTableComponent.uniqueName="apogeeapp.app.JsonTableComponent",apogeeapp.app.JsonTableComponent.DEFAULT_WIDTH=300,apogeeapp.app.JsonTableComponent.DEFAULT_HEIGHT=300,apogeeapp.app.JsonTableComponent.ICON_RES_PATH="/componentIcons/dataTable.png",apogeeapp.app.JsonTableComponent.propertyDialogLines=[{type:"dropdown",heading:"Data View: ",entries:["Colorized","Plain","Text Data","Grid","Form"],resultKey:"dataView"}],apogeeapp.app.GridTableComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.GridTableComponent)},apogeeapp.app.GridTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.GridTableComponent.prototype.constructor=apogeeapp.app.GridTableComponent,apogeeapp.app.GridTableComponent.VIEW_GRID="Grid",apogeeapp.app.GridTableComponent.VIEW_CODE="Formula",apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.GridTableComponent.VIEW_MODES=[apogeeapp.app.GridTableComponent.VIEW_GRID,apogeeapp.app.GridTableComponent.VIEW_CODE,apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION],apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.GridTableComponent.VIEW_MODES,defaultView:apogeeapp.app.GridTableComponent.VIEW_GRID,clearFunctionMenuText:"Clear Formula",emptyDataValue:[[""]]},apogeeapp.app.GridTableComponent.DEFAULT_VIEW=apogeeapp.app.GridTableComponent.VIEW_GRID,apogeeapp.app.GridTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.GridTableComponent.prototype.getDataDisplay=function(e,t){var a;switch(t){case apogeeapp.app.GridTableComponent.VIEW_GRID:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataJsonCallbacks(this.member),new apogeeapp.app.HandsonGridEditor(e,a);case apogeeapp.app.GridTableComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member,apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member,apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.GridTableComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.JsonTable.generator.type,t.updateData={},t.updateData.data=[[""]],t},apogeeapp.app.GridTableComponent.displayName="Grid Table (DEPRECATED)",apogeeapp.app.GridTableComponent.uniqueName="apogeeapp.app.GridTableComponent",apogeeapp.app.GridTableComponent.DEFAULT_WIDTH=300,apogeeapp.app.GridTableComponent.DEFAULT_HEIGHT=300,apogeeapp.app.GridTableComponent.ICON_RES_PATH="/componentIcons/gridTable.png",apogeeapp.app.TextComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.TextComponent)},apogeeapp.app.TextComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.TextComponent.prototype.constructor=apogeeapp.app.TextComponent,apogeeapp.app.TextComponent.VIEW_TEXT="Text",apogeeapp.app.TextComponent.VIEW_CODE="Formula",apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.TextComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.TextComponent.VIEW_MODES=[apogeeapp.app.TextComponent.VIEW_TEXT,apogeeapp.app.TextComponent.VIEW_CODE,apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.TextComponent.VIEW_DESCRIPTION],apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.TextComponent.VIEW_MODES,defaultView:apogeeapp.app.TextComponent.VIEW_TEXT,clearFunctionMenuText:"Clear Formula",emptyDataValue:""},apogeeapp.app.TextComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.TextComponent.prototype.getDataDisplay=function(e,t){var a;switch(t){case apogeeapp.app.TextComponent.VIEW_TEXT:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataJsonCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/text");case apogeeapp.app.TextComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member,apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member,apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.TextComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.TextComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.JsonTable.generator.type,t.updateData={},t.updateData.data="",t},apogeeapp.app.TextComponent.displayName="Text Table (DEPRECATED)",apogeeapp.app.TextComponent.uniqueName="apogeeapp.app.TextComponent",apogeeapp.app.TextComponent.DEFAULT_WIDTH=300,apogeeapp.app.TextComponent.DEFAULT_HEIGHT=300,apogeeapp.app.TextComponent.ICON_RES_PATH="/componentIcons/textTable.png",apogeeapp.app.JavascriptComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.JavascriptComponent)},apogeeapp.app.JavascriptComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.JavascriptComponent.prototype.constructor=apogeeapp.app.JavascriptComponent,apogeeapp.app.JavascriptComponent.VIEW_CODE="Code",apogeeapp.app.JavascriptComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.JavascriptComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.JavascriptComponent.VIEW_MODES=[apogeeapp.app.JavascriptComponent.VIEW_CODE,apogeeapp.app.JavascriptComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.JavascriptComponent.VIEW_DESCRIPTION],apogeeapp.app.JavascriptComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.JavascriptComponent.VIEW_MODES,defaultView:apogeeapp.app.JavascriptComponent.VIEW_CODE},apogeeapp.app.JavascriptComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.JavascriptComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.JavascriptComponent.prototype.getDataDisplay=function(e,t){var a;switch(t){case apogeeapp.app.JavascriptComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.JavascriptComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.JavascriptComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.JavascriptComponent.getCreateMemberPayload=function(e){var t={};t.name=e.name;return t.updateData={},t.updateData.argList=[],t.type=apogee.JavascriptTable.generator.type,t},apogeeapp.app.JavascriptComponent.displayName="Javascript Object (TEMPORARY!)",apogeeapp.app.JavascriptComponent.uniqueName="apogeeapp.app.JavascriptComponent",apogeeapp.app.JavascriptComponent.DEFAULT_WIDTH=400,apogeeapp.app.JavascriptComponent.DEFAULT_HEIGHT=400,apogeeapp.app.JavascriptComponent.ICON_RES_PATH="/componentIcons/javascriptTable.png",apogeeapp.app.FunctionComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.FunctionComponent)},apogeeapp.app.FunctionComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.FunctionComponent.prototype.constructor=apogeeapp.app.FunctionComponent,apogeeapp.app.FunctionComponent.VIEW_CODE="Code",apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.FunctionComponent.VIEW_MODES=[apogeeapp.app.FunctionComponent.VIEW_CODE,apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION],apogeeapp.app.FunctionComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.FunctionComponent.VIEW_MODES,defaultView:apogeeapp.app.FunctionComponent.VIEW_CODE},apogeeapp.app.FunctionComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.FunctionComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.FunctionComponent.prototype.getDataDisplay=function(e,t){var a;switch(t){case apogeeapp.app.FunctionComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.FunctionComponent.getCreateMemberPayload=function(e){var t,a={};return a.name=e.name,t=e.argListString?apogee.FunctionTable.parseStringArray(e.argListString):[],a.updateData={},a.updateData.argList=t,a.type=apogee.FunctionTable.generator.type,a},apogeeapp.app.FunctionComponent.displayName="Function",apogeeapp.app.FunctionComponent.uniqueName="apogeeapp.app.FunctionComponent",apogeeapp.app.FunctionComponent.DEFAULT_WIDTH=400,apogeeapp.app.FunctionComponent.DEFAULT_HEIGHT=400,apogeeapp.app.FunctionComponent.ICON_RES_PATH="/componentIcons/functionTable.png",apogeeapp.app.FunctionComponent.propertyDialogLines=[{type:"inputElement",heading:"Arg List: ",resultKey:"argListString"}],apogeeapp.app.FolderFunctionComponent=function(e,t){apogeeapp.app.ParentComponent.call(this,e,t,apogeeapp.app.FolderFunctionComponent);var a=t.getInternalFolder();e.registerMember(a,this,t),this.addOpenAction(apogeeapp.app.FolderFunctionComponent.readFromJson),this.addSaveAction(apogeeapp.app.FolderFunctionComponent.writeToJson)},apogeeapp.app.FolderFunctionComponent.prototype=Object.create(apogeeapp.app.ParentComponent.prototype),apogeeapp.app.FolderFunctionComponent.prototype.constructor=apogeeapp.app.FolderFunctionComponent,apogeeapp.app.FolderFunctionComponent.prototype.instantiateTabDisplay=function(){var e=this.getMember(),t=e.getInternalFolder();return this.tabDisplay=new apogeeapp.app.TabComponentDisplay(this,e,t),this.tabDisplay},apogeeapp.app.FolderFunctionComponent.writeToJson=function(e){var t=this.getMember().getInternalFolder(),a=this.getWorkspaceUI();e.children=a.getFolderComponentContentJson(t)},apogeeapp.app.FolderFunctionComponent.readFromJson=function(e){if(e.children){var t=this.getWorkspaceUI(),a=this.getMember().getInternalFolder();t.loadFolderComponentContentFromJson(a,e.children)}},apogeeapp.app.FolderFunctionComponent.getCreateMemberPayload=function(e){var t={};if(t.name=e.name,e.argListString){var a=apogee.FunctionTable.parseStringArray(e.argListString);t.argList=a}return e.returnValueString&&(t.returnValue=e.returnValueString),e.internalFolder&&(t.internalFolder=e.internalFolder),t.type=apogee.FolderFunction.generator.type,t},apogeeapp.app.FolderFunctionComponent.displayName="Folder Function",apogeeapp.app.FolderFunctionComponent.uniqueName="apogeeapp.app.FolderFunctionComponent",apogeeapp.app.FolderFunctionComponent.DEFAULT_WIDTH=500,apogeeapp.app.FolderFunctionComponent.DEFAULT_HEIGHT=500,apogeeapp.app.FolderFunctionComponent.ICON_RES_PATH="/componentIcons/folderFunction.png",apogeeapp.app.FolderFunctionComponent.propertyDialogLines=[{type:"inputElement",heading:"Arg List: ",resultKey:"argListString"},{type:"inputElement",heading:"Return Val: ",resultKey:"returnValueString"},{type:"invisible",resultKey:"internalFolder"}],apogeeapp.app.FolderFunctionComponent.appendWorkspaceChildren=function(e,t){var a={};a.name=e.name,a.type=apogee.Folder.generator.type,apogeeapp.app.FolderComponent.generator.appendWorkspaceChildren(a,t),e.internalFolder=a},apogeeapp.app.BasicControlComponent=class extends apogeeapp.app.EditComponent{constructor(e,t,a){super(e,t,a),this.displayDestroyFlags=apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER}setDisplayDestroyFlags(e){this.displayDestroyFlags=e,this.outputMode&&this.outputMode.setDisplayDestroyFlags(e)}getTableEditSettings(){return apogeeapp.app.BasicControlComponent.TABLE_EDIT_SETTINGS}getDataDisplay(e,t){var a;switch(t){case apogeeapp.app.BasicControlComponent.VIEW_OUTPUT:return e.setDisplayDestroyFlags(this.displayDestroyFlags),this.outputMode=e,this.getOutputDisplay(e);case apogeeapp.app.BasicControlComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}}static getCreateMemberPayload(e){var t={};return t.name=e.name,t.type=apogee.JsonTable.generator.type,t}static attachStandardStaticProperties(e,t,a){e.displayName=t,e.uniqueName=a,e.getCreateMemberPayload=apogeeapp.app.BasicControlComponent.getCreateMemberPayload,e.DEFAULT_WIDTH=500,e.DEFAULT_HEIGHT=500,e.ICON_RES_PATH="/componentIcons/chartControl.png"}},apogeeapp.app.BasicControlComponent.VIEW_OUTPUT="Output",apogeeapp.app.BasicControlComponent.VIEW_CODE="Code",apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.BasicControlComponent.VIEW_MODES=[apogeeapp.app.BasicControlComponent.VIEW_OUTPUT,apogeeapp.app.BasicControlComponent.VIEW_CODE,apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION],apogeeapp.app.BasicControlComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.BasicControlComponent.VIEW_MODES,defaultView:apogeeapp.app.BasicControlComponent.VIEW_OUTPUT},apogeeapp.app.DynamicForm=class extends apogeeapp.app.BasicControlComponent{constructor(e,t){super(e,t,apogeeapp.app.DynamicForm)}getOutputDisplay(e){var t={getData:()=>this.getMember().getData()};return new apogeeapp.app.ConfigurableFormDisplay(e,t)}},apogeeapp.app.BasicControlComponent.attachStandardStaticProperties(apogeeapp.app.DynamicForm,"Dynamic Form","apogeeapp.app.DynamicForm"),apogeeapp.app.FormDataComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.FormDataComponent),t.setChildrenWriteable(!1),this.dataTable=t.lookupChildFromPathArray(["data"]),this.layoutTable=t.lookupChildFromPathArray(["layout"]),this.isInputValidFunctionTable=t.lookupChildFromPathArray(["isInputValid"]),this.displayDestroyFlags=apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER,this.addOpenAction(apogeeapp.app.FormDataComponent.readFromJson),this.addSaveAction(apogeeapp.app.FormDataComponent.writeToJson)},apogeeapp.app.FormDataComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.FormDataComponent.prototype.constructor=apogeeapp.app.FormDataComponent,apogeeapp.app.FormDataComponent.VIEW_FORM="Form",apogeeapp.app.FormDataComponent.VIEW_LAYOUT_CODE="Layout Code",apogeeapp.app.FormDataComponent.VIEW_LAYOUT_SUPPLEMENTAL_CODE="Layout Private",apogeeapp.app.FormDataComponent.VIEW_FORM_VALUE="Form Value",apogeeapp.app.FormDataComponent.VIEW_INPUT_INVALID_CODE="isInputValid(formValue)",apogeeapp.app.FormDataComponent.VIEW_INPUT_INVALID_SUPPLEMENTAL_CODE="isInputValid Private",apogeeapp.app.FormDataComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.FormDataComponent.VIEW_MODES=[apogeeapp.app.FormDataComponent.VIEW_FORM,apogeeapp.app.FormDataComponent.VIEW_LAYOUT_CODE,apogeeapp.app.FormDataComponent.VIEW_LAYOUT_SUPPLEMENTAL_CODE,apogeeapp.app.FormDataComponent.VIEW_INPUT_INVALID_CODE,apogeeapp.app.FormDataComponent.VIEW_INPUT_INVALID_SUPPLEMENTAL_CODE,apogeeapp.app.FormDataComponent.VIEW_FORM_VALUE,apogeeapp.app.FormDataComponent.VIEW_DESCRIPTION],apogeeapp.app.FormDataComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.FormDataComponent.VIEW_MODES,defaultView:apogeeapp.app.FormDataComponent.VIEW_FORM},apogeeapp.app.FormDataComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.FormDataComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.FormDataComponent.prototype.getDataDisplay=function(e,t){var a;switch(t){case apogeeapp.app.FormDataComponent.VIEW_FORM:return e.setDisplayDestroyFlags(this.displayDestroyFlags),a=this.getFormEditorCallbacks(),new apogeeapp.app.ConfigurableFormEditor(e,a);case apogeeapp.app.FormDataComponent.VIEW_LAYOUT_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.layoutTable,apogeeapp.app.FormDataComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.FormDataComponent.VIEW_LAYOUT_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.layoutTable,apogeeapp.app.FormDataComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.FormDataComponent.VIEW_FORM_VALUE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataTextCallbacks(this.dataTable),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/json");case apogeeapp.app.FormDataComponent.VIEW_INPUT_INVALID_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.isInputValidFunctionTable,apogeeapp.app.FormDataComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.FormDataComponent.VIEW_INPUT_INVALID_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.isInputValidFunctionTable,apogeeapp.app.FormDataComponent.TABLE_EDIT_SETTINGS.emptyDataValue),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.FormDataComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.dataTable),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.FormDataComponent.prototype.getFormEditorCallbacks=function(){var e={};e.getData=(()=>this.dataTable.getData()),e.getLayoutInfo=(()=>this.layoutTable.getData()),e.getEditOk=(()=>!0);var t=new apogee.action.Messenger(this.layoutTable);return e.saveData=(e=>{var a=this.isInputValidFunctionTable.getData()(e);return!0!==a?"string"==typeof a?(alert(a),!1):void alert("Improper format for isInputValid function. It should return true or an error message"):(t.dataUpdate("data",e),!0)}),e},apogeeapp.app.FormDataComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.Folder.generator.type,t.childrenNotWriteable=!0,t.children={layout:{name:"layout",type:"apogee.JsonTable",updateData:{data:""}},data:{name:"data",type:"apogee.JsonTable",updateData:{data:""}},isInputValid:{name:"isInputValid",type:"apogee.FunctionTable",updateData:{argList:["formValue"],functionBody:"//If data valid, return true. If data is invalid, return an error message.\nreturn true;"}}},t},apogeeapp.app.FormDataComponent.writeToJson=function(e){e.dataView=this.dataView},apogeeapp.app.FormDataComponent.readFromJson=function(e){void 0!==e.dataView&&(this.dataView=e.dataView)},apogeeapp.app.FormDataComponent.displayName="Form Data Table",apogeeapp.app.FormDataComponent.uniqueName="apogeeapp.app.FormDataComponent",apogeeapp.app.FormDataComponent.DEFAULT_WIDTH=300,apogeeapp.app.FormDataComponent.DEFAULT_HEIGHT=300,apogeeapp.app.FormDataComponent.ICON_RES_PATH="/componentIcons/formControl.png",apogeeapp.app.CustomControlComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.CustomControlComponent),this.uiCodeFields={},this.currentCss="",this.destroyOnInactive=!1,this.addOpenAction(apogeeapp.app.CustomControlComponent.readFromJson),this.addSaveAction(apogeeapp.app.CustomControlComponent.writeToJson)},apogeeapp.app.CustomControlComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.CustomControlComponent.prototype.constructor=apogeeapp.app.CustomControlComponent,apogeeapp.app.CustomControlComponent.prototype.getUiCodeFields=function(){return this.uiCodeFields},apogeeapp.app.CustomControlComponent.prototype.getUiCodeField=function(e){var t=this.uiCodeFields[e];return null!==t&&void 0!==t||(t=""),t},apogeeapp.app.CustomControlComponent.prototype.getDestroyOnInactive=function(){return this.destroyOnInactive},apogeeapp.app.CustomControlComponent.prototype.getDisplayDestroyFlags=function(){return this.destroyOnInactive?apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE:apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER},apogeeapp.app.CustomControlComponent.prototype.setDestroyOnInactive=function(e){this.destroyOnInactive=e,this.activeOutputMode&&this.activeOutputMode.setDisplayDestroyFlags(this.getDisplayDestroyFlags())},apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML="html",apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS="css",apogeeapp.app.CustomControlComponent.CODE_FIELD_INIT="init",apogeeapp.app.CustomControlComponent.CODE_FIELD_SET_DATA="setData",apogeeapp.app.CustomControlComponent.CODE_FIELD_IS_CLOSE_OK="isCloseOk",apogeeapp.app.CustomControlComponent.CODE_FIELD_DESTROY="destroy",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_LOAD="onLoad",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_UNLOAD="onUnload",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_RESIZE="onResize",apogeeapp.app.CustomControlComponent.CODE_FIELD_CONSTRUCTOR="constructorAddition",apogeeapp.app.CustomControlComponent.VIEW_OUTPUT="Output",apogeeapp.app.CustomControlComponent.VIEW_CODE="Model Code",apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.CustomControlComponent.VIEW_HTML="HTML",apogeeapp.app.CustomControlComponent.VIEW_CSS="CSS",apogeeapp.app.CustomControlComponent.VIEW_INIT="init(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_SET_DATA="setData(data,element,mode)",apogeeapp.app.CustomControlComponent.VIEW_IS_CLOSE_OK="isCloseOk(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_DESTROY="destroy(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD="onLoad(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_UNLOAD="onUnload(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE="onResize(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR="constructor(mode)",apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.CustomControlComponent.VIEW_MODES=[apogeeapp.app.CustomControlComponent.VIEW_OUTPUT,apogeeapp.app.CustomControlComponent.VIEW_CODE,apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.CustomControlComponent.VIEW_HTML,apogeeapp.app.CustomControlComponent.VIEW_CSS,apogeeapp.app.CustomControlComponent.VIEW_INIT,apogeeapp.app.CustomControlComponent.VIEW_SET_DATA,apogeeapp.app.CustomControlComponent.VIEW_IS_CLOSE_OK,apogeeapp.app.CustomControlComponent.VIEW_DESTROY,apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD,apogeeapp.app.CustomControlComponent.VIEW_ON_UNLOAD,apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE,apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR,apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION],apogeeapp.app.CustomControlComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.CustomControlComponent.VIEW_MODES,defaultView:apogeeapp.app.CustomControlComponent.VIEW_OUTPUT},apogeeapp.app.CustomControlComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.CustomControlComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.CustomControlComponent.prototype.getDataDisplay=function(e,t){switch(t){case apogeeapp.app.CustomControlComponent.VIEW_OUTPUT:e.setDisplayDestroyFlags(this.getDisplayDestroyFlags()),this.activeOutputMode=e;var a=this.getCustomFormCallbacks(),p=this.getUiCodeField(apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML),o=this.createResource();return new apogeeapp.app.HtmlJsDataDisplay(e,a,this.member,p,o);case apogeeapp.app.CustomControlComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_HTML:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/html");case apogeeapp.app.CustomControlComponent.VIEW_CSS:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/css");case apogeeapp.app.CustomControlComponent.VIEW_INIT:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_INIT),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_SET_DATA:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_SET_DATA),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_IS_CLOSE_OK:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_IS_CLOSE_OK),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_DESTROY:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_DESTROY),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_LOAD),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_ON_UNLOAD:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_UNLOAD),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_RESIZE),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR:return a=this.getUiCallbacks(apogeeapp.app.CustomControlComponent.CODE_FIELD_CONSTRUCTOR),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.CustomControlComponent.prototype.getCustomFormCallbacks=function(e){return{getData:()=>this.getMember().getData()}},apogeeapp.app.CustomControlComponent.prototype.getUiCallbacks=function(e){return{getData:()=>{var t=this.getUiCodeFields()[e];return void 0!==t&&null!==t||(t=""),t},getEditOk:()=>!0,saveData:t=>{var a=this.getUiCodeFields();a[e]=t;var p=this.update(a);return p.getSuccess()||apogeeapp.app.errorHandling.handleActionError(p),!0}}},apogeeapp.app.CustomControlComponent.prototype.updateFromJson=function(e){this.loadResourceFromJson(e)},apogeeapp.app.CustomControlComponent.prototype.loadResourceFromJson=function(e){var t;t=e&&e.resource?e.resource:{},this.update(t)},apogeeapp.app.CustomControlComponent.prototype.createResource=function(){try{var e="",t=this.getUiCodeFields();for(var a in apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS){var p=t[a];if(p&&""!=p){var o=apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS[a];e+=apogee.util.formatString(o,p)+"\n"}}var n=apogee.util.formatString(apogeeapp.app.CustomControlComponent.GENERATOR_FUNCTION_FORMAT_TEXT,e);return new Function(n)()()}catch(e){alert("Error creating custom control: "+e.message)}},apogeeapp.app.CustomControlComponent.prototype.update=function(e){this.activeOutputMode&&this.activeOutputMode.forceClearDisplay(),this.uiCodeFields=e;var t=this.getUiCodeField(apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS);return t!==this.currentCss&&(""==t&&""==this.currentCss||(apogeeapp.ui.setMemberCssData(this.getMember().getId(),t),this.currentCss=t)),new apogee.ActionResponse},apogeeapp.app.CustomControlComponent.readFromJson=function(e){if(e){if(void 0!==e.destroyOnInactive){var t=e.destroyOnInactive;this.setDestroyOnInactive(t)}this.loadResourceFromJson(e)}},apogeeapp.app.CustomControlComponent.writeToJson=function(e){e.resource=this.uiCodeFields,e.destroyOnInactive=this.destroyOnInactive},apogeeapp.app.CustomControlComponent.addPropFunction=function(e,t){t.destroyOnHide=e.getDestroyOnInactive()},apogeeapp.app.CustomControlComponent.updateProperties=function(e,t,a){e.setDestroyOnInactive(a.destroyOnHide)},apogeeapp.app.CustomControlComponent.GENERATOR_FUNCTION_FORMAT_TEXT=["//member functions","var resourceFunction = function(component) {","var resource = {};","{0}","return resource;","}","//end member functions","return resourceFunction;",""].join("\n"),apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS={constructorAddition:"resource.constructorAddition = function(mode) {\n__customControlDebugHook();\n{0}\n};",init:"resource.init = function(element,mode) {\n{0}\n};",setData:"resource.setData = function(data,element,mode) {\n{0}\n};",isCloseOk:"resource.isCloseOk = function(element,mode) {\n{0}\n};",destroy:"resource.destroy = function(element,mode) {\n{0}\n};",onLoad:"resource.onLoad = function(element,mode) {\n{0}\n};",onUnload:"resource.onUnload = function(element,mode) {\n{0}\n};",onResize:"resource.onResize = function(element,mode) {\n{0}\n};"},apogeeapp.app.CustomControlComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.JsonTable.generator.type,t},apogeeapp.app.CustomControlComponent.displayName="Custom Control Component (Deprecated)",apogeeapp.app.CustomControlComponent.uniqueName="apogeeapp.app.CustomControlComponent",apogeeapp.app.CustomControlComponent.DEFAULT_WIDTH=500,apogeeapp.app.CustomControlComponent.DEFAULT_HEIGHT=500,apogeeapp.app.CustomControlComponent.ICON_RES_PATH="/componentIcons/chartControl.png",apogeeapp.app.CustomControlComponent.propertyDialogLines=[{type:"checkbox",heading:"Destroy on Hide: ",resultKey:"destroyOnHide"}],apogeeapp.app.CustomComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.CustomComponent),this.uiCodeFields={},this.currentCss="",this.destroyOnInactive=!1,this.addOpenAction(apogeeapp.app.CustomComponent.readFromJson),this.addSaveAction(apogeeapp.app.CustomComponent.writeToJson)},apogeeapp.app.CustomComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.CustomComponent.prototype.constructor=apogeeapp.app.CustomComponent,apogeeapp.app.CustomComponent.prototype.getUiCodeFields=function(){return this.uiCodeFields},apogeeapp.app.CustomComponent.prototype.getUiCodeField=function(e){var t=this.uiCodeFields[e];return null!==t&&void 0!==t||(t=""),t},apogeeapp.app.CustomComponent.prototype.getDestroyOnInactive=function(){return this.destroyOnInactive},apogeeapp.app.CustomComponent.prototype.getDisplayDestroyFlags=function(){return this.destroyOnInactive?apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE:apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER},apogeeapp.app.CustomComponent.prototype.setDestroyOnInactive=function(e){this.destroyOnInactive=e,this.activeOutputMode&&this.activeOutputMode.setDisplayDestroyFlags(this.getDisplayDestroyFlags())},apogeeapp.app.CustomComponent.CODE_FIELD_HTML="html",apogeeapp.app.CustomComponent.CODE_FIELD_CSS="css",apogeeapp.app.CustomComponent.CODE_FIELD_UI_CODE="uiCode",apogeeapp.app.CustomComponent.VIEW_OUTPUT="Display",apogeeapp.app.CustomComponent.VIEW_CODE="Input Code",apogeeapp.app.CustomComponent.VIEW_SUPPLEMENTAL_CODE="Input Private",apogeeapp.app.CustomComponent.VIEW_HTML="HTML",apogeeapp.app.CustomComponent.VIEW_CSS="CSS",apogeeapp.app.CustomComponent.VIEW_UI_CODE="uiGenerator(mode)",apogeeapp.app.CustomComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.CustomComponent.VIEW_MODES=[apogeeapp.app.CustomComponent.VIEW_OUTPUT,apogeeapp.app.CustomComponent.VIEW_CODE,apogeeapp.app.CustomComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.CustomComponent.VIEW_HTML,apogeeapp.app.CustomComponent.VIEW_CSS,apogeeapp.app.CustomComponent.VIEW_UI_CODE,apogeeapp.app.CustomComponent.VIEW_DESCRIPTION],apogeeapp.app.CustomComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.CustomComponent.VIEW_MODES,defaultView:apogeeapp.app.CustomComponent.VIEW_OUTPUT},apogeeapp.app.CustomComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.CustomComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.CustomComponent.prototype.getDataDisplay=function(e,t){switch(t){case apogeeapp.app.CustomComponent.VIEW_OUTPUT:e.setDisplayDestroyFlags(this.getDisplayDestroyFlags()),this.activeOutputMode=e;var a=this.getOutputCallbacks(),p=this.getUiCodeField(apogeeapp.app.CustomComponent.CODE_FIELD_HTML),o=this.createResource();return new apogeeapp.app.HtmlJsDataDisplay(e,a,this.member,p,o);case apogeeapp.app.CustomComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.member),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomComponent.VIEW_HTML:return a=this.getUiCallbacks(apogeeapp.app.CustomComponent.CODE_FIELD_HTML),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/html");case apogeeapp.app.CustomComponent.VIEW_CSS:return a=this.getUiCallbacks(apogeeapp.app.CustomComponent.CODE_FIELD_CSS),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/css");case apogeeapp.app.CustomComponent.VIEW_UI_CODE:return a=this.getUiCallbacks(apogeeapp.app.CustomComponent.CODE_FIELD_UI_CODE),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.member),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.CustomComponent.prototype.getOutputCallbacks=function(e){return{getData:()=>this.getMember().getData()}},apogeeapp.app.CustomComponent.prototype.getUiCallbacks=function(e){return{getData:()=>{var t=this.getUiCodeFields()[e];return void 0!==t&&null!==t||(t=""),t},getEditOk:()=>!0,saveData:t=>{var a=this.getUiCodeFields();a[e]=t;var p=this.update(a);return p.getSuccess()||apogeeapp.app.errorHandling.handleActionError(p),!0}}},apogeeapp.app.CustomComponent.prototype.updateFromJson=function(e){this.loadResourceFromJson(e)},apogeeapp.app.CustomComponent.prototype.loadResourceFromJson=function(e){var t;t=e&&e.resource?e.resource:{},this.update(t)},apogeeapp.app.CustomComponent.prototype.createResource=function(){try{var e,t=this.getUiCodeFields()[apogeeapp.app.CustomComponent.CODE_FIELD_UI_CODE];if(t&&t.length>0)try{var a=apogee.util.formatString(apogeeapp.app.CustomComponent.GENERATOR_FUNCTION_FORMAT_TEXT,t);e=new Function(a)()()}catch(e){console.log("bad ui generator function")}return e||(e={}),e}catch(e){alert("Error creating custom control: "+e.message)}},apogeeapp.app.CustomComponent.prototype.update=function(e){this.activeOutputMode&&this.activeOutputMode.forceClearDisplay(),this.uiCodeFields=e;var t=this.getUiCodeField(apogeeapp.app.CustomComponent.CODE_FIELD_CSS);return t!==this.currentCss&&(""==t&&""==this.currentCss||(apogeeapp.ui.setMemberCssData(this.getMember().getId(),t),this.currentCss=t)),new apogee.ActionResponse},apogeeapp.app.CustomComponent.readFromJson=function(e){if(e){if(void 0!==e.destroyOnInactive){var t=e.destroyOnInactive;this.setDestroyOnInactive(t)}this.loadResourceFromJson(e)}},apogeeapp.app.CustomComponent.writeToJson=function(e){e.resource=this.uiCodeFields,e.destroyOnInactive=this.destroyOnInactive},apogeeapp.app.CustomComponent.addPropFunction=function(e,t){t.destroyOnHide=e.getDestroyOnInactive()},apogeeapp.app.CustomComponent.updateProperties=function(e,t,a){e.setDestroyOnInactive(a.destroyOnHide)},apogeeapp.app.CustomComponent.GENERATOR_FUNCTION_FORMAT_TEXT=["//member functions","var resourceFunction = function(component) {","{0}","}","//end member functions","return resourceFunction;",""].join("\n"),apogeeapp.app.CustomComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.JsonTable.generator.type,t},apogeeapp.app.CustomComponent.displayName="Custom Component",apogeeapp.app.CustomComponent.uniqueName="apogeeapp.app.CustomComponent",apogeeapp.app.CustomComponent.DEFAULT_WIDTH=500,apogeeapp.app.CustomComponent.DEFAULT_HEIGHT=500,apogeeapp.app.CustomComponent.ICON_RES_PATH="/componentIcons/chartControl.png",apogeeapp.app.CustomComponent.propertyDialogLines=[{type:"checkbox",heading:"Destroy on Hide: ",resultKey:"destroyOnHide"}],apogeeapp.app.CustomDataComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.CustomDataComponent),t.setChildrenWriteable(!1),this.dataTable=t.lookupChildFromPathArray(["data"]),this.inputTable=t.lookupChildFromPathArray(["input"]),this.isInputValidFunctionTable=t.lookupChildFromPathArray(["isInputValid"]),this.uiCodeFields={},this.currentCss="",this.destroyOnInactive=!1,this.addOpenAction(apogeeapp.app.CustomDataComponent.readFromJson),this.addSaveAction(apogeeapp.app.CustomDataComponent.writeToJson)},apogeeapp.app.CustomDataComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.CustomDataComponent.prototype.constructor=apogeeapp.app.CustomDataComponent,apogeeapp.app.CustomDataComponent.prototype.getUiCodeFields=function(){return this.uiCodeFields},apogeeapp.app.CustomDataComponent.prototype.getUiCodeField=function(e){var t=this.uiCodeFields[e];return null!==t&&void 0!==t||(t=""),t},apogeeapp.app.CustomDataComponent.prototype.getDestroyOnInactive=function(){return this.destroyOnInactive},apogeeapp.app.CustomDataComponent.prototype.getDisplayDestroyFlags=function(){return this.destroyOnInactive?apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE:apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER},apogeeapp.app.CustomDataComponent.prototype.setDestroyOnInactive=function(e){this.destroyOnInactive=e,this.activeOutputMode&&this.activeOutputMode.setDisplayDestroyFlags(this.getDisplayDestroyFlags())},apogeeapp.app.CustomDataComponent.CODE_FIELD_HTML="html",apogeeapp.app.CustomDataComponent.CODE_FIELD_CSS="css",apogeeapp.app.CustomDataComponent.CODE_FIELD_UI_CODE="uiCode",apogeeapp.app.CustomDataComponent.VIEW_FORM="Form",apogeeapp.app.CustomDataComponent.VIEW_VALUE="Data Value",apogeeapp.app.CustomDataComponent.VIEW_CODE="Input Code",apogeeapp.app.CustomDataComponent.VIEW_SUPPLEMENTAL_CODE="Input Private",apogeeapp.app.CustomDataComponent.VIEW_HTML="HTML",apogeeapp.app.CustomDataComponent.VIEW_CSS="CSS",apogeeapp.app.CustomDataComponent.VIEW_UI_CODE="uiGenerator(mode)",apogeeapp.app.CustomDataComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.CustomDataComponent.VIEW_MODES=[apogeeapp.app.CustomDataComponent.VIEW_FORM,apogeeapp.app.CustomDataComponent.VIEW_VALUE,apogeeapp.app.CustomDataComponent.VIEW_CODE,apogeeapp.app.CustomDataComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.CustomDataComponent.VIEW_HTML,apogeeapp.app.CustomDataComponent.VIEW_CSS,apogeeapp.app.CustomDataComponent.VIEW_UI_CODE,apogeeapp.app.CustomDataComponent.VIEW_DESCRIPTION],apogeeapp.app.CustomDataComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.CustomDataComponent.VIEW_MODES,defaultView:apogeeapp.app.CustomDataComponent.VIEW_FORM},apogeeapp.app.CustomDataComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.CustomDataComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.CustomDataComponent.prototype.getDataDisplay=function(e,t){switch(t){case apogeeapp.app.CustomDataComponent.VIEW_FORM:e.setDisplayDestroyFlags(this.getDisplayDestroyFlags()),this.activeOutputMode=e;var a=this.getFormCallbacks(),p=this.getUiCodeField(apogeeapp.app.CustomDataComponent.CODE_FIELD_HTML),o=this.createResource();return new apogeeapp.app.HtmlJsDataDisplay(e,a,this.inputTable,p,o);case apogeeapp.app.CustomDataComponent.VIEW_VALUE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDataTextCallbacks(this.dataTable),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/json");case apogeeapp.app.CustomDataComponent.VIEW_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks(this.inputTable),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomDataComponent.VIEW_SUPPLEMENTAL_CODE:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks(this.inputTable),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomDataComponent.VIEW_HTML:return a=this.getUiCallbacks(apogeeapp.app.CustomDataComponent.CODE_FIELD_HTML),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/html");case apogeeapp.app.CustomDataComponent.VIEW_CSS:return a=this.getUiCallbacks(apogeeapp.app.CustomDataComponent.CODE_FIELD_CSS),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/css");case apogeeapp.app.CustomDataComponent.VIEW_UI_CODE:return a=this.getUiCallbacks(apogeeapp.app.CustomDataComponent.CODE_FIELD_UI_CODE),new apogeeapp.app.AceTextEditor(e,a,"ace/mode/javascript");case apogeeapp.app.CustomDataComponent.VIEW_DESCRIPTION:return a=apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks(this.inputTable),new apogeeapp.app.TextAreaEditor(e,a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.CustomDataComponent.prototype.getFormCallbacks=function(){var e={};e.getData=(()=>{var e={};return e.inputData=this.inputTable.getData(),e.editData=this.dataTable.getData(),e}),e.getEditOk=(()=>!0);var t=new apogee.action.Messenger(this.inputTable);return e.saveData=(e=>(t.dataUpdate("data",e),!0)),e},apogeeapp.app.CustomDataComponent.prototype.getUiCallbacks=function(e){return{getData:()=>{var t=this.getUiCodeFields()[e];return void 0!==t&&null!==t||(t=""),t},getEditOk:()=>!0,saveData:t=>{var a=this.getUiCodeFields();a[e]=t;var p=this.update(a);return p.getSuccess()||apogeeapp.app.errorHandling.handleActionError(p),!0}}},apogeeapp.app.CustomDataComponent.prototype.updateFromJson=function(e){this.loadResourceFromJson(e)},apogeeapp.app.CustomDataComponent.prototype.loadResourceFromJson=function(e){var t;t=e&&e.resource?e.resource:{},this.update(t)},apogeeapp.app.CustomDataComponent.prototype.createResource=function(){try{var e,t=this.getUiCodeFields()[apogeeapp.app.CustomDataComponent.CODE_FIELD_UI_CODE];if(t&&t.length>0)try{var a=apogee.util.formatString(apogeeapp.app.CustomDataComponent.GENERATOR_FUNCTION_FORMAT_TEXT,t);e=new Function(a)()()}catch(e){console.log("bad ui generator function")}return e||(e={}),e}catch(e){alert("Error creating custom control: "+e.message)}},apogeeapp.app.CustomDataComponent.prototype.update=function(e){this.activeOutputMode&&this.activeOutputMode.forceClearDisplay(),this.uiCodeFields=e;var t=this.getUiCodeField(apogeeapp.app.CustomDataComponent.CODE_FIELD_CSS);return t!==this.currentCss&&(""==t&&""==this.currentCss||(apogeeapp.ui.setMemberCssData(this.getMember().getId(),t),this.currentCss=t)),new apogee.ActionResponse},apogeeapp.app.CustomDataComponent.readFromJson=function(e){if(e){if(void 0!==e.destroyOnInactive){var t=e.destroyOnInactive;this.setDestroyOnInactive(t)}this.loadResourceFromJson(e)}},apogeeapp.app.CustomDataComponent.writeToJson=function(e){e.resource=this.uiCodeFields,e.destroyOnInactive=this.destroyOnInactive},apogeeapp.app.CustomDataComponent.addPropFunction=function(e,t){t.destroyOnHide=e.getDestroyOnInactive()},apogeeapp.app.CustomDataComponent.updateProperties=function(e,t,a){e.setDestroyOnInactive(a.destroyOnHide)},apogeeapp.app.CustomDataComponent.GENERATOR_FUNCTION_FORMAT_TEXT=["//member functions","var resourceFunction = function(component) {","{0}","}","//end member functions","return resourceFunction;",""].join("\n"),apogeeapp.app.CustomDataComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.Folder.generator.type,t.childrenNotWriteable=!0,t.children={input:{name:"input",type:"apogee.JsonTable",updateData:{data:""}},data:{name:"data",type:"apogee.JsonTable",updateData:{data:""}}},t},apogeeapp.app.CustomDataComponent.displayName="Custom Data Component",apogeeapp.app.CustomDataComponent.uniqueName="apogeeapp.app.CustomDataComponent",apogeeapp.app.CustomDataComponent.DEFAULT_WIDTH=500,apogeeapp.app.CustomDataComponent.DEFAULT_HEIGHT=500,apogeeapp.app.CustomDataComponent.ICON_RES_PATH="/componentIcons/formControl.png",apogeeapp.app.CustomDataComponent.propertyDialogLines=[{type:"checkbox",heading:"Destroy on Hide: ",resultKey:"destroyOnHide"}],apogeeapp.app.ErrorTableComponent=function(e,t){apogeeapp.app.EditComponent.call(this,e,t,apogeeapp.app.ErrorTableComponent),this.dataView=apogeeapp.app.ErrorTableComponent.EMPTY_VIEW,this.addOpenAction(apogeeapp.app.ErrorTableComponent.readFromJson),this.addSaveAction(apogeeapp.app.ErrorTableComponent.writeToJson)},apogeeapp.app.ErrorTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.ErrorTableComponent.prototype.constructor=apogeeapp.app.ErrorTableComponent,apogeeapp.app.ErrorTableComponent.prototype.getDataView=function(){return this.dataView},apogeeapp.app.ErrorTableComponent.prototype.setDataView=function(e){},apogeeapp.app.ErrorTableComponent.EMPTY_VIEW="EMPTY_VIEW",apogeeapp.app.ErrorTableComponent.VIEW_MODES=[apogeeapp.app.ErrorTableComponent.EMPTY_VIEW],apogeeapp.app.ErrorTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.ErrorTableComponent.VIEW_MODES,defaultView:apogeeapp.app.ErrorTableComponent.EMPTY_VIEW,emptyDataValue:""},apogeeapp.app.ErrorTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.ErrorTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.ErrorTableComponent.prototype.getDataDisplay=function(e,t){return new apogeeapp.app.ErrorDisplay(e,!1)},apogeeapp.app.ErrorTableComponent.getCreateMemberPayload=function(e){var t={};return t.name=e.name,t.type=apogee.ErrorTable.generator.type,t},apogeeapp.app.ErrorTableComponent.prototype.toJson=function(){return this.completeJson},apogeeapp.app.ErrorTableComponent.prototype.loadSerializedValues=function(e){this.completeJson=e},apogeeapp.app.ErrorTableComponent.writeToJson=function(e){e.dataView=this.dataView},apogeeapp.app.ErrorTableComponent.readFromJson=function(e){void 0!==e.dataView&&(this.dataView=e.dataView)},apogeeapp.app.ErrorTableComponent.displayName="Error Table",apogeeapp.app.ErrorTableComponent.uniqueName="apogeeapp.app.ErrorTableComponent",apogeeapp.app.ErrorTableComponent.DEFAULT_WIDTH=300,apogeeapp.app.ErrorTableComponent.DEFAULT_HEIGHT=100,apogeeapp.app.ErrorTableComponent.ICON_RES_PATH="/componentIcons/genericDataTable.png",apogeeapp.app.errorHandling={},apogeeapp.app.errorHandling.handleActionError=function(e){var t=e.getErrors(),a=t.some(e=>e.isFatal),p=t.filter(apogeeapp.app.errorHandling.typeFilter);if(a||p.length>0){var o="";a&&(o+="Fatal Error: The application is in an indeterminant state. It is recommended it be closed.\n"),o+=apogee.ActionResponse.getListErrorMsg(p),alert(o)}},apogeeapp.app.errorHandling.typeFilter=function(e){if(e.getType){var t=e.getType();return t==apogee.ActionError.ERROR_TYPE_APP||t==apogee.ActionError.ERROR_TYPE_USER}return!1},apogeeapp.app.createworkspace={},apogeeapp.app.createworkspace.getCreateCallback=function(e){return function(){e.getWorkspaceUI()&&alert("There is already an open workspace. You must close the workspace first.");var t=apogeeapp.app.createworkspace.createWorkspace(e);t.getSuccess()||apogeeapp.app.errorHandling.handleActionError(t)}},apogeeapp.app.createworkspace.createWorkspace=function(e){var t,a=new apogee.ActionResponse;try{if(e.getWorkspaceUI())throw new Error("There is already an open workspace");var p=new apogeeapp.app.WorkspaceUI;t=e.setWorkspaceUI(p),p.load(),a.workspaceUI=p}catch(p){t&&e.clearWorkspaceUI();var o=apogee.ActionError.processException(p,apogee.ActionError.ERROR_TYPE_APP,!1);a.addError(o)}return a},apogeeapp.app.updateworkspace={},apogeeapp.app.updateworkspace.DIALOG_LAYOUT_TITLE_LINE={type:"title",title:"Update Workspace"},apogeeapp.app.updateworkspace.DIALOG_LAYOUT_NAME_LINE={type:"inputElement",heading:"Name: ",resultKey:"name",initial:""},apogeeapp.app.updateworkspace.DIALOG_LAYOUT_SUBMIT_LINE={type:"submit",submit:"Update",cancel:"Cancel"},apogeeapp.app.updateworkspace.getUpdateWorkspaceCallback=function(e){return function(){var t=e.getWorkspace(),a={};a.name=t.getName();var p=apogee.util.jsonCopy(apogeeapp.app.updateworkspace.DIALOG_LAYOUT_NAME_LINE);p.initial=a.name;var o={lines:[]};o.lines.push(apogeeapp.app.updateworkspace.DIALOG_LAYOUT_TITLE_LINE),o.lines.push(p),o.lines.push(apogeeapp.app.updateworkspace.DIALOG_LAYOUT_SUBMIT_LINE);apogeeapp.app.dialog.showConfigurableDialog(o,function(t){var p=!1;if(t.name!==a.name){if(0===t.length)return alert("The name must not be empty"),!1;p=!0}if(p){var o=apogeeapp.app.updateworkspace.updatePropertyValues(e,a,t);o.getSuccess()||apogeeapp.app.errorHandling.handleActionError(o)}return!0})}},apogeeapp.app.updateworkspace.updatePropertyValues=function(e,t,a){var p,o=e.getWorkspace(),n=new apogee.ActionResponse;t.name!==a.name&&((p={}).action="updateWorkspace",p.workspace=o,p.name=a.name,n=apogee.action.doAction(p,!0,null,n));return n},apogeeapp.app.openworkspace={},apogeeapp.app.openworkspace.getOpenCallback=function(e){return function(){if(e.getWorkspaceUI())alert("There is already an open workspace. You must close the workspace first.");else{apogeeapp.app.openworkspace.openFile(function(t,a,p){t?alert("Error: "+t.message):apogeeapp.app.openworkspace.openWorkspace(e,a,p,function(e){e.getSuccess()||apogeeapp.app.errorHandling.handleActionError(e)})})}}},apogeeapp.app.openworkspace.openWorkspace=function(e,t,a,p){var o,n=new apogee.ActionResponse;try{if(e.getWorkspaceUI())throw new Error("There is already an open workspace");var i=JSON.parse(t),r=new apogeeapp.app.WorkspaceUI;o=e.setWorkspaceUI(r);var s=i.references,l=r.loadReferences(s),d=function(){r.load(i),p(n)};l.then(d).catch(function(e){alert("Error loading links: "+e),d()})}catch(t){o&&e.clearWorkspaceUI();var u=apogee.ActionError.processException(t,apogee.ActionError.ERROR_TYPE_APP,!1);n.addError(u),p(n)}},apogeeapp.app.openworkspace.openWorkspaceFromUrl=function(e,t){apogeeapp.app.openworkspace.openWorkspaceFromUrlImpl(e,t,function(e){e.getSuccess()||apogeeapp.app.errorHandling.handleActionError(e)})},apogeeapp.app.openworkspace.openWorkspaceFromUrlImpl=function(e,t,a){apogeeapp.app.openworkspace.doRequest(t,function(p){apogeeapp.app.openworkspace.openWorkspace(e,p,t,a)},function(e){var t=new apogee.ActionError(e,apogee.ActionError.ERROR_TYPE_APP,null),p=new apogee.ActionResponse;p.addError(t),a(p)})},apogeeapp.app.openworkspace.doRequest=function(e,t,a){var p=new XMLHttpRequest;p.onreadystatechange=function(){var e;4==p.readyState&&200==p.status?t(p.responseText):4==p.readyState&&p.status>=400&&(e="Error in http request. Status: "+p.status,a(e))},p.open("GET",e,!0),p.send()},apogeeapp.app.saveworkspace={},apogeeapp.app.saveworkspace.getSaveCallback=function(e,t){return function(){var a=apogeeapp.app.saveworkspace.getWorkspaceText(e);if(a){var p=()=>e.clearWorkspaceIsDirty();void 0===t?apogeeapp.app.saveworkspace.showSaveDialog(a,p):apogeeapp.app.saveworkspace.saveFile(t,a,p)}else alert("There is no workspace open.")}},apogeeapp.app.saveworkspace.getWorkspaceText=function(e){var t=e.getWorkspaceUI();if(t){var a=t.toJson();return JSON.stringify(a)}},apogeeapp.app.importworkspace={},apogeeapp.app.importworkspace.getImportCallback=function(e,t){return function(){if(e.getWorkspaceUI()){apogeeapp.app.openworkspace.openFile(function(a,p,o){a?alert("Error: "+a.message):apogeeapp.app.importworkspace.openWorkspace(e,t,p,o,function(e){e.getSuccess()||apogeeapp.app.errorHandling.handleActionError(e)})})}else alert("There must be an open workspace to import a workspace.")}},apogeeapp.app.importworkspace.openWorkspace=function(e,t,a,p,o){var n=new apogee.ActionResponse;try{var i=e.getWorkspaceUI(),r=JSON.parse(a),s=r.references,l=i.loadReferences(s),d={};d.name=r.workspace.data.name,t.appendWorkspaceChildren(d,r.workspace.data.children);var u=r.components,g=apogeeapp.app.addcomponent.getAddComponentCallback(e,t,d,u);l.then(g).catch(function(e){alert("Error loading links: "+e),g()})}catch(e){var c=apogee.ActionError.processException(e,apogee.ActionError.ERROR_TYPE_APP,!1);n.addError(c),o(n)}},apogeeapp.app.importworkspace.openWorkspaceFromUrl=function(e,t){apogeeapp.app.importworkspace.openWorkspaceFromUrlImpl(e,t,function(e){e.getSuccess()||apogeeapp.app.errorHandling.handleActionError(e)})},apogeeapp.app.importworkspace.openWorkspaceFromUrlImpl=function(e,t,a){apogeeapp.app.importworkspace.doRequest(t,function(p){apogeeapp.app.importworkspace.openWorkspace(e,p,t,a)},function(e){var t=new apogee.ActionError(e,apogee.ActionError.ERROR_TYPE_APP,null),p=new apogee.ActionResponse;p.addError(t),a(p)})},apogeeapp.app.importworkspace.doRequest=function(e,t,a){var p=new XMLHttpRequest;p.onreadystatechange=function(){var e;4==p.readyState&&200==p.status?t(p.responseText):4==p.readyState&&p.status>=400&&(e="Error in http request. Status: "+p.status,a(e))},p.open("GET",e,!0),p.send()},apogeeapp.app.exportworkspace={},apogeeapp.app.exportworkspace.getExportCallback=function(e){return function(){var t=e.getWorkspaceUI();if(t){var a=t.getFolders(),p=[];for(var o in a)p.push(o);var n=apogeeapp.app.exportworkspace.getExportDialogLayout(p);apogeeapp.app.dialog.showConfigurableDialog(n,function(t){var p=a[t.parentName],o=apogeeapp.app.exportworkspace.getWorkspaceText(e,p);if(o)return apogeeapp.app.saveworkspace.showSaveDialog(o),!0;alert("There is no workspace open.")})}else alert("There is no open workspace.")}},apogeeapp.app.exportworkspace.getWorkspaceText=function(e,t){var a=e.getWorkspaceUI();if(a){var p=a.toJson(t);return JSON.stringify(p)}},apogeeapp.app.exportworkspace.getExportDialogLayout=function(e){var t={},a=[];t.lines=a;var p={type:"title",title:"Export Folder as Workspace"};if(a.push(p),e){var o={type:"dropdown",heading:"Folder: "};o.entries=e,o.resultKey="parentName",a.push(o)}var n={type:"submit",submit:"OK",cancel:"Cancel"};return a.push(n),t},apogeeapp.app.closeworkspace={},apogeeapp.app.closeworkspace.getCloseCallback=function(e){return function(){var t=apogeeapp.app.closeworkspace.closeWorkspace(e);t.getSuccess()||apogeeapp.app.errorHandling.handleActionError(t)}},apogeeapp.app.closeworkspace.closeWorkspace=function(e){var t=new apogee.ActionResponse,a=!1;try{var p=e.getWorkspaceUI();if(null===p){var o=new apogee.ActionError("There is no workspace open.",apogee.ActionError.ERROR_TYPE_USER,null);return t.addError(o),t}var n=p.getWorkspace();if(n.getIsDirty())if(!confirm("There is unsaved data. Are you sure you want to close the workspace?"))return t;a=e.clearWorkspaceUI(),p.close(),n.onClose()}catch(e){var i=!a;o=apogee.ActionError.processException(e,apogee.ActionError.ERROR_TYPE_APP,i);t.addError(o)}return t},apogeeapp.app.addcomponent={},apogeeapp.app.addcomponent.getAddComponentCallback=function(e,t,a,p){return function(){var o=e.getWorkspaceUI();if(o){var n=t.displayName,i=apogee.util.jsonCopy(t.propertyDialogLines),r=o.getFolders(),s=[];for(var l in r)s.push(l);var d=apogeeapp.app.updatecomponent.getPropertiesDialogLayout(n,s,i,!0,a);apogeeapp.app.dialog.showConfigurableDialog(d,function(e){var a=apogee.codeCompiler.validateTableName(e.name);if(!a.valid)return alert(a.errorMessage),!1;var n=r[e.parentName],i={action:"createMember"};i.owner=n,i.workspace=n.getWorkspace(),i.createData=t.getCreateMemberPayload(e);var s=apogee.action.doAction(i,!0),l=i.member;if(l){var d;try{if(!(d=apogeeapp.app.Component.createComponentFromMember(t,o,l,e,p))){var u="Unknown error creating component",g=new apogee.ActionError(u,apogee.ActionError.ERROR_TYPE_APP);s.addError(g)}}catch(e){u="Failed to create UI component: "+e.message,g=new apogee.ActionError(u,apogee.ActionError.ERROR_TYPE_APP),s.addError(g)}if(!d){var c={action:"deleteMember"};c.member=l,apogee.action.doAction(c,!0)}}return s.getSuccess()||apogeeapp.app.errorHandling.handleActionError(s),!0})}else alert("There is no open workspace.")}},apogeeapp.app.addcomponent.getAddAdditionalComponentCallback=function(e,t,a){return function(){var p=e.additionalComponents.map(t=>{var a=e.getComponentGenerator(t);return a?a.displayName:t+" (ERROR - not found!)"});apogeeapp.app.dialog.showSelectComponentDialog(p,e.additionalComponents,function(p){var o=e.getComponentGenerator(p);o?apogeeapp.app.addcomponent.getAddComponentCallback(e,o,t,a)():alert("Unknown component type: "+p)})}},apogeeapp.app.updatecomponent={},apogeeapp.app.updatecomponent.getUpdateComponentCallback=function(e){var t=e.componentGenerator;return function(){var a=t.displayName,p=apogee.util.jsonCopy(t.propertyDialogLines),o=e.getWorkspaceUI(),n=e.getPropertyValues(),i=null,r=null;if(e.getMember().getParent())for(var s in r=[],i=o.getFolders())r.push(s);var l=apogeeapp.app.updatecomponent.getPropertiesDialogLayout(a,r,p,!1,n);apogeeapp.app.dialog.showConfigurableDialog(l,function(t){var a=!1;for(var p in t)t[p]!==n[p]&&(a=!0);if(!a)return!0;if(t.name!==n.name){var o=apogee.codeCompiler.validateTableName(t.name);if(!o.valid)return alert(o.errorMessage),!1}if(i){if(t.owner=i[t.parentName],t.owner==e.getMember())return alert("Illegal destination: you put an object inside itself"),!1}else t.owner=e.getMember().getOwner();var r=apogeeapp.app.updatecomponent.updatePropertyValues(e,n,t);return r.getSuccess()||apogeeapp.app.errorHandling.handleActionError(r),!0})}},apogeeapp.app.updatecomponent.updatePropertyValues=function(e,t,a){var p,o=new apogee.ActionResponse,n=e.getMember(),i=e.getWorkspace(),r=[];t.name===a.name&&t.parentName===a.parentName||((p={}).action="moveMember",p.member=n,p.name=a.name,p.owner=a.owner,r.push(p));var s=n.generator;return s.getPropertyUpdateAction&&(p=s.getPropertyUpdateAction(n,t,a))&&r.push(p),r.length>0&&((p={}).action="compoundAction",p.actions=r,p.workspace=i,o=apogee.action.doAction(p,!0,null,o)),e.componentGenerator.updateProperties&&e.componentGenerator.updateProperties(e,t,a,o),o},apogeeapp.app.updatecomponent.getPropertiesDialogLayout=function(e,t,a,p,o){var n={},i=[];n.lines=i;var r={type:"title"};if(r.title=p?"New "+e:"Update "+e,i.push(r),t){var s={type:"dropdown",heading:"Folder: "};s.entries=t,s.resultKey="parentName",i.push(s)}var l={type:"inputElement",heading:"Name: ",resultKey:"name"};if(i.push(l),a)for(var d=0;d<a.length;d++)i.push(a[d]);var u={type:"submit"};if(u.submit=p?"Create":"Update",u.cancel="Cancel",i.push(u),o)for(d=0;d<i.length;d++){var g=i[d];g.resultKey&&(g.initial=o[g.resultKey])}return n},apogeeapp.app.updatelink={},apogeeapp.app.updatelink.DIALOG_LAYOUT_ADD_JS_TITLE_LINE={type:"title",title:"Add JS Link"},apogeeapp.app.updatelink.DIALOG_LAYOUT_ADD_CSS_TITLE_LINE={type:"title",title:"Add CSS Link"},apogeeapp.app.updatelink.DIALOG_LAYOUT_UPDATE_JS_TITLE_LINE={type:"title",title:"Update JS Link"},apogeeapp.app.updatelink.DIALOG_LAYOUT_UPDATE_CSS_TITLE_LINE={type:"title",title:"Update CSS Link"},apogeeapp.app.updatelink.DIALOG_LAYOUT_URL_LINE={type:"inputElement",heading:"URL: ",resultKey:"url",initial:""},apogeeapp.app.updatelink.DIALOG_LAYOUT_NICKNAME_LINE={type:"inputElement",heading:"Nickname (optional): ",resultKey:"nickname",initial:""},apogeeapp.app.updatelink.DIALOG_LAYOUT_SUBMIT_LINE={type:"submit",submit:"Update",cancel:"Cancel"},apogeeapp.app.updatelink.getAddLinkCallback=function(e,t){return function(){var a=t==apogeeapp.app.LinkEntry.LINK_TYPE_JS?apogeeapp.app.updatelink.DIALOG_LAYOUT_ADD_JS_TITLE_LINE:apogeeapp.app.updatelink.DIALOG_LAYOUT_ADD_CSS_TITLE_LINE,p={lines:[]};p.lines.push(a),p.lines.push(apogeeapp.app.updatelink.DIALOG_LAYOUT_URL_LINE),p.lines.push(apogeeapp.app.updatelink.DIALOG_LAYOUT_NICKNAME_LINE),p.lines.push(apogeeapp.app.updatelink.DIALOG_LAYOUT_SUBMIT_LINE);apogeeapp.app.dialog.showConfigurableDialog(p,function(a){if(!a.url||0===a.url.length)return alert("The url must not be empty"),!1;var p={};return p.url=a.url,p.nickname=a.nickname,p.entryType=t,e.addEntry(p).catch(e=>{alert("There was an error loading the link: "+e)}),!0})}},apogeeapp.app.updatelink.getUpdateLinkCallback=function(e){return function(){var t={};t.url=e.getUrl(),t.nickname=e.getNickname(),t.nickname==t.url&&(t.nickname="");var a=e.getEntryType()==apogeeapp.app.LinkEntry.LINK_TYPE_JS?apogeeapp.app.updatelink.DIALOG_LAYOUT_UPDATE_JS_TITLE_LINE:apogeeapp.app.updatelink.DIALOG_LAYOUT_UPDATE_CSS_TITLE_LINE,p=apogee.util.jsonCopy(apogeeapp.app.updatelink.DIALOG_LAYOUT_URL_LINE);p.initial=t.url;var o=apogee.util.jsonCopy(apogeeapp.app.updatelink.DIALOG_LAYOUT_NICKNAME_LINE);o.initial=t.nickname;var n={lines:[]};n.lines.push(a),n.lines.push(p),n.lines.push(o),n.lines.push(apogeeapp.app.updatelink.DIALOG_LAYOUT_SUBMIT_LINE);apogeeapp.app.dialog.showConfigurableDialog(n,function(t){return t.url&&0!==t.url.length?(e.updateData(t.url,t.nickname),!0):(alert("The url must not be empty"),!1)})}},apogeeapp.app.updatelink.getRemoveLinkCallback=function(e){return function(){confirm("Are you sure you want to delete this link?")&&e.remove()}},apogeeapp.app.ViewMode=function(e,t){this.componentDisplay=e,this.setDisplayDestroyFlags(apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED),this.viewType=t,this.dataDisplay=null,this.modeActive=!1,this.displayInWindow=!1,this.inEditMode=!1;var a=e.getDisplayFrame();this.windowMinimized=a.getWindowState()==apogeeapp.ui.WINDOW_STATE_MINIMIZED,a.addListener(apogeeapp.ui.WINDOW_STATE_CHANGED,e=>this.onWindowStateChange(e)),this.windowLoaded=a.getIsShowing(),a.addListener(apogeeapp.ui.SHOWN_EVENT,()=>this.onWindowLoaded()),a.addListener(apogeeapp.ui.HIDDEN_EVENT,()=>this.onWindowUnloaded()),a.addListener(apogeeapp.ui.RESIZED_EVENT,()=>this.onWindowResized())},apogeeapp.app.ViewMode.UNSAVED_DATA=-1,apogeeapp.app.ViewMode.CLOSE_OK=0,apogeeapp.app.ViewMode.VIEW_STATE_INACTIVE=1,apogeeapp.app.ViewMode.VIEW_STATE_MINIMIZED=2,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_NEVER=0,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE=1,apogeeapp.app.ViewMode.DISPLAY_DESTROY_FLAG_INACTIVE_AND_MINIMIZED=3;apogeeapp.app.ViewMode.prototype.getDisplayWindow=function(){return this.componentDisplay.getDisplayFrame()},apogeeapp.app.ViewMode.prototype.getElement=function(){return this.dataDisplay?this.dataDisplay.getContent():null},apogeeapp.app.ViewMode.prototype.setDisplayDestroyFlags=function(e){this.destroyOnInactive=0!=(e&apogeeapp.app.ViewMode.VIEW_STATE_INACTIVE),this.destroyOnMinimize=0!=(e&apogeeapp.app.ViewMode.VIEW_STATE_MINIMIZED)},apogeeapp.app.ViewMode.prototype.forceClearDisplay=function(){this.destroyDataDisplay()},apogeeapp.app.ViewMode.prototype.setActive=function(){this.modeActive=!0,this.setDisplayState()},apogeeapp.app.ViewMode.prototype.setInactive=function(){this.modeActive=!1,this.setDisplayState()},apogeeapp.app.ViewMode.prototype.destroy=function(){this.destroyDataDisplay()},apogeeapp.app.ViewMode.prototype.isCloseOk=function(){if(this.dataDisplay){if(this.dataDisplay.isCloseOk)return this.dataDisplay.isCloseOk();if(this.inEditMode)return apogeeapp.app.ViewMode.UNSAVED_DATA}return apogeeapp.app.ViewMode.CLOSE_OK},apogeeapp.app.ViewMode.prototype.memberUpdated=function(){this.dataDisplay&&!this.inEditMode&&this.setData()},apogeeapp.app.ViewMode.prototype.onCancel=function(){return this.setData(),!0},apogeeapp.app.ViewMode.prototype.startEditMode=function(e,t){this.inEditMode||(this.inEditMode=!0,this.componentDisplay.startEditUI(e,t))},apogeeapp.app.ViewMode.prototype.endEditMode=function(){this.inEditMode&&(this.inEditMode=!1,this.componentDisplay.endEditUI())},apogeeapp.app.ViewMode.prototype.onWindowStateChange=function(e){this.windowMinimized=e.getWindowState()==apogeeapp.ui.WINDOW_STATE_MINIMIZED,this.setDisplayState()},apogeeapp.app.ViewMode.prototype.onWindowLoaded=function(){this.windowLoaded=!0,this.dataDisplay&&this.dataDisplay.onLoad&&this.modeActive&&this.dataDisplay.onLoad()},apogeeapp.app.ViewMode.prototype.onWindowUnloaded=function(){this.windowLoaded=!1,this.dataDisplay&&this.dataDisplay.onUnload&&this.modeActive&&this.dataDisplay.onUnload()},apogeeapp.app.ViewMode.prototype.onWindowResized=function(){this.dataDisplay&&this.displayInWindow&&this.dataDisplay.onResize&&this.modeActive&&this.dataDisplay.onResize()},apogeeapp.app.ViewMode.prototype.setData=function(){this.dataDisplay.showData()},apogeeapp.app.ViewMode.prototype.setDisplayState=function(){var e=!this.modeActive&&this.destroyOnInactive||this.windowMinimized&&this.destroyOnMinimize;!e&&this.modeActive?this.dataDisplay?this.displayInWindow||this.placeDisplayInWindow():(this.dataDisplay=this.componentDisplay.getDataDisplay(this,this.viewType),this.placeDisplayInWindow(),this.setData()):this.dataDisplay&&(this.displayInWindow&&this.removeDisplayfromWindow(),e&&this.isCloseOk()===apogeeapp.app.ViewMode.CLOSE_OK&&this.destroyDataDisplay())},apogeeapp.app.ViewMode.prototype.placeDisplayInWindow=function(){this.dataDisplay&&(this.componentDisplay.showDataDisplay(this.dataDisplay),this.windowLoaded&&this.dataDisplay.onLoad&&this.dataDisplay.onLoad(),this.displayInWindow=!0)},apogeeapp.app.ViewMode.prototype.removeDisplayfromWindow=function(){this.dataDisplay&&(this.componentDisplay.removeDisplayElement(this.dataDisplay.getContent()),this.windowLoaded&&this.dataDisplay.onUnload&&this.dataDisplay.onUnload(),this.displayInWindow=!1)},apogeeapp.app.ViewMode.prototype.destroyDataDisplay=function(){this.dataDisplay&&(this.dataDisplay.destroy&&this.dataDisplay.destroy(),this.dataDisplay=null)},apogeeapp.app.DataDisplay=class{constructor(e,t,a=apogeeapp.app.DataDisplay.NON_SCROLLING){this.outsideDiv=apogeeapp.ui.createElementWithClass("div",a),this.viewMode=e,this.callbacks=t,this.editOk=!1}setCallbacks(e){this.callbacks=e}save(){var e,t=this.getData();this.endEditMode(),this.callbacks&&this.callbacks.saveData?e=this.callbacks.saveData(t):(alert("Error: Data not saved: save callback not set!"),e=!0),e||this.startEditMode()}cancel(){this.viewMode.onCancel()&&this.endEditMode()}showData(){var e,t;this.callbacks&&(this.callbacks.getData&&(e=this.callbacks.getData()),this.callbacks.getEditOk&&(t=this.callbacks.getEditOk())),void 0===e?(e="DATA UNAVAILABLE",this.editOK=!1):this.editOk=void 0!==t&&t,this.setData(e)}endEditMode(){this.viewMode.endEditMode()}startEditMode(){this.viewMode.startEditMode(()=>this.save(),()=>this.cancel())}onTriggerEditMode(){this.editOk&&this.startEditMode()}},apogeeapp.app.DataDisplay.NON_SCROLLING="apogee_datadisplay_container_fixed",apogeeapp.app.DataDisplay.SCROLLING="apogee_datadisplay_container_scrolling",apogeeapp.app.DataDisplay.FIT_CONTENT="apogee_datadisplay_container_fit_content",apogeeapp.app.dataDisplayCallbackHelper={},apogeeapp.app.dataDisplayCallbackHelper.formatString="\t",apogeeapp.app.dataDisplayCallbackHelper.getMemberDataJsonCallbacks=function(e){return{getData:()=>e.getData(),getEditOk:()=>!e.hasCode(),saveData:t=>apogeeapp.app.dataDisplayCallbackHelper.saveData(e,t)}},apogeeapp.app.dataDisplayCallbackHelper.getMemberDataTextCallbacks=function(e){return{getData:()=>{var t=e.getData();return null===t?"null":void 0===t?"undefined":JSON.stringify(t,null,apogeeapp.app.dataDisplayCallbackHelper.formatString)},getEditOk:()=>!e.hasCode(),saveData:t=>{var a;if(t.length>0)try{a=JSON.parse(t)}catch(e){return alert("There was an error parsing the JSON input: "+e.message),!1}else a="";return apogeeapp.app.dataDisplayCallbackHelper.saveData(e,a)}}},apogeeapp.app.dataDisplayCallbackHelper.getMemberFunctionBodyCallbacks=function(e,t){return{getData:()=>e.getFunctionBody(),getEditOk:()=>!0,saveData:a=>{var p=e.getArgList(),o=a,n=e.getSupplementalCode();return apogeeapp.app.dataDisplayCallbackHelper.setCode(e,p,o,n,t)}}},apogeeapp.app.dataDisplayCallbackHelper.getMemberSupplementalCallbacks=function(e,t){return{getData:()=>e.getSupplementalCode(),getEditOk:()=>!0,saveData:a=>{var p=e.getArgList(),o=e.getFunctionBody(),n=a;return apogeeapp.app.dataDisplayCallbackHelper.setCode(e,p,o,n,t)}}},apogeeapp.app.dataDisplayCallbackHelper.getMemberDescriptionCallbacks=function(e){return{getData:()=>e.getDescription(),getEditOk:()=>!0,saveData:t=>{null!==t&&void 0!==t||(t="");var a={action:"updateDescription"};a.member=e,a.description=t;apogee.action.doAction(a,!0);return!0}}},apogeeapp.app.dataDisplayCallbackHelper.saveData=function(e,t){var a={action:"updateData"};a.member=e,a.data=t;apogee.action.doAction(a,!0);return!0},apogeeapp.app.dataDisplayCallbackHelper.setCode=function(e,t,a,p,o){var n={};void 0!==o&&""==a&&""==p?(n.action="updateData",n.member=e,n.data=o):(n.action="updateCode",n.member=e,n.argList=t,n.functionBody=a,n.supplementalCode=p);apogee.action.doAction(n,!0);return!0},apogeeapp.app.TextAreaEditor=class extends apogeeapp.app.DataDisplay{constructor(e,t){super(e,t,apogeeapp.app.DataDisplay.SCROLLING);var a=apogeeapp.ui.createElement("TEXTAREA",null,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",overflow:"auto"});this.textArea=a,this.textArea.readOnly=!0,this.workingData=null,this.textArea.addEventListener("click",()=>this.onTriggerEditMode())}getContent(){return this.textArea}getContentType(){return apogeeapp.ui.RESIZABLE}getData(){return this.textArea.value}setData(e){this.textArea.value=e,this.editOk?this.textArea.style.backgroundColor="":this.textArea.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR}endEditMode(){this.textArea.readOnly=!0,super.endEditMode()}startEditMode(){super.startEditMode(),this.textArea.readOnly=!1}},apogeeapp.app.AceTextEditor=class extends apogeeapp.app.DataDisplay{constructor(e,t,a){super(e,t,apogeeapp.app.DataDisplay.NON_SCROLLING),this.editorDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.workingData=null;var p=ace.edit(this.editorDiv);p.renderer.setShowGutter(!0),p.setReadOnly(!0),p.setTheme("ace/theme/eclipse"),p.getSession().setMode(a),p.$blockScrolling=1/0,this.editor=p,this.editorDiv.addEventListener("click",()=>this.onTriggerEditMode())}getContent(){return this.editorDiv}getContentType(){return apogeeapp.ui.RESIZABLE}getData(){return this.editor.getSession().getValue()}setData(e){if("String"!=apogee.util.getObjectType(e)){e="ERROR: Data value is not text"}this.editor.getSession().setValue(e),this.editOk?this.editorDiv.style.backgroundColor="":this.editorDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR}onLoad(){this.editor&&this.editor.resize()}onResize(){this.editor&&this.editor.resize()}destroy(){this.editor&&(this.editor.destroy(),this.editor=null)}endEditMode(){this.editor.setReadOnly(!0),super.endEditMode()}startEditMode(){super.startEditMode(),this.editor.setReadOnly(!1)}},apogeeapp.app.HtmlJsDataDisplay=class extends apogeeapp.app.DataDisplay{constructor(e,t,a,p,o){super(e,t,apogeeapp.app.DataDisplay.NON_SCROLLING),this.resource=o,this.member=a,this.isLoaded=!1,this.cachedData=void 0,this.outputElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),p&&(this.outputElement.innerHTML=p);var n={getMessenger:()=>new apogee.action.Messenger(this.member),startEditMode:()=>this.startEditMode(),endEditMode:()=>this.endEditMode()};if(o.constructorAddition)try{o.constructorAddition.call(o,n)}catch(e){alert("Error in "+this.member.getFullName()+" init function: "+e.message)}if(this.resource.onLoad?this.onLoad=(()=>{try{o.onLoad.call(o,this.outputElement,n),this.isLoaded=!0,void 0!=this.cachedData&&(this.setData(this.cachedData),this.cachedData=void 0)}catch(e){alert("Error in "+this.member.getFullName()+" onLoad function: "+e.message)}}):this.isLoaded=!0,this.resource.onUnload&&(this.onUnload=(()=>{try{this.isLoaded=!1,this.cachedData=void 0,this.resource.onHide&&o.onUnload.call(o,this.outputElement,n)}catch(e){alert("Error in "+this.member.getFullName()+" onUnload function: "+e.message)}})),this.resource.onResize&&(this.onResize=(()=>{try{o.onResize.call(o,this.outputElement,n)}catch(e){console.log("Error in "+this.member.getFullName()+" onResize function: "+e.message)}})),this.setData=(e=>{try{if(this.resource.setData){if(!this.isLoaded)return void(this.cachedData=e);o.setData.call(o,e,this.outputElement,n)}else this.setData=(()=>{})}catch(e){alert("Error in "+this.member.getFullName()+" setData function: "+e.message)}}),this.resource.getData?this.getData=(()=>{try{if(this.resource.getData)return this.resource.getData.call(o,this.outputElement,n)}catch(e){alert("Error in "+this.member.getFullName()+" setData function: "+e.message)}}):this.getData=(()=>{}),this.resource.isCloseOk&&(this.isCloseOk=(()=>{try{o.isCloseOk.call(o,this.outputElement,n)}catch(e){alert("Error in "+this.member.getFullName()+" isCloseOk function: "+e.message)}})),this.resource.destroy&&(this.destroy=(()=>{try{o.destroy.call(o,this.outputElement,n)}catch(e){alert("Error in "+this.member.getFullName()+" destroy function: "+e.message)}})),o.init)try{o.init.call(o,this.outputElement,n)}catch(e){alert("Error in "+this.member.getFullName()+" init function: "+e.message)}}getContent(){return this.outputElement}getContentType(){return apogeeapp.ui.RESIZABLE}},apogeeapp.app.JsonFormEditor=function(e){this.editorDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.workingData={d:"c"},this.editOk=!1,this.editor=null;var t=this;this.editCallback=function(){var a=t.editor.getCurrentValue();t.workingData=a,e.onSave(a)}},apogeeapp.app.JsonFormEditor.prototype.getElement=function(){return this.editorDiv},apogeeapp.app.JsonFormEditor.prototype.showData=function(e,t){e===this.workingData&&this.editOk===t||(void 0===e&&(e=null),this.workingData=apogee.util.jsonCopy(e),this.editOk=t,apogeeapp.ui.removeAllChildren(this.editorDiv),this.editor=new apogeeapp.jsonedit.JsonEditArea(this.editorDiv,e,t),this.editor.setEditCallback(this.editCallback),this.editOk?this.editorDiv.style.backgroundColor="":this.editorDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR)},apogeeapp.app.JsonFormEditor.prototype.destroy=function(){},apogeeapp.app.HandsonGridEditor=class extends apogeeapp.app.DataDisplay{constructor(e,t){super(e,t,apogeeapp.app.DataDisplay.NON_SCROLLING),this.gridDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",width:"50px",height:"50px",overflow:"hidden",zIndex:0}),this.inputData=null,this.activeEditOk=void 0,this.dataCached=!1,this.loaded=!1,this.gridEdited=(e=>{this.gridControl&&this.save(arguments)}),this.timerInProcess=!1;this.delayGridEdited=(e=>{if(!this.timerInProcess){this.timerInProcess=!0;setTimeout(e=>{this.timerInProcess=!1,this.gridEdited(arguments)},50)}})}getContent(){return this.gridDiv}getContentType(){return apogeeapp.ui.RESIZABLE}getData(){return this.gridControl&&(this.inputData=apogee.util.jsonCopy(this.gridControl.getData())),this.inputData}setData(e){if(this.inputData!==e||!this.editOk){if(!this.dataIsValidFormat(e)){e=[["ERROR: Data value is not an array of arrays"]]}this.inputData=e,this.dataCached=!0,this.loaded&&this.displayData()}}onLoad(){this.loaded=!0,this.dataCached&&this.displayData()}onUnload(){this.loaded=!1}onResize(){this.setSize()}setSize(){if(this.gridDiv){var e=this.gridDiv.parentElement;e&&(this.gridDiv.style.width=e.clientWidth+"px",this.gridDiv.style.height=e.clientHeight+"px",this.gridControl&&this.gridControl.render())}}destroy(){this.gridControl&&(this.gridControl.destroy(),this.gridControl=null)}createNewGrid(e){var t;this.gridControl&&(this.gridControl.destroy(),this.gridControl=null),this.editOk?(t={data:e,rowHeaders:!0,colHeaders:!0,contextMenu:!0,afterChange:this.gridEdited,afterCreateCol:this.delayGridEdited,afterCreateRow:this.delayGridEdited,afterRemoveCol:this.gridEdited,afterRemoveRow:this.gridEdited},this.gridEditable=!0):(t={data:e,readOnly:!0,rowHeaders:!0,colHeaders:!0},this.gridEditable=!1),this.gridControl=new Handsontable(this.gridDiv,t),this.setSize()}displayData(){this.dataCached=!1;var e=apogee.util.jsonCopy(this.inputData);e||(e=[[]]),this.gridControl&&this.activeEditOk===this.editOk?this.gridControl.loadData(e):(this.createNewGrid(e),this.activeEditOk=this.editOk),this.editOk?this.gridDiv.style.backgroundColor="":this.gridDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR}dataIsValidFormat(e){return!!Array.isArray(e)&&e.every(Array.isArray)}},apogeeapp.app.ConfigurableFormEditor=class extends apogeeapp.app.DataDisplay{constructor(e,t,a){super(e,t,apogeeapp.app.DataDisplay.SCROLLING),this.dynamicLayoutCallback=t.getLayoutInfo,this.panel=new apogeeapp.ui.ConfigurablePanel,a&&this.panel.configureForm(a)}getContent(){return this.panel.getElement()}getContentType(){return apogeeapp.ui.FIXED_SIZE}getData(){return this.panel.getValue()}setData(e){if(this.dynamicLayoutCallback){var t=this.dynamicLayoutCallback();this.panel.configureForm(t)}this.panel.setValue(e);this.panel.addOnChange((t,a)=>{apogee.util.jsonEquals(t,e)?this.endEditMode():this.startEditMode()})}},apogeeapp.app.ConfigurableFormDisplay=class extends apogeeapp.app.DataDisplay{constructor(e,t,a){super(e,t,apogeeapp.app.DataDisplay.SCROLLING),this.panel=this.panel=new apogeeapp.ui.ConfigurablePanel}getContent(){return this.panel.getElement()}getContentType(){return apogeeapp.ui.FIXED_SIZE}setData(e){this.panel.configureForm(e)}},apogeeapp.app.ErrorDisplay=class extends apogeeapp.app.DataDisplay{constructor(e){super(e,{getData:()=>null});var t=apogeeapp.ui.createElement("div");t.style="color:red; font-weight:bold",t.innerHTML="ERROR - Component not loaded!",this.displayElement=t}getContent(){return this.displayElement}getContentType(){return apogeeapp.ui.FIXED_SIZE}setData(e){}},apogeeapp.app.dialog.showConfigurableDialog=function(e,t){for(var a=apogeeapp.ui.createDialog({movable:!0}),p=[],o={onClose:function(){for(var e=0;e<p.length;e++)(s=p[e]).onClose&&s.onClose();apogeeapp.ui.closeDialog(a)},onCancel:function(){o.onClose()},onSubmit:function(){for(var e,a={},n=0;n<p.length;n++)(e=p[n]).addToResult&&e.addToResult(a);t(a)&&o.onClose()}},n=apogeeapp.ui.createElement("div",{className:"dialogBody"}),i=0;i<e.lines.length;i++){var r=e.lines[i],s=apogeeapp.app.dialog.showConfigurableDialog.createLine(r,o);p.push(s),s.element&&n.appendChild(s.element)}a.setContent(n,apogeeapp.ui.SIZE_WINDOW_TO_CONTENT),apogeeapp.ui.showDialog(a),a.fitToContent(),a.centerInParent()},apogeeapp.app.dialog.showConfigurableDialog.createLine=function(e,t){var a=apogeeapp.app.dialog.showConfigurableDialog.lineFunctions[e.type];return a?a(e,t):(alert("Error: Unknown for element type: "+e.type),null)},apogeeapp.app.dialog.showConfigurableDialog.lineFunctions={title:function(e,t){var a={},p=apogeeapp.ui.createElement("div",{className:"dialogLine"});return p.appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:e.title})),a.element=p,a},dropdown:function(e,t){var a={},p=apogeeapp.ui.createElement("div",{className:"dialogLine"});e.heading&&p.appendChild(document.createTextNode(e.heading));for(var o=apogeeapp.ui.createElement("select"),n=0;n<e.entries.length;n++){var i=e.entries[n];o.add(apogeeapp.ui.createElement("option",{text:i}))}return e.initial&&(o.value=e.initial),e.disabled&&(o.disabled=!0),p.appendChild(o),a.element=p,a.addToResult=function(t){var a=o.value;t[e.resultKey]=a},a},inputElement:function(e,t){var a={},p=apogeeapp.ui.createElement("div",{className:"dialogLine"});e.heading&&p.appendChild(document.createTextNode(e.heading));var o=apogeeapp.ui.createElement("input",{type:"text"});return e.initial&&(o.value=e.initial),e.disabled&&(o.disabled=!0),p.appendChild(o),a.element=p,a.addToResult=function(t){var a=o.value.trim();t[e.resultKey]=a},a},aceEditor:function(e,t){},radioButton:function(e,t){},checkbox:function(e,t){var a={},p=apogeeapp.ui.createElement("div",{className:"dialogLine"});e.heading&&p.appendChild(document.createTextNode(e.heading));var o=apogeeapp.ui.createElement("input");return o.type="checkbox",e.name&&(o.name=e.name),e.value&&(o.value=e.value),e.initial&&(o.checked=!0),p.appendChild(o),a.element=p,a.addToResult=function(t){var a=o.checked;t[e.resultKey]=a},a},submit:function(e,t){var a={},p=apogeeapp.ui.createElement("div",{className:"dialogLine"});return e.submit&&p.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:e.submit,onclick:t.onSubmit})),e.cancel&&p.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:e.cancel,onclick:t.onCancel})),a.element=p,a},custom:function(e,t){return e.createLineObject(t)},invisible:function(e,t){var a={element:null,addToResult:function(t){t[e.resultKey]=e.initial}};return a}},apogeeapp.app.dialog.showTextIoDialog=function(e,t){var a=apogeeapp.ui.createDialog({minimizable:!0,maximizable:!0,movable:!0}),p=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",height:"100%",overflow:"auto"});a.setContent(p,apogeeapp.ui.SIZE_WINDOW_TO_CONTENT);var o,n=apogeeapp.ui.createElement("div",null,{display:"table",overflow:"hidden"});p.appendChild(n),e.title&&((o=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle"})),o.innerHTML=e.title,n.appendChild(o)),e.instructions&&((o=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("div")),o.innerHTML=e.instructions,n.appendChild(o)),o=apogeeapp.ui.createElement("div",{className:"dialogLine"});var i=apogeeapp.ui.createElement("div",null,{position:"relative",width:"500px",height:"300px",border:"1px solid darkgray"});o.appendChild(i),n.appendChild(o);var r=ace.edit(i);r.$blockScrolling=1/0,r.setTheme("ace/theme/eclipse"),r.getSession().setMode("ace/mode/text"),e.initialText&&r.getSession().setValue(e.initialText),o=apogeeapp.ui.createElement("div",{className:"dialogLine"});var s=function(){apogeeapp.ui.closeDialog(a),r&&(r.destroy(),r=null)},l=e.submitLabel?e.submitLabel:"Submit";o.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:l,onclick:function(){var e=r.getSession().getValue();t(e)&&s()}})),o.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Cancel",onclick:function(){s()}})),n.appendChild(o),a.setContent(n,apogeeapp.ui.SIZE_WINDOW_TO_CONTENT),apogeeapp.ui.showDialog(a),a.fitToContent(),a.centerInParent()},apogeeapp.app.dialog.showSelectComponentDialog=function(e,t,a){if(e.length!=t.length)throw new Error("Mismatch in additional component display name and class name lists!");var p=apogeeapp.ui.createDialog({movable:!0}),o=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",height:"100%",overflow:"auto"});p.setContent(o,apogeeapp.ui.SIZE_WINDOW_TO_CONTENT);var n,i=apogeeapp.ui.createElement("div",null,{display:"table",overflow:"hidden"});o.appendChild(i),(n=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:"Select Component Type"})),i.appendChild(n),(n=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(document.createTextNode("Component:"));var r=apogeeapp.ui.createElement("select");n.appendChild(r);for(var s=0;s<t.length;s++){var l=e[s],d=t[s];r.add(apogeeapp.ui.createElement("option",{text:l,value:d}))}i.appendChild(n);(n=apogeeapp.ui.createElement("div",{className:"dialogLine"})).appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Create",onclick:function(){var e=r.value;a(e),apogeeapp.ui.closeDialog(p)}})),n.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Cancel",onclick:function(){apogeeapp.ui.closeDialog(p)}})),i.appendChild(n),p.setContent(i,apogeeapp.ui.SIZE_WINDOW_TO_CONTENT),apogeeapp.ui.showDialog(p),p.fitToContent(),p.centerInParent()};