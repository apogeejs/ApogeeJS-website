/*! apogee 0.4.1 */
var apogeeapp={};apogeeapp.ui={},apogeeapp.ui.initResourcePath=function(a){apogeeapp.ui.RESOURCE_DIR=a},apogeeapp.ui.getResourcePath=function(a){return apogeeapp.ui.RESOURCE_DIR+a},apogeeapp.ui.MENU_ZINDEX=100,apogeeapp.ui.WINDOW_FRAME_ZINIDEX=10,apogeeapp.ui.DIALOG_ZINDEX=200,apogeeapp.ui.idIndex=0,apogeeapp.ui.idBase="_visiui_id_",apogeeapp.ui.createId=function(){return apogeeapp.ui.idBase+apogeeapp.ui.idIndex++},apogeeapp.ui.applyStyle=function(a,b){for(var c in b)a.style[c]=b[c]},apogeeapp.ui.MINIMIZE_CMD_IMAGE="/minimize.png",apogeeapp.ui.RESTORE_CMD_IMAGE="/restore.png",apogeeapp.ui.MAXIMIZE_CMD_IMAGE="/maximize.png",apogeeapp.ui.CLOSE_CMD_IMAGE="/close.png",apogeeapp.ui.MENU_IMAGE="/hamburger.png",apogeeapp.ui.removeAllChildren=function(a){for(;a.lastChild;)a.removeChild(a.lastChild)},apogeeapp.ui.createElement=function(a,b,c){var d=document.createElement(a);if(b)for(var e in b)d[e]=b[e];return c&&apogeeapp.ui.applyStyle(d,c),d},apogeeapp.ui.createElementWithClass=function(a,b,c){var d=document.createElement(a);return d.className=b,c&&c.appendChild(d),d},apogeeapp.ui.dialogLayer=null,apogeeapp.ui.BASE_ELEMENT_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",zIndex:1},apogeeapp.ui.DIALOG_LAYER_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",zIndex:2,pointerEvents:"none"},apogeeapp.ui.DIALOG_SHIELD_STYLE={position:"absolute",left:"0px",right:"0px",top:"0px",bottom:"0px",pointerEvents:"auto"},apogeeapp.ui.initWindows=function(a){var b=document.getElementById(a);if(!b)throw apogee.base.createError("Container ID not found: "+a);var c={};return c.baseElement=apogeeapp.ui.createElement("div",null,apogeeapp.ui.BASE_ELEMENT_STYLE),c.dialogLayer=apogeeapp.ui.createElement("div",null,apogeeapp.ui.DIALOG_LAYER_STYLE),b.appendChild(c.baseElement),b.appendChild(c.dialogLayer),apogeeapp.ui.dialogLayer=c.dialogLayer,c},apogeeapp.ui.createDialog=function(a){var b=new apogeeapp.ui.WindowFrame(a);return b},apogeeapp.ui.showDialog=function(a){var b=apogeeapp.ui.createElement("div",null,apogeeapp.ui.DIALOG_SHIELD_STYLE),c=new apogeeapp.ui.WindowParent(b);apogeeapp.ui.dialogLayer.appendChild(b),c.addWindow(a)},apogeeapp.ui.closeDialog=function(a){var b=a.getParent();a.close(),apogeeapp.ui.dialogLayer.removeChild(b.getOuterElement())},apogeeapp.ui.WINDOW_STATE_MINIMIZED=-1,apogeeapp.ui.WINDOW_STATE_NORMAL=0,apogeeapp.ui.WINDOW_STATE_MAXIMIZED=1,apogeeapp.ui.MINIMIZABLE=1,apogeeapp.ui.MAXIMIZABLE=2,apogeeapp.ui.CLOSEABLE=4,apogeeapp.ui.REQUEST_CLOSE="request_close",apogeeapp.ui.DENY_CLOSE=-1,apogeeapp.ui.CLOSE_EVENT="closed",apogeeapp.ui.RESIZED_EVENT="resized",apogeeapp.ui.SHOWN_EVENT="shown",apogeeapp.ui.HIDDEN_EVENT="hidden",apogeeapp.ui.setMemberCssData=function(a,b){var c="css_"+a,d=document.getElementById(c);""!=b?(d||(d=document.createElement("style"),d.id=c,document.head.appendChild(d)),d.innerHTML=b):d&&document.head.removeChild(d)},apogeeapp.ui.WindowParent=function(a){apogee.EventManager.init.call(this),this.containerElement=a,this.windowFrameStack=[],this.prevNewChildX=0,this.prevNewChildY=0,this.wrapCount=0},apogee.base.mixin(apogeeapp.ui.WindowParent,apogee.EventManager),apogeeapp.ui.WindowParent.BASE_ZINDEX=0,apogeeapp.ui.WindowParent.DELTA_CHILD_X=25,apogeeapp.ui.WindowParent.DELTA_CHILD_Y=25,apogeeapp.ui.WindowParent.MAX_WRAP_WIDTH=400,apogeeapp.ui.WindowParent.MAX_WRAP_HEIGHT=400,apogeeapp.ui.WindowParent.prototype.elementIsShown=function(){this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,this)},apogeeapp.ui.WindowParent.prototype.elementIsHidden=function(){this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,this)},apogeeapp.ui.WindowParent.prototype.getOuterElement=function(){return this.containerElement},apogeeapp.ui.WindowParent.prototype.addWindow=function(a){this.containerElement.appendChild(a.getElement()),this.windowFrameStack.push(a),this.updateOrder(),a.setParent(this)},apogeeapp.ui.WindowParent.prototype.removeWindow=function(a){this.containerElement.removeChild(a.getElement());var b=this.windowFrameStack.indexOf(a);this.windowFrameStack.splice(b,1),this.updateOrder()},apogeeapp.ui.WindowParent.prototype.bringToFront=function(a){var b=this.windowFrameStack.indexOf(a);this.windowFrameStack.splice(b,1),this.windowFrameStack.push(a),this.updateOrder()},apogeeapp.ui.WindowParent.prototype.getCenterOnPagePosition=function(a){var b=a.getElement(),c=(this.containerElement.offsetWidth-b.clientWidth)/2,d=(this.containerElement.offsetHeight-b.clientHeight)/2;return[c,d]},apogeeapp.ui.WindowParent.prototype.getNextWindowPosition=function(){var a=this.prevNewChildX+apogeeapp.ui.WindowParent.DELTA_CHILD_X,b=this.prevNewChildY+apogeeapp.ui.WindowParent.DELTA_CHILD_Y;(a>apogeeapp.ui.WindowParent.MAX_WRAP_WIDTH||b>apogeeapp.ui.WindowParent.MAX_WRAP_HEIGHT)&&(this.wrapCount++,a=apogeeapp.ui.WindowParent.DELTA_CHILD_X*(this.wrapCount+1),b=apogeeapp.ui.WindowParent.DELTA_CHILD_Y),this.prevNewChildX=a,this.prevNewChildY=b;var c={};return c.x=a,c.y=b,c},apogeeapp.ui.WindowParent.prototype.updateOrder=function(){for(var a=apogeeapp.ui.WindowParent.BASE_ZINDEX,b=0;b<this.windowFrameStack.length;b++){var c=this.windowFrameStack[b];c.setZIndex(a++)}},apogeeapp.ui.WindowFrame=function(a){a||(a={}),apogee.EventManager.init.call(this),this.windowParent=null,this.parentElement=null,this.options=a,this.windowState=void 0!==a.initialState?a.initialState:apogeeapp.ui.WINDOW_STATE_NORMAL,this.posInfo={},this.posInfo.x=0,this.posInfo.y=0,this.sizeInfo={},this.sizeInfo.width=apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_WIDTH,this.sizeInfo.height=apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_HEIGHT,this.frame=null,this.titleCell=null,this.headerCell=null,this.bodyCell=null,this.headerContent=null,this.content=null,this.windowDragActive=!1,this.moveOffsetX=null,this.moveOffsetX=null,this.moveOnMouseMove=null,this.moveOnMouseLeave=null,this.moveOnMouseUp=null,this.resizeEastActive=!1,this.resizeWestActive=!1,this.resizeNorthActive=!1,this.resizeSouthActive=!1,this.resizeOffsetWidth=null,this.resizeOffsetHeight=null,this.resizeOnMouseUp=null,this.resizeOnMouseMove=null,this.resizeOnMouseLeave=null,this.minWidth=0,this.minHeight=0,this.initUI();var b=this,c=function(a){b.windowParent.bringToFront(b)},d=this.getElement();d.addEventListener("mousedown",c)},apogee.base.mixin(apogeeapp.ui.WindowFrame,apogee.EventManager),apogeeapp.ui.WindowFrame.RESIZE_LOCATION_SIZE=10,apogeeapp.ui.WindowFrame.RESIZE_TOLERANCE=5,apogeeapp.ui.WindowFrame.RESIZE_EAST=1,apogeeapp.ui.WindowFrame.RESIZE_WEST=2,apogeeapp.ui.WindowFrame.RESIZE_SOUTH=4,apogeeapp.ui.WindowFrame.RESIZE_NORTH=8,apogeeapp.ui.WindowFrame.RESIZE_NE=apogeeapp.ui.WindowFrame.RESIZE_NORTH+apogeeapp.ui.WindowFrame.RESIZE_EAST,apogeeapp.ui.WindowFrame.RESIZE_NW=apogeeapp.ui.WindowFrame.RESIZE_NORTH+apogeeapp.ui.WindowFrame.RESIZE_WEST,apogeeapp.ui.WindowFrame.RESIZE_SE=apogeeapp.ui.WindowFrame.RESIZE_SOUTH+apogeeapp.ui.WindowFrame.RESIZE_EAST,apogeeapp.ui.WindowFrame.RESIZE_SW=apogeeapp.ui.WindowFrame.RESIZE_SOUTH+apogeeapp.ui.WindowFrame.RESIZE_WEST,apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_HEIGHT=300,apogeeapp.ui.WindowFrame.DEFAULT_WINDOW_WIDTH=300,apogeeapp.ui.WindowFrame.WINDOW_MINIMIZED="minimized",apogeeapp.ui.WindowFrame.WINDOW_RESTOREDED="restored",apogeeapp.ui.WindowFrame.WINDOW_MAXIMIZED="maximized",apogeeapp.ui.WindowFrame.prototype.getTitle=function(){return this.title},apogeeapp.ui.WindowFrame.prototype.setTitle=function(a){this.title=a,this.titleBarTitleElement.innerHTML=a},apogeeapp.ui.WindowFrame.prototype.createMenu=function(a){return a||(a=apogeeapp.ui.getResourcePath(apogeeapp.ui.MENU_IMAGE)),this.menu=apogeeapp.ui.Menu.createMenuFromImage(a),this.titleBarMenuElement.appendChild(this.menu.getElement()),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_win_icon_overlay_style",this.titleBarMenuElement),this.menu},apogeeapp.ui.WindowFrame.prototype.getMenu=function(){return this.menu},apogeeapp.ui.WindowFrame.prototype.setIconOverlay=function(a){this.iconOverlayElement&&(this.clearIconOverlay(),a&&this.iconOverlayElement.appendChild(a))},apogeeapp.ui.WindowFrame.prototype.clearIconOverlay=function(){this.iconOverlayElement&&apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.WindowFrame.prototype.setHeaderContent=function(a){apogeeapp.ui.removeAllChildren(this.headerCell),this.headerCell.appendChild(a),this.headerContent=a},apogeeapp.ui.WindowFrame.prototype.setContent=function(a){apogeeapp.ui.removeAllChildren(this.bodyCell),this.bodyCell.appendChild(a),this.content=a},apogeeapp.ui.WindowFrame.prototype.addTitleToolElement=function(a){this.titleBarToolElement.appendChild(a)},apogeeapp.ui.WindowFrame.prototype.removeTitleToolElement=function(a){this.titleBarToolElement.removeChild(a)},apogeeapp.ui.WindowFrame.prototype.getParent=function(){return this.windowParent},apogeeapp.ui.WindowFrame.prototype.close=function(a){if(this.windowParent){if(!a){var b=this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this);if(b==apogeeapp.ui.DENY_CLOSE)return}this.windowParent.removeListener(apogeeapp.ui.SHOWN_EVENT,this.windowShownListener),this.windowParent.removeListener(apogeeapp.ui.HIDDEN_EVENT,this.windowHiddenListener),this.windowParent.removeWindow(this),this.windowParent=null,this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this)}},apogeeapp.ui.WindowFrame.prototype.setPosition=function(a,b){a<0&&(a=0),b<0&&(b=0),this.posInfo.x=a,this.posInfo.y=b,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setSize=function(a,b){this.sizeInfo.width=a,this.sizeInfo.height=b,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.getPosInfo=function(){return this.posInfo},apogeeapp.ui.WindowFrame.prototype.setPosInfo=function(a){this.posInfo=a,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.getSizeInfo=function(){return this.sizeInfo},apogeeapp.ui.WindowFrame.prototype.setSizeInfo=function(a){this.sizeInfo=a,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setCoordinateInfo=function(a,b){this.posInfo=a,this.sizeInfo=b,this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.setZIndex=function(a){this.frame.style.zIndex=String(a)},apogeeapp.ui.WindowFrame.prototype.getElement=function(){return this.frame},apogeeapp.ui.WindowFrame.prototype.fitToContent=function(){this.sizeInfo.width=void 0,this.sizeInfo.height=void 0},apogeeapp.ui.WindowFrame.prototype.centerInParent=function(){var a=this.windowParent.getCenterOnPagePosition(this);this.setPosition(a[0],a[1])},apogeeapp.ui.WindowFrame.prototype.getWindowState=function(){return this.windowState},apogeeapp.ui.WindowFrame.prototype.setWindowState=function(a){switch(a){case apogeeapp.ui.WINDOW_STATE_NORMAL:this.restoreContent();break;case apogeeapp.ui.WINDOW_STATE_MINIMIZED:this.minimizeContent();break;case apogeeapp.ui.WINDOW_STATE_MAXIMIZED:this.maximizeContent();break;default:alert("Unknown window state: "+a)}},apogeeapp.ui.WindowFrame.prototype.setParent=function(a){this.windowParent=a,this.parentElement=a.getOuterElement();var b=this;this.windowShownListener=function(a){b.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,b)},this.windowParent.addListener(apogeeapp.ui.SHOWN_EVENT,this.windowShownListener),this.windowHiddenListener=function(a){b.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,b)},this.windowParent.addListener(apogeeapp.ui.HIDDEN_EVENT,this.windowHiddenListener),void 0!==this.sizeInfo.height&&this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.moveMouseDown=function(a){this.windowState!==apogeeapp.ui.WINDOW_STATE_MAXIMIZED&&this.parentElement&&(this.windowDragActive=!0,this.moveOffsetX=a.clientX-this.frame.offsetLeft,this.moveOffsetY=a.clientY-this.frame.offsetTop,this.parentElement.addEventListener("mousemove",this.moveOnMouseMove),this.parentElement.addEventListener("mouseleave",this.moveOnMouseLeave),this.parentElement.addEventListener("mouseup",this.moveOnMouseUp))},apogeeapp.ui.WindowFrame.prototype.moveMouseMoveImpl=function(a){if(this.windowDragActive){var b=a.clientX-this.moveOffsetX;b<0&&(b=0);var c=a.clientY-this.moveOffsetY;c<0&&(c=0),this.posInfo.x=b,this.posInfo.y=c,this.updateCoordinates()}},apogeeapp.ui.WindowFrame.prototype.moveMouseUpImpl=function(a){this.endMove()},apogeeapp.ui.WindowFrame.prototype.moveMouseLeaveImpl=function(a){this.endMove()},apogeeapp.ui.WindowFrame.prototype.resizeMouseDownImpl=function(a,b){this.windowState!==apogeeapp.ui.WINDOW_STATE_MAXIMIZED&&b&&(b&apogeeapp.ui.WindowFrame.RESIZE_EAST?(this.resizeEastActive=!0,this.resizeOffsetWidth=a.clientX-this.bodyCell.clientWidth):b&apogeeapp.ui.WindowFrame.RESIZE_WEST&&(this.resizeWestActive=!0,this.resizeOffsetWidth=a.clientX+this.bodyCell.clientWidth,this.moveOffsetX=a.clientX-this.frame.offsetLeft),b&apogeeapp.ui.WindowFrame.RESIZE_SOUTH?(this.resizeSouthActive=!0,this.resizeOffsetHeight=a.clientY-this.bodyCell.clientHeight):b&apogeeapp.ui.WindowFrame.RESIZE_NORTH&&(this.resizeNorthActive=!0,this.resizeOffsetHeight=a.clientY+this.bodyCell.clientHeight,this.moveOffsetY=a.clientY-this.frame.offsetTop),this.parentElement.addEventListener("mouseup",this.resizeOnMouseUp),this.parentElement.addEventListener("mousemove",this.resizeOnMouseMove),this.parentElement.addEventListener("mouseleave",this.resizeOnMouseLeave))},apogeeapp.ui.WindowFrame.prototype.resizeMouseMoveImpl=function(a){var b,c,d,e,f=!1;this.resizeEastActive?(c=a.clientX-this.resizeOffsetWidth,this.sizeInfo.width=c,f=!0):this.resizeWestActive&&(c=this.resizeOffsetWidth-a.clientX,d=a.clientX-this.moveOffsetX,d<0&&(d=0),this.sizeInfo.width=c,this.posInfo.x=d,f=!0),this.resizeSouthActive?(b=a.clientY-this.resizeOffsetHeight,this.sizeInfo.height=b,f=!0):this.resizeNorthActive&&(b=this.resizeOffsetHeight-a.clientY,e=a.clientY-this.moveOffsetY,e<0&&(e=0),this.sizeInfo.height=b,this.posInfo.y=e,f=!0),f&&this.updateCoordinates()},apogeeapp.ui.WindowFrame.prototype.resizeMouseUpImpl=function(a){this.endResize()},apogeeapp.ui.WindowFrame.prototype.resizeMouseLeaveImpl=function(a){this.endResize()},apogeeapp.ui.WindowFrame.prototype.endMove=function(a){this.windowDragActive=!1,this.parentElement.removeEventListener("mousemove",this.moveOnMouseMove),this.parentElement.removeEventListener("mouseup",this.moveOnMouseUp),this.parentElement.removeEventListener("mouseleave",this.moveOnMouseLeave)},apogeeapp.ui.WindowFrame.prototype.endResize=function(){this.resizeEastActive=!1,this.resizeWestActive=!1,this.resizeSouthActive=!1,this.resizeNorthActive=!1,this.parentElement.removeEventListener("mouseup",this.resizeOnMouseUp),this.parentElement.removeEventListener("mousemove",this.resizeOnMouseMove),this.parentElement.removeEventListener("mouseleave",this.resizeOnMouseLeave)},apogeeapp.ui.WindowFrame.prototype.minimizeContent=function(){this.headerCell.style.display="none",this.bodyCell.style.display="none";var a=this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED;this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_MINIMIZED,this.updateCoordinates(),this.setMinMaxButtons(),a||this.dispatchEvent(apogeeapp.ui.WindowFrame.WINDOW_MINIMIZED,this)},apogeeapp.ui.WindowFrame.prototype.restoreContent=function(){this.headerCell.style.display="",this.bodyCell.style.display="";var a=this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED,b=this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_NORMAL,this.updateCoordinates(),this.setMinMaxButtons(),(a||b)&&this.dispatchEvent(apogeeapp.ui.WindowFrame.WINDOW_RESTOREDED,this)},apogeeapp.ui.WindowFrame.prototype.maximizeContent=function(){this.headerCell.style.display="",this.bodyCell.style.display="";this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED;this.windowState=apogeeapp.ui.WINDOW_STATE_MAXIMIZED,this.updateCoordinates(),this.setMinMaxButtons(),wasMaximized||this.dispatchEvent(apogeeapp.ui.WindowFrame.WINDOW_MAXIMIZED,this)},apogeeapp.ui.WindowFrame.prototype.updateCoordinates=function(){var a=this.bodyCell.style.height,b=this.bodyCell.style.width;this.windowState===apogeeapp.ui.WINDOW_STATE_MAXIMIZED?(this.frame.style.left="0px",this.frame.style.top="0px",this.frame.style.height="100%",this.frame.style.width="100%",this.bodyCell.style.height="100%",this.bodyCell.style.width="100%"):this.windowState===apogeeapp.ui.WINDOW_STATE_NORMAL?(this.frame.style.left=this.posInfo.x+"px",this.frame.style.top=this.posInfo.y+"px",this.frame.style.height="",this.frame.style.width="",void 0!==this.sizeInfo.height?this.bodyCell.style.height=this.sizeInfo.height+"px":this.bodyCell.style.height="",void 0!==this.sizeInfo.width?this.bodyCell.style.width=this.sizeInfo.width+"px":this.bodyCell.style.width=""):this.windowState===apogeeapp.ui.WINDOW_STATE_MINIMIZED&&(this.frame.style.left=this.posInfo.x+"px",this.frame.style.top=this.posInfo.y+"px",this.frame.style.height="",this.frame.style.width="",this.bodyCell.style.height="0px",this.bodyCell.style.width="0px"),a==this.bodyCell.style.height&&b==this.bodyCell.style.width||this.dispatchEvent(apogeeapp.ui.RESIZED_EVENT,this)},apogeeapp.ui.WindowFrame.prototype.initUI=function(){var a,b,c;a=document.createElement("table"),a.className="visiui_win_main",this.frame=a,b=document.createElement("tr"),a.appendChild(b),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_topLeft",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_WEST|apogeeapp.ui.WindowFrame.RESIZE_NORTH),b.appendChild(c),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_top",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_NORTH),b.appendChild(c),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_topRight",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_EAST|apogeeapp.ui.WindowFrame.RESIZE_NORTH),b.appendChild(c),b=document.createElement("tr"),a.appendChild(b),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_left",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_WEST),c.rowSpan=3,b.appendChild(c),c=document.createElement("td"),c.className="visiui_win_windowColorClass",this.titleBarCell=c,b.appendChild(c),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_right",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_EAST),c.rowSpan=3,b.appendChild(c),b=document.createElement("tr"),b.className="visiui_win_headerRow",a.appendChild(b),c=document.createElement("td"),c.className="visiui_win_headerCell",this.headerCell=c,b.appendChild(c),b=document.createElement("tr"),b.className="visiui_win_bodyRow",a.appendChild(b),c=document.createElement("td"),c.className="visiui_win_bodyCell",this.bodyCell=c,b.appendChild(c),b=document.createElement("tr"),a.appendChild(b),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_bottomLeft",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_WEST|apogeeapp.ui.WindowFrame.RESIZE_SOUTH),b.appendChild(c),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_bottom",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_SOUTH),b.appendChild(c),c=document.createElement("td"),c.className="visiui_win_windowColorClass visiui_win_bottomRight",this.addResizeHandlers(c,apogeeapp.ui.WindowFrame.RESIZE_EAST|apogeeapp.ui.WindowFrame.RESIZE_SOUTH),b.appendChild(c),this.createTitleBar()},apogeeapp.ui.WindowFrame.prototype.addResizeHandlers=function(a,b){if(this.options.resizable){var c=this;a.onmousedown=function(a){c.resizeMouseDownImpl(a,b)},this.resizeOnMouseMove||(this.resizeOnMouseMove=function(a){c.resizeMouseMoveImpl(a)},this.resizeOnMouseUp=function(a){c.resizeMouseUpImpl(a)},this.resizeOnMouseLeave=function(a){c.resizeMouseLeaveImpl(a)})}},apogeeapp.ui.WindowFrame.prototype.createTitleBar=function(){this.titleBarElement=apogeeapp.ui.createElementWithClass("div","visiui_win_titleBarClass",this.titleBarCell),this.titleBarLeftElements=apogeeapp.ui.createElementWithClass("div","visiui_win_left_style",this.titleBarElement),this.titleBarMenuElement=apogeeapp.ui.createElementWithClass("div","visiui_win_menu_style",this.titleBarLeftElements),this.titleBarTitleElement=apogeeapp.ui.createElementWithClass("div","visiui_win_title",this.titleBarLeftElements),this.titleBarRightElements=apogeeapp.ui.createElementWithClass("div","visiui_win_right_style",this.titleBarElement),this.titleBarToolElement=apogeeapp.ui.createElementWithClass("div","visiui_win_tool_style",this.titleBarRightElements);var a=this;this.options.minimizable&&(this.minimizeButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.minimizeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.MINIMIZE_CMD_IMAGE),this.minimizeButton.onclick=function(){a.minimizeContent()}),(this.options.minimizable||this.options.maximizable)&&(this.restoreButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.restoreButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.RESTORE_CMD_IMAGE),this.restoreButton.onclick=function(){a.restoreContent()}),this.windowState=apogeeapp.ui.WINDOW_STATE_NORMAL,this.setMinMaxButtons(),this.options.closable&&(this.closeButton=apogeeapp.ui.createElementWithClass("img","visiui_win_cmd_button",this.titleBarRightElements),this.closeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.CLOSE_CMD_IMAGE),this.closeButton.onclick=function(){a.close()}),this.setTitle(""),this.options.movable&&(this.titleBarElement.onmousedown=function(b){a.moveMouseDown(b)},this.moveOnMouseMove=function(b){a.moveMouseMoveImpl(b)},this.moveOnMouseUp=function(b){a.moveMouseUpImpl(b)},this.moveOnMouseLeave=function(b){a.moveMouseLeaveImpl(b)})},apogeeapp.ui.WindowFrame.prototype.setMinMaxButtons=function(){this.minimizeButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_MINIMIZED?this.minimizeButton.style.display="none":this.minimizeButton.style.display=""),this.restoreButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_NORMAL?this.restoreButton.style.display="none":this.restoreButton.style.display=""),this.maximizeButton&&(this.windowState==apogeeapp.ui.WINDOW_STATE_MAXIMIZED?this.maximizeButton.style.display="none":this.maximizeButton.style.display="")},apogeeapp.ui.TabFrame=function(){apogee.EventManager.init.call(this),this.tabTable={},this.activeTab=null,this.tabFrameControl=apogeeapp.ui.createElementWithClass("div","visiui-tf-frame"),this.tabBar=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-bar",this.tabFrameControl),this.tabFrame=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-container",this.tabFrameControl)},apogee.base.mixin(apogeeapp.ui.TabFrame,apogee.EventManager),apogeeapp.ui.TabFrame.CONTAINER_FRAME_MARGIN_PX=5,apogeeapp.ui.TabFrame.prototype.getElement=function(){return this.tabFrameControl},apogeeapp.ui.TabFrame.prototype.getTab=function(a){return this.tabTable[a]},apogeeapp.ui.TabFrame.prototype.addTab=function(a,b){var c=a.getId();if(this.tabTable[c])return alert("There is already a tab with this id!"),null;a.setTabFrame(this),this.tabFrame.appendChild(a.getMainElement());var d=a.getLabelElement();this.tabBar.appendChild(d);var e=this;d.onclick=function(){e.setActiveTab(c)},d.onmousedown=function(a){a.preventDefault()},this.tabTable[c]=a,b||null==this.activeTab?this.setActiveTab(c):this.updateTabDisplay()},apogeeapp.ui.TabFrame.prototype.closeTab=function(a){var b=this.tabTable[a];if(b){this.tabFrame.removeChild(b.getMainElement());var c=b.getLabelElement();if(this.tabBar.removeChild(c),delete c.onclick,delete c.onmousedown,delete this.tabTable[a],this.activeTab==a){this.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,a),this.activeTab=null;for(var d in this.tabTable){this.setActiveTab(d);break}}this.updateTabDisplay()}},apogeeapp.ui.TabFrame.prototype.setActiveTab=function(a){var b=this.tabTable[a];b&&(this.activeTab=a,this.tabFrame.appendChild(b.getMainElement()),this.updateTabDisplay(),this.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,b))},apogeeapp.ui.TabFrame.prototype.updateTabDisplay=function(){var a;for(a in this.tabTable){var b=this.tabTable[a];a==this.activeTab?(b.getMainElement().style.display="",b.getLabelElement().className="visiui-tf-tab-base visiui-tf-tab-active"):(b.getMainElement().style.display="none",b.getLabelElement().className="visiui-tf-tab-base visiui-tf-tab-inactive")}},apogeeapp.ui.Tab=function(a){apogee.EventManager.init.call(this),this.tabFrame=null,this.id=a,this.tabLabelElement=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-base visiui-tf-tab-inactive"),this.menuContainer=apogeeapp.ui.createElementWithClass("div","visiui-tf_tab-menuDiv",this.tabLabelElement),this.titleElement=apogeeapp.ui.createElementWithClass("div","visiui_tf_tab_title",this.tabLabelElement),this.closeButton=apogeeapp.ui.createElementWithClass("img","visiui_tf_tab_cmd_button",this.tabLabelElement),this.closeButton.src=apogeeapp.ui.getResourcePath(apogeeapp.ui.CLOSE_CMD_IMAGE);var b=this;this.closeButton.onclick=function(){b.close()},this.displayFrame=apogeeapp.ui.createElementWithClass("div","visiui-tf-tab-window"),this.tabInsideContainer=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null),this.displayFrame.appendChild(this.tabInsideContainer.getOuterElement()),this.headerContainer=this.tabInsideContainer.getHeaderContainer(),this.bodyContainer=this.tabInsideContainer.getBodyContainer(),this.isShowing=!1},apogee.base.mixin(apogeeapp.ui.Tab,apogee.EventManager),apogeeapp.ui.Tab.prototype.setTabFrame=function(a){this.tabFrame=a;var b=this;this.tabShownListener=function(a){a==b&&b.dispatchEvent(apogeeapp.ui.SHOWN_EVENT,b)},this.tabFrame.addListener(apogeeapp.ui.SHOWN_EVENT,this.tabShownListener),this.tabHiddenListener=function(a){a==b&&b.dispatchEvent(apogeeapp.ui.HIDDEN_EVENT,b)},this.tabFrame.addListener(apogeeapp.ui.HIDDEN_EVENT,this.tabHiddenListener)},apogeeapp.ui.Tab.prototype.makeActive=function(){return!!this.tabFrame&&(this.tabFrame.setActiveTab(this.id),!0)},apogeeapp.ui.Tab.prototype.getId=function(){return this.id},apogeeapp.ui.Tab.prototype.setTitle=function(a){this.titleElement.innerHTML=a,this.title=a},apogeeapp.ui.Tab.prototype.setHeaderContent=function(a){apogeeapp.ui.removeAllChildren(this.headerContainer),this.headerContainer.appendChild(a),this.headerContent=a},apogeeapp.ui.Tab.prototype.setContent=function(a){apogeeapp.ui.removeAllChildren(this.bodyContainer),this.bodyContainer.appendChild(a),this.content=a},apogeeapp.ui.Tab.prototype.getTitle=function(){return this.title},apogeeapp.ui.Tab.prototype.createMenu=function(a){return a||(a=apogeeapp.ui.getResourcePath(apogeeapp.ui.MENU_IMAGE)),this.menu=apogeeapp.ui.Menu.createMenuFromImage(a),this.menuContainer.appendChild(this.menu.domElement),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_tf_icon_overlay",this.menuContainer),this.menu},apogeeapp.ui.Tab.prototype.getMenu=function(){return this.menu},apogeeapp.ui.Tab.prototype.setIconOverlay=function(a){this.iconOverlayElement&&(this.clearIconOverlay(),a&&this.iconOverlayElement.appendChild(a))},apogeeapp.ui.Tab.prototype.clearIconOverlay=function(){this.iconOverlayElement&&apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.ui.Tab.prototype.close=function(a){if(this.tabFrame){if(!a){var b=this.callHandler(apogeeapp.ui.REQUEST_CLOSE,this);if(b==apogeeapp.ui.DENY_CLOSE)return}this.tabFrame.removeListener(apogeeapp.ui.SHOWN_EVENT,this.tabShownListener),this.tabFrame.removeListener(apogeeapp.ui.HIDDEN_EVENT,this.tabHiddenListener),this.tabFrame.closeTab(this.id),this.tabFrame=null,this.dispatchEvent(apogeeapp.ui.CLOSE_EVENT,this)}},apogeeapp.ui.Tab.prototype.getMainElement=function(){return this.displayFrame},apogeeapp.ui.Tab.prototype.getLabelElement=function(){return this.tabLabelElement},apogeeapp.ui.Menu={},apogeeapp.ui.Menu.initialized=!1,apogeeapp.ui.Menu.activeMenu=null,apogeeapp.ui.Menu.createMenu=function(a){var b=apogeeapp.ui.createElementWithClass("div","visiui-menu-heading visiui-menu-text");return b.innerHTML=a,new apogeeapp.ui.MenuHeader(b)},apogeeapp.ui.Menu.createMenuFromImage=function(a){var b=document.createElement("img");b.src=a;var c=apogeeapp.ui.createElementWithClass("div","visiui-menu-heading visiui-menu-image");return c.appendChild(b),new apogeeapp.ui.MenuHeader(c)},apogeeapp.ui.Menu.showContextMenu=function(a,b){a.setPosition(b.clientX,b.clientY,document.body),b.preventDefault(),apogeeapp.ui.Menu.show(a)},apogeeapp.ui.Menu.menuHeaderPressed=function(a){apogeeapp.ui.Menu.activeMenu===a?apogeeapp.ui.Menu.hideActiveMenu():apogeeapp.ui.Menu.show(a.getMenuBody())},apogeeapp.ui.Menu.nonMenuPressed=function(){apogeeapp.ui.Menu.activeMenu&&apogeeapp.ui.Menu.hideActiveMenu()},apogeeapp.ui.Menu.show=function(a){apogeeapp.ui.Menu.activeMenu&&apogeeapp.ui.Menu.hideActiveMenu();var b=a.getParentElement();a.prepareShow();var c=a.getMenuElement();if(b&&c){b.appendChild(c),apogeeapp.ui.Menu.activeMenu=a;var d=a.getMenuHeader();d&&(d.className="visiui-menu-heading visiui-menu-heading-active")}},apogeeapp.ui.Menu.hideActiveMenu=function(){if(apogeeapp.ui.Menu.activeMenu){var a=apogeeapp.ui.Menu.activeMenu,b=a.getMenuHeader();b&&(b.className="visiui-menu-heading");var c=a.getParentElement(),d=a.getMenuElement();c&&d&&(c.removeChild(d),apogeeapp.ui.Menu.activeMenu=null),a.menuHidden()}},apogeeapp.ui.Menu.nonMenuMouseHandler=null,apogeeapp.ui.Menu.initialize=function(){window.addEventListener("mousedown",apogeeapp.ui.Menu.nonMenuPressed),apogeeapp.ui.Menu.initialized=!0},apogeeapp.ui.Menu.deinitialize=function(){window.removeEventListener("mousedown",apogeeapp.ui.Menu.nonMenuPressed),apogeeapp.ui.Menu.initialized=!1},apogeeapp.ui.MenuHeader=function(a){apogeeapp.ui.Menu.initialized||apogeeapp.ui.Menu.initialize(),this.domElement=a,this.menuBody=new apogeeapp.ui.MenuBody,this.initHeadingElement(),this.menuBody.attachToMenuHeader(this)},apogeeapp.ui.MenuHeader.prototype.getElement=function(){return this.domElement},apogeeapp.ui.MenuHeader.prototype.setChildLocation=function(a){this.childLocation=a},apogeeapp.ui.MenuHeader.prototype.getChildLocation=function(){return this.childLocation},apogeeapp.ui.MenuHeader.prototype.getMenuBody=function(){return this.menuBody},apogeeapp.ui.MenuHeader.prototype.addEventMenuItem=function(a,b,c,d){this.menuBody.addEventMenuItem(a,b,c,d)},apogeeapp.ui.MenuHeader.prototype.addCallbackMenuItem=function(a,b){this.menuBody.addCallbackMenuItem(a,b)},apogeeapp.ui.MenuHeader.prototype.addMenuItem=function(a){this.menuBody.addMenuItem(a)},apogeeapp.ui.MenuHeader.prototype.setMenuItems=function(a){this.menuBody.setMenuItems(a)},apogeeapp.ui.MenuHeader.prototype.removeMenuItem=function(a){this.menuBody.removeMenuItem(a)},apogeeapp.ui.MenuHeader.prototype.setAsOnTheFlyMenu=function(a){this.menuBody.setAsOnTheFlyMenu(a)},apogeeapp.ui.MenuHeader.prototype.initHeadingElement=function(){var a=this;this.domElement.onmousedown=function(b){apogeeapp.ui.Menu.menuHeaderPressed(a),b.stopPropagation()}},apogeeapp.ui.MenuBody=function(){apogeeapp.ui.Menu.initialized||apogeeapp.ui.Menu.initialize(),this.menuDiv=null,this.parentElement=null,this.menuItems={},this.createMenuElement(),this.menuHeader=null},apogeeapp.ui.MenuBody.prototype.getMenuElement=function(){return this.menuDiv},apogeeapp.ui.MenuBody.prototype.getParentElement=function(){return this.parentElement},apogeeapp.ui.MenuBody.prototype.getMenuHeader=function(){return this.menuHeader},apogeeapp.ui.MenuBody.prototype.getIsContext=function(){return null==this.menuHeader},apogeeapp.ui.MenuBody.prototype.prepareShow=function(){this.isOnTheFlyMenu&&this.constructItemsForShow()},apogeeapp.ui.MenuBody.prototype.menuHidden=function(){this.isOnTheFlyMenu&&this.destroyItemsForHides()},apogeeapp.ui.MenuBody.prototype.attachToMenuHeader=function(a){this.parentElement=a.getElement(),this.menuDiv.style.left="0%",this.menuDiv.style.top="100%",this.menuHeader=a},apogeeapp.ui.MenuBody.prototype.setPosition=function(a,b,c){this.parentElement=c,c.appendChild(this.menuDiv);
var d=c.offsetWidth,e=c.offsetHeight,f=this.menuDiv.clientWidth,g=this.menuDiv.clientHeight;c.appendChild(this.menuDiv),a+f>d&&a>d/2?this.menuDiv.style.left=a-f+"px":this.menuDiv.style.left=a+"px",b+g>e&&b>e/2?this.menuDiv.style.top=b-g+"px":this.menuDiv.style.top=b+"px"},apogeeapp.ui.MenuBody.prototype.setAsOnTheFlyMenu=function(a){this.isOnTheFlyMenu=!0,this.menuItemsCallback=a},apogeeapp.ui.MenuBody.prototype.addEventMenuItem=function(a,b,c,d){var e={};e.title=a,e.eventName=b,e.eventData=c,e.eventManager=d,this.addMenuItem(e)},apogeeapp.ui.MenuBody.prototype.addCallbackMenuItem=function(a,b){var c={};c.title=a,c.callback=b,this.addMenuItem(c)},apogeeapp.ui.MenuBody.prototype.addMenuItem=function(a){if(a.element=apogeeapp.ui.createElementWithClass("div","visiui-menu-item"),a.element.innerHTML=a.title,a.childMenuItems){var b=this.createChildMenuBody(a.childMenuItems),c=b.getMenuElement();c.style.left="100%",c.style.top="0%",a.element.appendChild(c),a.element.onmousedown=function(a){a.stopPropagation()},a.element.onclick=function(a){a.stopPropagation()}}else a.element.onmousedown=function(a){a.stopPropagation()},a.element.onclick=function(b){apogeeapp.ui.Menu.hideActiveMenu(),a.eventName?a.eventManager.dispatchEvent(a.eventName,a.eventData):a.callback&&a.callback(),b.stopPropagation()};this.menuDiv.appendChild(a.element),this.menuItems[a.title]=a},apogeeapp.ui.MenuBody.prototype.setMenuItems=function(a){for(var b=0;b<a.length;b++)this.addMenuItem(a[b])},apogeeapp.ui.MenuBody.prototype.removeMenuItem=function(a){var b=this.menuItems[a];b&&(this.menuDiv.removeChild(b.element),delete this.menuItems[a])},apogeeapp.ui.MenuBody.prototype.createMenuElement=function(){this.menuDiv=apogeeapp.ui.createElementWithClass("div","visiui-menu-body")},apogeeapp.ui.MenuBody.prototype.constructItemsForShow=function(){if(this.menuItemsCallback){var a=this.menuItemsCallback();this.setMenuItems(a)}},apogeeapp.ui.MenuBody.prototype.destroyItemsForHides=function(){this.menuDiv&&apogeeapp.ui.removeAllChildren(this.menuDiv),this.menuItems={}},apogeeapp.ui.MenuBody.prototype.createChildMenuBody=function(a){var b=new apogeeapp.ui.MenuBody;return b.setMenuItems(a),b},apogeeapp.jsonedit={};var OBJECT_CONSTRUCTOR={}.constructor,ARRAY_CONSTRUCTOR=[].constructor,STRING_CONSTRUCTOR="".constructor,NUMBER_CONSTRUCTOR=(0).constructor,BOOLEAN_CONSTRUCTOR=(!0).constructor;apogeeapp.jsonedit.getObjectType=function(a){return null==a?"value":a.constructor==OBJECT_CONSTRUCTOR?"object":a.constructor==ARRAY_CONSTRUCTOR?"array":"value"},apogeeapp.jsonedit.getValueType=function(a){return null==a?"null":a.constructor==STRING_CONSTRUCTOR?"string":a.constructor==NUMBER_CONSTRUCTOR?"number":a.constructor==BOOLEAN_CONSTRUCTOR?"boolean":"other"},apogeeapp.jsonedit.isBoolString=function(a){return"false"===a||"true"===a},apogeeapp.jsonedit.isNullString=function(a){return"null"===a},apogeeapp.jsonedit.canBeConvertedToNonString=function(a){return isFinite(a)||apogeeapp.jsonedit.isBoolString(a)||apogeeapp.jsonedit.isNullString(a)},apogeeapp.jsonedit.stringToNonString=function(stringValue){var stringToValueCode="value = "+stringValue,value;try{return eval(stringToValueCode),value}catch(error){return stringValue}};var PIXELS_PER_INDENT=10;apogeeapp.jsonedit.createIndentElement=function(a){var b=document.createElement("div");return b.className="indentCell",b.style.width=PIXELS_PER_INDENT*a+"px",b},apogeeapp.jsonedit.createObjectDelimiter=function(a){var b=document.createElement("div");return b.className="objectDelimCell",b.innerHTML=a,b},apogeeapp.jsonedit.createExpandButton=function(a){var b=document.createElement("div");return b.className="buttonCell",b.innerHTML="+",b.onclick=function(){a.setExpanded(!0)},b},apogeeapp.jsonedit.createContractButton=function(a){var b=document.createElement("div");return b.className="buttonCell",b.innerHTML="-",b.onclick=function(){a.setExpanded(!1)},b},apogeeapp.jsonedit.KeyEntry=function(a,b,c,d,e,f,g){this.editArea=a,this.key=c,this.type=d,this.data=e,this.isEditable=f,this.indentLevel=b.getIndentLevel()+1,this.parentValue=b,this.isVirtual=g,this.body=null,this.keyEditObject=null,this.valueEntry=null,this.createBody(this.data)},apogeeapp.jsonedit.KeyEntry.prototype.setKey=function(a){this.key=a,this.keyEditObject.setValue(a)},apogeeapp.jsonedit.KeyEntry.prototype.getInitialKey=function(){return this.key},apogeeapp.jsonedit.KeyEntry.prototype.getCurrentKey=function(){return this.keyEditObject.getValue()},apogeeapp.jsonedit.KeyEntry.prototype.getCurrentValue=function(){return this.valueEntry.getCurrentValue()},apogeeapp.jsonedit.KeyEntry.prototype.getElement=function(){return this.body},apogeeapp.jsonedit.KeyEntry.prototype.getParentValueObject=function(){return this.parentValue},apogeeapp.jsonedit.KeyEntry.prototype.getIndentLevel=function(){return this.indentLevel},apogeeapp.jsonedit.KeyEntry.prototype.setIsVirtual=function(a){this.isVirtual=a,this.keyEditObject.setIsVirtual(a),this.valueEntry.setIsVirtual(a)},apogeeapp.jsonedit.KeyEntry.prototype.updateValueElements=function(){apogeeapp.ui.removeAllChildren(this.body),this.formatBody()},apogeeapp.jsonedit.KeyEntry.prototype.createBody=function(a){this.body=document.createElement("div"),this.body.className="jsonBody",this.createKeyElement(),this.valueEntry=new apogeeapp.jsonedit.ValueEntry(this.editArea,this,a,this.isEditable,this.isVirtual),this.formatBody()},apogeeapp.jsonedit.KeyEntry.prototype.formatBody=function(){this.body.appendChild(apogeeapp.jsonedit.createIndentElement(this.indentLevel)),this.body.appendChild(this.keyEditObject.getElement());for(var a=this.valueEntry.getElementList(),b=0;b<a.length;b++)this.body.appendChild(a[b])},apogeeapp.jsonedit.KeyEntry.prototype.createKeyElement=function(){var a=this.type===apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY&&this.isEditable;if(this.keyEditObject=new apogeeapp.jsonedit.EditField(this.key,this.type,a,this.isVirtual),a){var b=this,c=function(a){b.isVirtual&&b.parentValue.makeVirtualEntryReal(),b.editArea.valueEdited()};this.keyEditObject.setOnEditCallback(c);var d=function(a){b.navigateCells(a)};this.keyEditObject.setNavCallback(d)}},apogeeapp.jsonedit.KeyEntry.prototype.navigateCells=function(a){this.parentValue&&this.parentValue.navigateChildren(this,!0,a)},apogeeapp.jsonedit.KeyEntry.prototype.loadContextMenu=function(a,b){var c=this,d=this.parentValue,e=this.keyEditObject.getElement(),f=this.valueEntry,g=f.getType(),h=this.isVirtual;if(e.oncontextmenu=function(e){if(e.preventDefault(),e.stopPropagation(),c.isEditable){var i=new apogeeapp.ui.MenuBody;h||(i.addCallbackMenuItem("Insert Above",function(){d.insertElement("","",b)}),i.addCallbackMenuItem("Insert Below",function(){d.insertElement("","",b+1)}),b>0&&i.addCallbackMenuItem("Move Up",function(){d.moveChildKeyToNextIndex(b-1)}),b<a-1&&i.addCallbackMenuItem("Move Down",function(){d.moveChildKeyToNextIndex(b)}),c.isVirtual||i.addCallbackMenuItem("Delete Entry",function(){d.deleteChildElement(c)}),"value"==g?(i.addCallbackMenuItem("Convert To Object",function(){f.valueToObject()}),i.addCallbackMenuItem("Convert To Array",function(){f.valueToArray()}),f.convertibleToNumber()&&i.addCallbackMenuItem("Convert To Number",function(){f.valueToNonString()}),f.convertibleToBool()&&i.addCallbackMenuItem("Convert To Boolean",function(){f.valueToNonString()}),f.convertibleToNull()&&i.addCallbackMenuItem("Convert To Null",function(){f.valueToNonString()}),f.convertibleToString()&&i.addCallbackMenuItem("Convert To String",function(){f.valueToString()})):"object"==g?(i.addCallbackMenuItem("Convert To Value",function(){f.convertToValue()}),i.addCallbackMenuItem("Convert To Array",function(){f.objectToArray()})):"array"==g&&(i.addCallbackMenuItem("Convert To Value",function(){f.convertToValue()}),i.addCallbackMenuItem("Convert To Object",function(){f.arrayToObject()}))),apogeeapp.ui.Menu.showContextMenu(i,e)}},"value"==g){var i=this.valueEntry.getValueEditObject();i.getElement().oncontextmenu=e.oncontextmenu}},apogeeapp.jsonedit.KeyEntry.prototype.convertToKeyType=function(a){this.type!=apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY&&(this.type=apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY,this.key=String(a),this.createKeyElement(),apogeeapp.ui.removeAllChildren(this.body),this.formatBody())},apogeeapp.jsonedit.KeyEntry.prototype.convertToIndexType=function(a){this.type!=apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX&&(this.type=apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX,this.key=a,this.createKeyElement(),apogeeapp.ui.removeAllChildren(this.body),this.formatBody())},apogeeapp.jsonedit.ValueEntry=function(a,b,c,d,e){this.editArea=a,this.parent=b,this.data=c,this.isEditable=d,this.type=apogeeapp.jsonedit.getObjectType(c),this.indentLevel=b.getIndentLevel()+1,this.elementList=[],this.isVirtual=e,this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.listDiv=null,this.isExpanded=!0,this.expandedList=[],this.contractedList=[],"value"==this.type?this.createValueEntry(this.data):(this.createChildKeyEntries(this.data),this.updateChildKeys(),this.createElementList())},apogeeapp.jsonedit.ValueEntry.prototype.getInitialValue=function(){return this.data},apogeeapp.jsonedit.ValueEntry.prototype.getCurrentValue=function(){var a,b,c;if("value"==this.type)a=this.valueEditObject.getValue();else if("object"==this.type)for(a={},b=0;b<this.childKeyEntries.length;b++)c=this.childKeyEntries[b],a[c.getCurrentKey()]=c.getCurrentValue();else if("array"==this.type)for(a=[],b=0;b<this.childKeyEntries.length;b++)c=this.childKeyEntries[b],a[b]=c.getCurrentValue();return a},apogeeapp.jsonedit.ValueEntry.prototype.getType=function(){return this.type},apogeeapp.jsonedit.ValueEntry.prototype.setExpanded=function(a){this.isExpanded=a,this.doExpandContract()},apogeeapp.jsonedit.ValueEntry.prototype.getElementList=function(){return this.elementList},apogeeapp.jsonedit.ValueEntry.prototype.getValueEditObject=function(){return this.valueEditObject},apogeeapp.jsonedit.ValueEntry.prototype.getIndentLevel=function(){return this.indentLevel},apogeeapp.jsonedit.ValueEntry.prototype.setIsVirtual=function(a){this.isVirtual=a,this.valueEditObject.setIsVirtual(a)},apogeeapp.jsonedit.ValueEntry.prototype.navigateCells=function(a){var b=this.parent.getParentValueObject();b&&b.navigateChildren(this.parent,!1,a)},apogeeapp.jsonedit.ValueEntry.prototype.navigateChildren=function(a,b,c){var d,e=!1,f=0;if("array"==this.type?c==apogeeapp.jsonedit.EditField.DIRECTION_NEXT||c==apogeeapp.jsonedit.EditField.DIRECTION_DOWN?(d=!b,d&&(e=!1,f=1)):c==apogeeapp.jsonedit.EditField.DIRECTION_PREV||c==apogeeapp.jsonedit.EditField.DIRECTION_UP?(d=!b,d&&(e=!1,f=-1)):c!=apogeeapp.jsonedit.EditField.DIRECTION_RIGHT&&c!=apogeeapp.jsonedit.EditField.DIRECTION_LEFT||(d=!1):"object"==this.type&&(c==apogeeapp.jsonedit.EditField.DIRECTION_NEXT?(d=!0,e=!b,f=b?0:1):c==apogeeapp.jsonedit.EditField.DIRECTION_PREV?(d=!0,e=!b,f=b?-1:0):c==apogeeapp.jsonedit.EditField.DIRECTION_RIGHT?(d=b,d&&(e=!1,f=0)):c==apogeeapp.jsonedit.EditField.DIRECTION_LEFT?(d=!b,d&&(e=!0,f=0)):c==apogeeapp.jsonedit.EditField.DIRECTION_UP?(d=!0,e=b,f=-1):c==apogeeapp.jsonedit.EditField.DIRECTION_DOWN&&(d=!0,e=b,f=1)),d){var g,h,i=-1,j=null;if(g=a==this.virtualChildKey?this.childKeyEntries.length:this.childKeyEntries.indexOf(a),g>=0&&(i=g+f,i>=0&&i<this.childKeyEntries.length?j=this.childKeyEntries[i]:i==this.childKeyEntries.length&&(j=this.virtualChildKey)),j)if(e)h=j.keyEditObject;else{var k=j.valueEntry;"value"==k.getType()&&(h=k.valueEditObject)}h&&h.startEdit()}},apogeeapp.jsonedit.ValueEntry.prototype.insertElement=function(a,b,c){var d;void 0===c&&(c=this.childKeyEntries.length);var e;if(e=c>=this.childKeyEntries.length?this.virtualChildKey.getElement():this.childKeyEntries[c].getElement(),"object"==this.type)d=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,a,"key",b,this.isEditable,(!1));else if("array"==this.type){d=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,c,"index",b,this.isEditable,(!1));for(var f=c+1;f<this.childKeyEntries.length;f++)this.childKeyEntries[f].setKey(f);this.virtualChildKey.setKey(this.childKeyEntries.length+1)}this.childKeyEntries.splice(c,0,d),this.updateChildKeys(),this.listDiv.insertBefore(d.getElement(),e)},apogeeapp.jsonedit.ValueEntry.prototype.moveChildKeyToNextIndex=function(a){if(a<0||a>=this.childKeyEntries.length-1)return void alert("Can not make the specified key move");var b=this.childKeyEntries[a],c=this.childKeyEntries[a+1];this.childKeyEntries[a]=c,this.childKeyEntries[a+1]=b,this.updateChildKeys(),this.listDiv.insertBefore(c.getElement(),b.getElement())},apogeeapp.jsonedit.ValueEntry.prototype.deleteChildElement=function(a){var b=this.childKeyEntries.indexOf(a);return b==-1?void alert("Element not found!"):(this.childKeyEntries.splice(b,1),this.updateChildKeys(),void this.listDiv.removeChild(a.getElement()))},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToNumber=function(){if("value"===this.type){var a=this.getCurrentValue(),b=apogeeapp.jsonedit.getValueType(a);if("string"===b)return isFinite(a)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToBool=function(){if("value"===this.type){var a=this.getCurrentValue(),b=apogeeapp.jsonedit.getValueType(a);if("string"===b)return apogeeapp.jsonedit.isBoolString(a)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToNull=function(){if("value"===this.type){var a=this.getCurrentValue(),b=apogeeapp.jsonedit.getValueType(a);if("string"===b)return apogeeapp.jsonedit.isNullString(a)}return!1},apogeeapp.jsonedit.ValueEntry.prototype.valueToNonString=function(){var a=this.getCurrentValue(),b=apogeeapp.jsonedit.stringToNonString(a);this.valueEditObject.setValue(b),this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.convertibleToString=function(){if("value"===this.type){var a=this.getCurrentValue(),b=apogeeapp.jsonedit.getValueType(a);return"string"!==b}return!1},apogeeapp.jsonedit.ValueEntry.prototype.valueToString=function(){var a=this.getCurrentValue(),b=String(a);this.valueEditObject.setValue(b),this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.valueToArray=function(){if("value"==!this.type)throw"Type value expected. Found "+this.type;this.type="array";var a=[this.valueEditObject.getValue()];if(this.createChildKeyEntries(a),this.updateChildKeys(),this.createElementList(),this.parent){var b=this.parent.getParentValueObject();b&&b.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.valueToObject=function(){if("value"==!this.type)throw"Type value expected. Found "+this.type;this.type="object";var a={a:this.valueEditObject.getValue()};if(this.createChildKeyEntries(a),this.updateChildKeys(),this.createElementList(),this.parent){var b=this.parent.getParentValueObject();b&&b.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.objectToArray=function(){if("object"==!this.type)throw"Type object expected. Found "+this.type;this.type="array";var a=0;if(this.childKeyEntries)for(a=0;a<this.childKeyEntries.length;a++){var b=this.childKeyEntries[a];b.convertToIndexType(a)}if(this.virtualChildKey&&this.virtualChildKey.convertToIndexType(a),this.valueEditObject=null,this.updateChildKeys(),this.createElementList(),this.parent){var c=this.parent.getParentValueObject();c&&c.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.arrayToObject=function(){if("array"==!this.type)throw"Type array expected. Found "+this.type;this.type="object";var a=0;if(this.childKeyEntries)for(a=0;a<this.childKeyEntries.length;a++){var b=this.childKeyEntries[a];b.convertToKeyType(String(a))}if(this.virtualChildKey&&this.virtualChildKey.convertToKeyType(""),this.updateChildKeys(),this.createElementList(),this.parent){var c=this.parent.getParentValueObject();c&&c.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()},apogeeapp.jsonedit.ValueEntry.prototype.convertToValue=function(){if("value"!=this.type){this.type="value";var a;if(this.childKeyEntries&&this.childKeyEntries.length>0){var b=this.childKeyEntries[0];a=b.getCurrentValue()}else a="";if(this.createValueEntry(a),this.parent){var c=this.parent.getParentValueObject();c&&c.updateChildKeys(),this.parent.updateValueElements()}this.editArea.valueEdited()}},apogeeapp.jsonedit.ValueEntry.prototype.createValueEntry=function(a){"value"==this.type&&(this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.elementList=[],this.createValueElement(a),this.listDiv=null,this.contractedList=null,this.expandedList=null)},apogeeapp.jsonedit.ValueEntry.prototype.createChildKeyEntries=function(a){if("value"!=this.type){this.valueEditObject=null,this.childKeyEntries=[],this.virtualChildKey=null,this.elementList=[];var b;if("object"==this.type){for(var c in a)b=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,c,"key",a[c],this.isEditable,(!1)),this.childKeyEntries.push(b);this.isEditable&&(b=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,"","key","",this.isEditable,(!0)),this.virtualChildKey=b)}else if("array"==this.type){for(var d=0;d<a.length;d++)b=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,d,"index",a[d],this.isEditable,(!1)),this.childKeyEntries.push(b);this.isEditable&&(b=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,d,"index","",this.isEditable,(!0)),this.virtualChildKey=b)}}},apogeeapp.jsonedit.ValueEntry.prototype.createElementList=function(){this.listDiv=document.createElement("div"),this.elementList=[],this.contractedList=[],this.expandedList=[];for(var a,b,c,d,e=apogeeapp.jsonedit.createIndentElement(this.indentLevel),f=0;f<this.childKeyEntries.length;f++)d=this.childKeyEntries[f],this.listDiv.appendChild(d.getElement());this.virtualChildKey&&this.listDiv.appendChild(this.virtualChildKey.getElement());var g=apogeeapp.jsonedit.createExpandButton(this),h=apogeeapp.jsonedit.createContractButton(this);"object"==this.type?(a=apogeeapp.jsonedit.createObjectDelimiter("{"),b=apogeeapp.jsonedit.createObjectDelimiter("}"),c=apogeeapp.jsonedit.createObjectDelimiter("}")):"array"==this.type&&(a=apogeeapp.jsonedit.createObjectDelimiter("["),b=apogeeapp.jsonedit.createObjectDelimiter("]"),c=apogeeapp.jsonedit.createObjectDelimiter("]")),this.elementList.push(a),this.elementList.push(g),this.contractedList.push(g),this.elementList.push(b),this.contractedList.push(b),this.elementList.push(h),this.expandedList.push(h),(this.childKeyEntries.length>0||this.virtualChildKey)&&(this.elementList.push(this.listDiv),this.expandedList.push(this.listDiv),this.elementList.push(e),this.expandedList.push(e)),this.elementList.push(c),this.expandedList.push(c),this.doExpandContract()},apogeeapp.jsonedit.ValueEntry.prototype.updateChildKeys=function(){var a,b;if("object"==this.type){var c;a=0;for(c in this.childKeyEntries)a++;b=0;for(c in this.childKeyEntries){var d=this.childKeyEntries[c];d.loadContextMenu(a,b),b++}this.virtualChildKey&&this.virtualChildKey.loadContextMenu(a,a)}else if("array"==this.type){for(a=this.childKeyEntries.length,b=0;b<a;b++)d=this.childKeyEntries[b],d.getCurrentKey()!=b&&d.setKey(b),d.loadContextMenu(a,b);this.virtualChildKey&&(this.virtualChildKey.getCurrentKey()!=a&&this.virtualChildKey.setKey(a),this.virtualChildKey.loadContextMenu(a,a))}},apogeeapp.jsonedit.ValueEntry.prototype.doExpandContract=function(){if(this.expandedList&&this.contractedList){var a,b,c=this.isExpanded?this.expandedList:this.contractedList,d=this.isExpanded?this.contractedList:this.expandedList;for(a=0;a<c.length;a++)b=c[a],b.style.display="";for(a=0;a<d.length;a++)b=d[a],b.style.display="none"}},apogeeapp.jsonedit.ValueEntry.prototype.createValueElement=function(a){this.valueEditObject=new apogeeapp.jsonedit.EditField(a,apogeeapp.jsonedit.EditField.FIELD_TYPE_VALUE,this.isEditable,this.isVirtual);var b=this,c=function(a){if(b.isVirtual){var c=b.parent.getParentValueObject();c&&c.makeVirtualEntryReal()}b.editArea.valueEdited()};this.valueEditObject.setOnEditCallback(c);var d=function(a){b.navigateCells(a)};this.valueEditObject.setNavCallback(d);var e=this.valueEditObject.getElement();this.elementList.push(e)},apogeeapp.jsonedit.ValueEntry.prototype.makeVirtualEntryReal=function(a){var b=this.virtualChildKey;b.setIsVirtual(!1),this.childKeyEntries.push(b);var c;"object"==this.type?(c=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,"","key","",this.isEditable,(!0)),this.virtualChildKey=c):"array"==this.type&&(c=new apogeeapp.jsonedit.KeyEntry(this.editArea,this,this.childKeyEntries.length,"index","",this.isEditable,(!0)),this.virtualChildKey=c),this.updateChildKeys(),this.createElementList(),this.parent.updateValueElements()},apogeeapp.jsonedit.EditField=function(a,b,c,d){this.fieldType=b,this.isEditable=c,this.isVirtual=d,this.element=document.createElement("div"),this.onEdit=null,this.onNavigate=null,this.editField=null;var e=this;this.element.onclick=function(){e.onClick()},this.setValue(a)},apogeeapp.jsonedit.EditField.FIELD_TYPE_VALUE="value",apogeeapp.jsonedit.EditField.FIELD_TYPE_KEY="key",apogeeapp.jsonedit.EditField.FIELD_TYPE_INDEX="index",apogeeapp.jsonedit.EditField.prototype.setOnEditCallback=function(a){return this.onEdit=a},apogeeapp.jsonedit.EditField.prototype.setNavCallback=function(a){this.onNavigate=a},apogeeapp.jsonedit.EditField.prototype.setIsVirtual=function(a){this.isVirtual=a,this.setCssClass()},apogeeapp.jsonedit.EditField.prototype.getValue=function(){return this.value},apogeeapp.jsonedit.EditField.prototype.setValue=function(a){void 0===a&&(a=null,console.log("The value undefined is not valid for a JSON. It has been converted to null.")),this.value=a,this.isString="string"===apogeeapp.jsonedit.getValueType(a),this.setCssClass(),null===a?this.element.innerHTML="null":""===a?this.element.innerHTML="&nbsp;":this.element.innerHTML=a},apogeeapp.jsonedit.EditField.prototype.setCssClass=function(){var a="cell_base cell_"+this.fieldType;this.isVirtual?a+="_virtual":"value"===this.fieldType&&(a+=this.isString?"_string":"_nonstring"),this.element.className=a},apogeeapp.jsonedit.EditField.prototype.getElement=function(){return this.element},apogeeapp.jsonedit.EditField.prototype.onClick=function(){this.isEditable&&!this.editField&&this.startEdit()},apogeeapp.jsonedit.EditField.prototype.startEdit=function(){if(!this.editField){var a,b=getSelection();b.anchorNode.parentNode==this.element?(a={},b.anchorOffset<=b.focusOffset?(a.start=b.anchorOffset,a.end=b.focusOffset):(a.start=b.focusOffset,a.end=b.anchorOffset)):a=null,this.editField=document.createElement("input"),this.editField.type="text",void 0!==this.value&&(this.editField.value=this.value),apogeeapp.ui.removeAllChildren(this.element),this.element.appendChild(this.editField),a?this.editField.setSelectionRange(a.start,a.end):this.editField.select(),this.editField.focus();var c=this;this.editField.onblur=function(){c.endEdit()},this.editField.onkeydown=function(a){c.onKeyDown(a)}}},apogeeapp.jsonedit.EditField.prototype.endEdit=function(){if(this.editField){var a=this.editField.value;if(a!=this.value){var b,c=this.editField.value;b=this.isString&&""!==this.value?c:apogeeapp.jsonedit.canBeConvertedToNonString(c)?apogeeapp.jsonedit.stringToNonString(c):c,this.editField=null,this.setValue(b),this.onEdit&&this.onEdit(this.value)}else this.editField=null,this.element.innerHTML=this.value}},apogeeapp.jsonedit.EditField.DIRECTION_NONE=0,apogeeapp.jsonedit.EditField.DIRECTION_UP=1,apogeeapp.jsonedit.EditField.DIRECTION_DOWN=2,apogeeapp.jsonedit.EditField.DIRECTION_RIGHT=3,apogeeapp.jsonedit.EditField.DIRECTION_LEFT=4,apogeeapp.jsonedit.EditField.DIRECTION_NEXT=5,apogeeapp.jsonedit.EditField.DIRECTION_PREV=6,apogeeapp.jsonedit.EditField.ENTER_KEY=13,apogeeapp.jsonedit.EditField.TAB_KEY=9,apogeeapp.jsonedit.EditField.UP_KEY=38,apogeeapp.jsonedit.EditField.DOWN_KEY=40,apogeeapp.jsonedit.EditField.RIGHT_KEY=39,apogeeapp.jsonedit.EditField.LEFT_KEY=37,apogeeapp.jsonedit.EditField.prototype.onKeyDown=function(a){var b=!1,c=apogeeapp.jsonedit.EditField.DIRECTION_NONE,d=!1;a.keyCode==apogeeapp.jsonedit.EditField.ENTER_KEY?(b=!0,c=a.shiftKey?apogeeapp.jsonedit.EditField.DIRECTION_PREV:apogeeapp.jsonedit.EditField.DIRECTION_NEXT,d=!0):a.keyCode==apogeeapp.jsonedit.EditField.TAB_KEY?(b=!0,c=a.shiftKey?apogeeapp.jsonedit.EditField.DIRECTION_PREV:apogeeapp.jsonedit.EditField.DIRECTION_NEXT,d=!0):a.keyCode==apogeeapp.jsonedit.EditField.UP_KEY?(b=!0,c=apogeeapp.jsonedit.EditField.DIRECTION_UP,d=!0):a.keyCode==apogeeapp.jsonedit.EditField.DOWN_KEY?(b=!0,c=apogeeapp.jsonedit.EditField.DIRECTION_DOWN,d=!0):a.keyCode==apogeeapp.jsonedit.EditField.RIGHT_KEY?this.cursorAtEndOfEditField()&&(b=!0,c=apogeeapp.jsonedit.EditField.DIRECTION_RIGHT,d=!0):a.keyCode==apogeeapp.jsonedit.EditField.LEFT_KEY&&this.cursorAtStartOfEditField()&&(b=!0,c=apogeeapp.jsonedit.EditField.DIRECTION_LEFT,d=!0),d&&(a.preventDefault(),a.stopPropagation()),b&&(this.endEdit(),c!=apogeeapp.jsonedit.EditField.DIRECTION_NONE&&this.onNavigate&&this.onNavigate(c))},apogeeapp.jsonedit.EditField.prototype.cursorAtStartOfEditField=function(){return 0==this.editField.selectionStart&&0==this.editField.selectionEnd},apogeeapp.jsonedit.EditField.prototype.cursorAtEndOfEditField=function(){var a=String(this.editField.value).length;return this.editField.selectionStart==a&&this.editField.selectionEnd==a},apogeeapp.jsonedit.JsonEditArea=function(a,b,c){this.body=a,this.isEditable=c,void 0===b&&(b=""),this.valueEntry=new apogeeapp.jsonedit.ValueEntry(this,this,b,this.isEditable),this.valueEntry.setExpanded(!0),this.formatBody()},apogeeapp.jsonedit.JsonEditArea.prototype.setEditCallback=function(a){this.editCallback=a},apogeeapp.jsonedit.JsonEditArea.prototype.getCurrentValue=function(){return this.valueEntry.getCurrentValue()},apogeeapp.jsonedit.JsonEditArea.prototype.getElement=function(){return this.body},apogeeapp.jsonedit.JsonEditArea.prototype.getParentValueObject=function(){},apogeeapp.jsonedit.JsonEditArea.prototype.getIndentLevel=function(){return 0},apogeeapp.jsonedit.JsonEditArea.prototype.formatBody=function(){for(var a=this.valueEntry.getElementList(),b=0;b<a.length;b++)this.body.appendChild(a[b]);this.loadContextMenu()},apogeeapp.jsonedit.JsonEditArea.prototype.loadContextMenu=function(){var a=this,b=this.body,c=this.valueEntry,d=c.getType();b.oncontextmenu=function(b){b.preventDefault(),b.stopPropagation();var e=new apogeeapp.ui.MenuBody;e.addCallbackMenuItem("Get Value",function(){alert(JSON.stringify(c.getCurrentValue()))}),a.isEditable&&("value"==d?(e.addCallbackMenuItem("Convert To Object",function(){c.valueToObject()}),e.addCallbackMenuItem("Convert To Array",function(){c.valueToArray()}),c.convertibleToNumber()&&e.addCallbackMenuItem("Convert To Number",function(){c.valueToNonString()}),c.convertibleToBool()&&e.addCallbackMenuItem("Convert To Boolean",function(){c.valueToNonString()}),c.convertibleToNull()&&e.addCallbackMenuItem("Convert To Null",function(){c.valueToNonString()}),c.convertibleToString()&&e.addCallbackMenuItem("Convert To String",function(){c.valueToString()})):"object"==d?(e.addCallbackMenuItem("Convert To Value",function(){c.convertToValue()}),e.addCallbackMenuItem("Convert To Array",function(){c.objectToArray()})):"array"==d&&(e.addCallbackMenuItem("Convert To Value",function(){c.convertToValue()}),e.addCallbackMenuItem("Convert To Object",function(){c.arrayToObject()}))),apogeeapp.ui.Menu.showContextMenu(e,b)}},apogeeapp.jsonedit.JsonEditArea.prototype.updateValueElements=function(){apogeeapp.ui.removeAllChildren(this.body),this.formatBody()},apogeeapp.jsonedit.JsonEditArea.prototype.valueEdited=function(){this.editCallback&&this.editCallback()},apogeeapp.ui.setLoadListener=function(a,b,c){var d={position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",overflow:"hidden",zIndex:-1},e=apogeeapp.ui.createElement("iframe",null,d);e.onload=function(){var a=e.contentDocument.body;b&&b(),c&&(c(),a.onresize=c)},a.appendChild(e)},apogeeapp.ui.removeResizeListener=function(a,b){alert("implement this!")},apogeeapp.ui.DisplayAndHeader=function(a,b,c,d){this.container=apogeeapp.ui.createElementWithClass("div","visiui-dnh-container"),this.header=apogeeapp.ui.createElementWithClass("div","visiui-dnh-header",this.container),this.body=apogeeapp.ui.createElementWithClass("div","visiui-dnh-body",this.container),this.headerStyleClass=b,this.bodyStyleClass=d,this.headerContent=document.createElement("div"),this.header.appendChild(this.headerContent),this.bodyContent=document.createElement("div"),this.body.appendChild(this.bodyContent),this.setHeaderType(a),this.setBodyType(c)},apogeeapp.ui.DisplayAndHeader.FIXED_PANE="visiui-dnh-fixed",apogeeapp.ui.DisplayAndHeader.SCROLLING_PANE="visiui-dnh-scrolling",apogeeapp.ui.DisplayAndHeader.prototype.setHeaderType=function(a){var b=a;this.headerStyleClass&&(b+=" "+this.headerStyleClass),this.headerContent.className=b},apogeeapp.ui.DisplayAndHeader.prototype.setBodyType=function(a){var b=a;this.bodyStyleClass&&(b+=" "+this.bodyStyleClass),this.bodyContent.className=b},apogeeapp.ui.DisplayAndHeader.prototype.getOuterElement=function(){return this.container},apogeeapp.ui.DisplayAndHeader.prototype.getHeaderContainer=function(){return this.header},apogeeapp.ui.DisplayAndHeader.prototype.getBodyContainer=function(){return this.body},apogeeapp.ui.DisplayAndHeader.prototype.getHeader=function(){return this.headerContent},apogeeapp.ui.DisplayAndHeader.prototype.getBody=function(){return this.bodyContent},apogeeapp.ui.SplitPane=function(a,b){this.container1=apogeeapp.ui.createElementWithClass("div","visiui-sp-parent");var c=apogeeapp.ui.createElementWithClass("div","visiui-sp-parent2",this.container1),d=apogeeapp.ui.createElementWithClass("table","visiui-sp-table",c),e=apogeeapp.ui.createElementWithClass("tr","visiui-sp-row",d),f=apogeeapp.ui.createElementWithClass("td","visiui-sp-left",e),g=apogeeapp.ui.createElementWithClass("td","visiui-sp-divider",e),h=apogeeapp.ui.createElementWithClass("td","visiui-sp-right",e),i=apogeeapp.ui.createElementWithClass("div","visiui-sp-inner",f);this.leftOuterPane=apogeeapp.ui.createElementWithClass("div",a,i);var j=apogeeapp.ui.createElementWithClass("div","visiui-sp-inner",h);this.rightOuterPane=apogeeapp.ui.createElementWithClass("div",b,j);var k=!1,l=0,m=0,n=function(a){k=!0,l=a.clientX,m=f.offsetWidth,d.addEventListener("mouseup",p),d.addEventListener("mousemove",o),d.addEventListener("mouseleave",q)},o=function(a){if(k){var b=a.clientX-l;f.style.width=m+b+"px"}},p=function(a){r()},q=function(a){r()},r=function(){k=!1,d.removeEventListener("mouseup",p),d.removeEventListener("mousemove",o),d.removeEventListener("mouseleave",q)};g.addEventListener("mousedown",n)},apogeeapp.ui.SplitPane.SCROLLING_PANE="visiui-sp-scrolling",apogeeapp.ui.SplitPane.FIXED_PANE="visiui-sp-fixed",apogeeapp.ui.SplitPane.prototype.getOuterElement=function(){return this.container1},apogeeapp.ui.SplitPane.prototype.getLeftPaneContainer=function(){return this.leftOuterPane},apogeeapp.ui.SplitPane.prototype.getRightPaneContainer=function(){return this.rightOuterPane},apogeeapp.ui.treecontrol||(apogeeapp.ui.treecontrol={}),apogeeapp.ui.treecontrol.TreeControl=function(){this.list=apogeeapp.ui.createElementWithClass("ul","visiui-tc-child-list",this.element)},apogeeapp.ui.treecontrol.TreeControl.prototype.getElement=function(){return this.list},apogeeapp.ui.treecontrol.TreeControl.prototype.setRootEntry=function(a){this.clearRootEntry(),this.list.appendChild(a.getElement())},apogeeapp.ui.treecontrol.TreeControl.prototype.clearRootEntry=function(){apogeeapp.ui.removeAllChildren(this.list)},apogeeapp.ui.treecontrol||(apogeeapp.ui.treecontrol={}),apogeeapp.ui.treecontrol.TreeEntry=function(a,b,c,d,e){this.contractUrl=apogeeapp.ui.getResourcePath("/contractPlus2.png"),this.expandUrl=apogeeapp.ui.getResourcePath("/expandPlus2.png"),this.noControlUrl=apogeeapp.ui.getResourcePath("/nothingPlus2.png"),
this.emptyControlUrl=apogeeapp.ui.getResourcePath("/emptyPlus2.png"),this.isRoot=e;var f;f=e?"visiui-tc-root":"visiui-tc-child",this.element=apogeeapp.ui.createElementWithClass("li",f),this.control=apogeeapp.ui.createElementWithClass("img","visiui-tc-control",this.element),b&&(this.iconContainerElement=apogeeapp.ui.createElementWithClass("div","visiui-tc-icon-container",this.element),d?(this.menu=apogeeapp.ui.Menu.createMenuFromImage(b),this.menu.setAsOnTheFlyMenu(d),this.iconContainerElement.appendChild(this.menu.getElement())):(this.icon=apogeeapp.ui.createElementWithClass("img","visiui-tc-icon",this.iconContainerElement),this.icon.src=b),this.iconOverlayElement=apogeeapp.ui.createElementWithClass("div","visiui_tc_icon_overlay",this.iconContainerElement)),this.label=apogeeapp.ui.createElementWithClass("div","visiui-tc-label",this.element),a&&this.setLabel(a),this.childList=null,this.childMap={},this.setState(apogeeapp.ui.treecontrol.NO_CONTROL);var g=function(a){var b=new apogeeapp.ui.MenuBody,c=d();b.setMenuItems(c),apogeeapp.ui.Menu.showContextMenu(b,a)};this.label.oncontextmenu=g,c&&(this.label.ondblclick=c)},apogeeapp.ui.treecontrol.NO_CONTROL=0,apogeeapp.ui.treecontrol.EXPANDED=1,apogeeapp.ui.treecontrol.COLLAPSED=-1,apogeeapp.ui.treecontrol.DEFAULT_STATE=apogeeapp.ui.treecontrol.COLLAPSED,apogeeapp.ui.treecontrol.TreeEntry.prototype.getElement=function(){return this.element},apogeeapp.ui.treecontrol.TreeEntry.prototype.setLabel=function(a){this.label.innerHTML=a},apogeeapp.ui.treecontrol.TreeEntry.prototype.addChild=function(a,b){this.childList||(this.childList=apogeeapp.ui.createElementWithClass("ul","visiui-tc-child-list",this.element),this.setState(apogeeapp.ui.treecontrol.DEFAULT_STATE)),this.childMap[a]=b,this.childList.appendChild(b.getElement())},apogeeapp.ui.treecontrol.TreeEntry.prototype.removeChild=function(a){if(this.childList){var b=this.childMap[a];b&&(delete this.childMap[a],this.childList.removeChild(b.getElement()),0===this.childList.childElementCount&&(this.element.removeChild(this.childList),this.childList=null,this.setState(apogeeapp.ui.treecontrol.NO_CONTROL)))}},apogeeapp.ui.treecontrol.TreeEntry.prototype.setState=function(a){if(this.state=a,this.state==apogeeapp.ui.treecontrol.NO_CONTROL)this.isRoot?this.control.src=this.emptyControlUrl:this.control.src=this.noControlUrl;else if(this.state==apogeeapp.ui.treecontrol.EXPANDED){if(this.control.src=this.contractUrl,!this.collapse){var b=this;this.collapse=function(){b.setState(apogeeapp.ui.treecontrol.COLLAPSED)}}this.control.onclick=this.collapse,this.childList.style.display=""}else if(this.state==apogeeapp.ui.treecontrol.COLLAPSED){if(this.control.src=this.expandUrl,!this.expand){var b=this;this.expand=function(){b.setState(apogeeapp.ui.treecontrol.EXPANDED)}}this.control.onclick=this.expand,this.childList.style.display="none"}},apogeeapp.ui.treecontrol.TreeEntry.prototype.setIconOverlay=function(a){this.clearIconOverlay(),a&&this.iconOverlayElement.appendChild(a)},apogeeapp.ui.treecontrol.TreeEntry.prototype.clearIconOverlay=function(){apogeeapp.ui.removeAllChildren(this.iconOverlayElement)},apogeeapp.app={},apogeeapp.app.dialog={},apogeeapp.app.Apogee=function(a){apogee.EventManager.init.call(this),this.workspaceUI=null,this.componentGenerators={},this.standardComponents=[],this.additionalComponents=[],this.linkManager=new apogeeapp.app.LinkManager,this.loadComponentGenerators(),this.createUI(a);var b=apogee.util.readQueryField("url",document.URL);b&&apogeeapp.app.openworkspace.openWorkspaceFromUrl(this,b)},apogee.base.mixin(apogeeapp.app.Apogee,apogee.EventManager),apogeeapp.app.Apogee.DEFAULT_WORKSPACE_NAME="workspace",apogeeapp.app.Apogee.prototype.getWorkspaceUI=function(){return this.workspaceUI},apogeeapp.app.Apogee.prototype.getWorkspace=function(){return this.workspaceUI?this.workspaceUI.getWorkspace():null},apogeeapp.app.Apogee.prototype.setWorkspaceUI=function(a){if(this.workspaceUI)throw apogee.base.createError("There is already an open workspace",!1);return a.setApp(this,this.tabFrame,this.treePane),this.workspaceUI=a,!0},apogeeapp.app.Apogee.prototype.clearWorkspaceUI=function(){return this.workspaceUI=null,!0},apogeeapp.app.Apogee.prototype.updateWorkspaceLinks=function(a,b,c,d){this.linkManager.updateWorkspaceLinks(a,b,c,d)},apogeeapp.app.Apogee.prototype.registerComponent=function(a){var b=a.uniqueName;return this.componentGenerators[b]?void alert("There is already a registered component with this name. Either the component has already been added of the name is not unique."):(this.componentGenerators[b]=a,void this.additionalComponents.push(b))},apogeeapp.app.Apogee.prototype.getComponentGenerator=function(a){return this.componentGenerators[a]},apogeeapp.app.Apogee.prototype.loadComponentGenerators=function(){this.registerStandardComponent(apogeeapp.app.JsonTableComponent.generator),this.registerStandardComponent(apogeeapp.app.GridTableComponent.generator),this.registerStandardComponent(apogeeapp.app.TextComponent.generator),this.registerStandardComponent(apogeeapp.app.FolderComponent.generator),this.registerStandardComponent(apogeeapp.app.FunctionComponent.generator),this.registerStandardComponent(apogeeapp.app.FolderFunctionComponent.generator),this.registerComponent(apogeeapp.app.CustomControlComponent.generator)},apogeeapp.app.Apogee.prototype.registerStandardComponent=function(a){var b=a.uniqueName;return this.componentGenerators[b]?void alert("There is already a registered component with this name. Either the component has already been added of the name is not unique."):(this.componentGenerators[b]=a,void this.standardComponents.push(b))},apogeeapp.app.Apogee.prototype.createUI=function(a){var b=apogeeapp.ui.initWindows(a),c=b.baseElement,d=new apogeeapp.ui.DisplayAndHeader(apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null,apogeeapp.ui.DisplayAndHeader.FIXED_PANE,null);c.appendChild(d.getOuterElement());var e=this.createMenuBar();d.getHeader().appendChild(e);var f=new apogeeapp.ui.SplitPane(apogeeapp.ui.SplitPane.SCROLLING_PANE,apogeeapp.ui.SplitPane.FIXED_PANE);d.getBody().appendChild(f.getOuterElement()),this.treePane=f.getLeftPaneContainer(),this.tabFrame=new apogeeapp.ui.TabFrame,f.getRightPaneContainer().appendChild(this.tabFrame.getElement());var g=this;this.tabFrame.addListener(apogeeapp.ui.SHOWN_EVENT,function(a){g.onTabShown(a)}),this.tabFrame.addListener(apogeeapp.ui.HIDDEN_EVENT,function(a){g.onTabHidden(a)})},apogeeapp.app.Apogee.prototype.onTabHidden=function(a){this.activeTabIconDisplay.style.display="none",this.activeTabTitleDisplay.style.display="none"},apogeeapp.app.Apogee.prototype.onTabShown=function(a){var b=a.getId(),c=this.workspaceUI.getComponentById(b);c&&(this.activeTabIconDisplay.src=c.getIconUrl(),this.activeTabTitleDisplay.innerHTML=c.getObject().getDisplayName(!0),this.activeTabIconDisplay.style.display="",this.activeTabTitleDisplay.style.display="")},apogeeapp.app.Apogee.prototype.createMenuBar=function(){var a,b,c={},d=apogeeapp.ui.createElementWithClass("div","menu_bar"),e=apogeeapp.ui.createElementWithClass("div","menu_bar_left",d),f=apogeeapp.ui.createElementWithClass("div","menu_bar_right",d);b="Workspace",a=apogeeapp.ui.Menu.createMenu(b),e.appendChild(a.getElement()),c[b]=a;var g=apogeeapp.app.createworkspace.getCreateCallback(this);a.addCallbackMenuItem("New",g);var h=apogeeapp.app.openworkspace.getOpenCallback(this);a.addCallbackMenuItem("Open",h);var i=apogeeapp.app.saveworkspace.getSaveCallback(this);a.addCallbackMenuItem("Save",i);var j=apogeeapp.app.closeworkspace.getCloseCallback(this);a.addCallbackMenuItem("Close",j),b="Components",a=apogeeapp.ui.Menu.createMenu(b),e.appendChild(a.getElement()),c[b]=a,a.setMenuItems(this.getAddChildMenuItems()),b="Libraries",a=apogeeapp.ui.Menu.createMenu(b),e.appendChild(a.getElement()),c[b]=a;var k=apogeeapp.app.updatelinks.getUpdateLinksCallback(this);a.addCallbackMenuItem("Update Links",k);var l=apogeeapp.app.importworkspace.getImportCallback(this,apogeeapp.app.FolderComponent.generator);a.addCallbackMenuItem("Import as Folder",l);var m=apogeeapp.app.importworkspace.getImportCallback(this,apogeeapp.app.FolderFunctionComponent.generator);a.addCallbackMenuItem("Import as Folder Function",m);var n=apogeeapp.app.exportworkspace.getExportCallback(this);return a.addCallbackMenuItem("Export as Workspace",n),this.addToMenuBar&&this.addToMenuBar(d,c),this.activeTabIconDisplay=apogeeapp.ui.createElementWithClass("img","tab-icon-display",f),this.activeTabIconDisplay.style.display="none",this.activeTabTitleDisplay=apogeeapp.ui.createElementWithClass("div","tab-title-display",f),this.activeTabTitleDisplay.style.display="none",d},apogeeapp.app.Apogee.prototype.getAddChildMenuItems=function(a,b){for(var c,d=[],e=0;e<this.standardComponents.length;e++){var f=this.standardComponents[e],g=this.componentGenerators[f];c={},c.title="Add "+g.displayName,c.callback=apogeeapp.app.addcomponent.getAddComponentCallback(this,g,a,b),d.push(c)}return c={},c.title="Other Components...",c.callback=apogeeapp.app.addcomponent.getAddAdditionalComponentCallback(this,a,b),d.push(c),d},apogeeapp.app.LinkManager=function(){this.linkMap={}},apogeeapp.app.LinkManager.prototype.updateWorkspaceLinks=function(a,b,c,d){var e,f,g,h,i,j,k;for(f=c.length,e=0;e<f;e++)if(h=c[e],i=h.link,j=h.type,k=this.linkMap[i],k&&(g=k.indexOf(i),g!==-1&&(k.splice(e,1),0===k.length))){var l=this.removeLinkFromPage(i,j);l&&delete this.linkMap[i]}var m;for(d&&(m=this.getResponseProcessor(b,d)),f=b.length,e=0;e<f;e++)h=b[e],i=h.link,j=h.type,k=this.linkMap[i],k?(g=k.indexOf(i),g!=-1||k.push(a),m&&m.getOnLoad(i)()):(k=[],k.push(a),this.linkMap[i]=k,this.addLinkToPage(i,j,m))},apogeeapp.app.LinkManager.prototype.addLinkToPage=function(a,b,c){"js"===b?apogeeapp.app.LinkManager.addJsLink(a,c):"css"===b&&apogeeapp.app.LinkManager.addCssLink(a,c)},apogeeapp.app.LinkManager.prototype.removeLinkFromPage=function(a,b){return"css"===b&&(apogeeapp.app.LinkManager.removeLink(a),!0)},apogeeapp.app.LinkManager.addJsLink=function(a,b){var c=document.getElementById(a);if(c)alert("THIS SHOULDN'T HAPPEN!");else{var d={};d.id=a,d.src=a,b&&(d.onload=b.getOnLoad(a),d.onerror=b.getOnError(a)),c=apogeeapp.ui.createElement("script",d),document.head.appendChild(c)}},apogeeapp.app.LinkManager.addCssLink=function(a,b){var c=document.getElementById(a);if(c)alert("THIS SHOULDN'T HAPPEN!");else{var d={};d.id=a,d.rel="stylesheet",d.type="text/css",d.href=a,b&&(d.onload=b.getOnLoad(a),d.onerror=b.getOnError(a)),c=apogeeapp.ui.createElement("link",d),document.head.appendChild(c)}},apogeeapp.app.LinkManager.removeLink=function(a){var b=document.getElementById(a);b&&document.head.removeChild(b)},apogeeapp.app.LinkManager.prototype.getResponseProcessor=function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=a[d].link;var e=function(a){var d=c.indexOf(a);d>=0&&c.splice(d,1),0===c.length&&b()},f={};return f.getOnLoad=function(a){return function(){console.log("link loaded: "+a),e(a)}},f.getOnError=function(a){return function(){console.log("link not loaded: "+a),e(a),alert("Error loading link: "+a)}},f},apogeeapp.app.WorkspaceUI=function(){this.workspace=null,this.app=null,this.tabFrame=null,this.tree=null,this.componentMap={},this.activeFolderName=null,this.jsLinkArray=[],this.cssLinkArray=[],this.workspaceTreeEntry=null},apogeeapp.app.WorkspaceUI.MAIN_WORKSPACE_NAME="main workspace",apogeeapp.app.WorkspaceUI.prototype.setApp=function(a,b,c){this.app=a,this.tabFrame=b,this.tree=new apogeeapp.ui.treecontrol.TreeControl,apogeeapp.ui.removeAllChildren(c),c.appendChild(this.tree.getElement())},apogeeapp.app.WorkspaceUI.prototype.getApp=function(){return this.app},apogeeapp.app.WorkspaceUI.prototype.setWorkspace=function(a,b){this.workspace=a;var c=this.workspace.getRoot(),d=new apogeeapp.app.FolderComponent(this,c);b&&this.loadFolderComponentContentFromJson(c,b),this.tree.setRootEntry(d.getTreeEntry());var e=this,f=function(a){e.memberUpdated(a)};this.workspace.addListener(apogee.updatemember.MEMBER_UPDATED_EVENT,f);var g=function(a){e.childDeleted(a)};this.workspace.addListener(apogee.deletemember.MEMBER_DELETED_EVENT,g)},apogeeapp.app.WorkspaceUI.prototype.getWorkspace=function(){return this.workspace},apogeeapp.app.WorkspaceUI.prototype.getComponent=function(a){var b=this.componentMap[a.getId()];return b?b.component:null},apogeeapp.app.WorkspaceUI.prototype.getComponentById=function(a){var b=this.componentMap[a];return b?b.component:null},apogeeapp.app.WorkspaceUI.prototype.getFolders=function(){var a={};for(var b in this.componentMap){var c=this.componentMap[b],d=c.object;d.isParent&&(a[d.getFullName()]=d)}return a},apogeeapp.app.WorkspaceUI.prototype.registerMember=function(a,b,c){if(a.getWorkspace()!==this.workspace)throw apogee.base.createError("Component registered in wrong workspace: "+a.getFullName());var d=a.getId();if(this.componentMap[d])throw apogee.base.createError("There is already a member with the given ID.",!0);var e={};e.object=a,e.component=b,c&&(e.componentMember=c),this.componentMap[d]=e},apogeeapp.app.WorkspaceUI.prototype.memberUpdated=function(a){var b=a.getId(),c=this.componentMap[b];c&&c.component&&c.component.memberUpdated()},apogeeapp.app.WorkspaceUI.prototype.childDeleted=function(a){var b=a.getId(),c=this.componentMap[b];delete this.componentMap[b],c&&c.component&&c.component.onDelete()},apogeeapp.app.WorkspaceUI.prototype.close=function(){for(var a in this.componentMap){var b=this.componentMap[a];b&&b.component&&!b.componentMember&&b.component.onDelete()}this.tree.clearRootEntry(),this.setLinks([],[])},apogeeapp.app.WorkspaceUI.prototype.getTabFrame=function(){return this.tabFrame},apogeeapp.app.WorkspaceUI.prototype.toJson=function(a){var b={};b.fileType="apogee workspace",b.jsLinks=this.jsLinkArray,b.cssLinks=this.cssLinkArray,b.workspace=this.workspace.toJson(a);var c;return c=a?a:this.workspace.getRoot(),b.components=this.getFolderComponentContentJson(c),b},apogeeapp.app.WorkspaceUI.prototype.getFolderComponentContentJson=function(a){var b={},c=a.getChildMap();for(var d in c){var e=c[d],f=this.getComponent(e),g=e.getName();b[g]=f.toJson()}return b},apogeeapp.app.WorkspaceUI.prototype.loadFolderComponentContentFromJson=function(a,b){for(var c in b){var d=b[c],e=a.lookupChild(c);this.loadComponentFromJson(e,d)}},apogeeapp.app.WorkspaceUI.prototype.loadComponentFromJson=function(a,b){var c=b.type,d=this.app.getComponentGenerator(c);if(!d)throw apogee.base.createError("Component type not found: "+c);d.createComponentFromJson(this,a,b)},apogeeapp.app.WorkspaceUI.prototype.getJsLinks=function(){return this.jsLinkArray},apogeeapp.app.WorkspaceUI.prototype.setLinks=function(a,b,c){var d=this.jsLinkArray,e=this.cssLinkArray,f=[],g=[];this.createLinkAddRemoveList(a,d,"js",f,g),this.createLinkAddRemoveList(b,e,"css",f,g),this.jsLinkArray=a,this.cssLinkArray=b,this.app.updateWorkspaceLinks(apogeeapp.app.WorkspaceUI.MAIN_WORKSPACE_NAME,f,g,c)},apogeeapp.app.WorkspaceUI.prototype.getCssLinks=function(){return this.cssLinkArray},apogeeapp.app.WorkspaceUI.prototype.createLinkAddRemoveList=function(a,b,c,d,e){var f,g,h={};for(f=0;f<a.length;f++)g=a[f],h[g]=!0;for(f=0;f<b.length;f++)g=b[f],h[g]?h[g]=!1:e.push({link:g,type:c});for(g in h)h[g]&&d.push({link:g,type:c})},apogeeapp.app.WindowHeaderManager=function(){this.toolbarDiv=null,this.toolbarActive=!1,this.bannerDiv=null,this.bannerBarActive=!1,this.headerContainer=document.createElement("div")},apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR="error",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_ERROR="red",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_ERROR="white",apogeeapp.app.WindowHeaderManager.ERROR_ICON_IMAGE="/error.png",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING="pending",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_PENDING="yellow",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_PENDING="black",apogeeapp.app.WindowHeaderManager.PENDING_ICON_IMAGE="/pending.png",apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_UNKNOWN="yellow",apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_UNKNOWN="black",apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE="none",apogeeapp.app.WindowHeaderManager.PENDING_MESSAGE="Calculation pending...",apogeeapp.app.WindowHeaderManager.prototype.showBannerBar=function(a,b){this.bannerDiv||(this.bannerDiv=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",backgroundColor:c,color:d}));var c,d;b==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?(c=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_ERROR,d=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_ERROR):b==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING?(c=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_PENDING,d=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_PENDING):(c=apogeeapp.app.WindowHeaderManager.BANNER_BGCOLOR_UNKNOWN,d=apogeeapp.app.WindowHeaderManager.BANNER_FGCOLOR_UNKNOWN);var e={};e.backgroundColor=c,e.color=d,apogeeapp.ui.applyStyle(this.bannerDiv,e),this.bannerDiv.innerHTML=a,this.bannerBarActive=!0,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.hideBannerBar=function(){this.bannerBarActive=!1,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.showToolbar=function(a){this.toolbarActive=!0,this.toolbarDiv=a,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.hideToolbar=function(){this.toolbarActive=!1,this.toolbarDiv=null,this.updateHeaderElement()},apogeeapp.app.WindowHeaderManager.prototype.updateHeaderElement=function(){var a=[];if(this.toolbarActive&&this.toolbarDiv&&a.push(this.toolbarDiv),this.saveBarActive&&this.saveDiv&&a.push(this.saveDiv),this.bannerBarActive&&this.bannerDiv&&a.push(this.bannerDiv),apogeeapp.ui.removeAllChildren(this.headerContainer),a.length>0)for(var b=0;b<a.length;b++)this.headerContainer.appendChild(a[b])},apogeeapp.app.WindowHeaderManager.prototype.getHeaderElement=function(){return this.headerContainer},apogeeapp.app.WindowHeaderManager.getIconOverlay=function(a){var b;if(a==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR?b=apogeeapp.app.WindowHeaderManager.ERROR_ICON_IMAGE:a==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING&&(b=apogeeapp.app.WindowHeaderManager.PENDING_ICON_IMAGE),!b)return null;var c=apogeeapp.ui.getResourcePath(b),d=document.createElement("img");return d.src=c,d},apogeeapp.app.Component=function(a,b,c,d){d||(d={}),this.options=d,this.workspaceUI=a,this.object=b,this.uiActiveParent=null,this.generator=c,this.workspaceUI.registerMember(this.object,this),this.windowDisplay=null,this.windowDisplayStateJson=this.options.windowState,this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE,this.bannerMessage="",this.saveActions=[],this.cleanupActions=[],this.treeDisplay=new apogeeapp.app.TreeComponentDisplay(this)},apogeeapp.app.Component.prototype.addSaveAction=function(a){this.saveActions.push(a)},apogeeapp.app.Component.prototype.addCleanupAction=function(a){this.cleanupActions.push(a)},apogeeapp.app.Component.DEFAULT_ICON_RES_PATH="/genericIcon.png",apogeeapp.app.Component.MENU_ITEM_OPEN=1,apogeeapp.app.Component.prototype.getObject=function(){return this.object},apogeeapp.app.Component.prototype.getIconUrl=function(){if(this.generator.ICON_URL)return this.generator.ICON_URL;var a=this.generator.ICON_RES_PATH;return a||(a=apogeeapp.app.Component.DEFAULT_ICON_RES_PATH),apogeeapp.ui.getResourcePath(a)},apogeeapp.app.Component.prototype.getWorkspace=function(){return this.object.getWorkspace()},apogeeapp.app.Component.prototype.getWorkspaceUI=function(){return this.workspaceUI},apogeeapp.app.Component.prototype.getTreeEntry=function(){return this.treeDisplay.getTreeEntry()},apogeeapp.app.Component.prototype.createWindowDisplay=function(){var a=this.instantiateWindowDisplay();return a.setBannerState(this.bannerState,this.bannerMessage),this.windowDisplay=a,a},apogeeapp.app.Component.prototype.getWindowDisplay=function(){return this.windowDisplay},apogeeapp.app.Component.prototype.closeWindowDisplay=function(){this.windowDisplay&&(this.windowDisplayStateJson=this.windowDisplay.getStateJson(),this.windowDisplay.deleteDisplay())},apogeeapp.app.Component.prototype.getMenuItems=function(a){var b=a?a:[],c={};c.title="Edit Properties",c.callback=apogeeapp.app.updatecomponent.getUpdateComponentCallback(this),b.push(c);var c={};return c.title="Delete",c.callback=this.createDeleteCallback(c.title),b.push(c),b},apogeeapp.app.Component.prototype.getOpenMenuItem=function(){var a=this.createOpenCallback();if(a){var b={};return b.title="Open",b.callback=a,b}return null},apogeeapp.app.Component.prototype.createTabDisplay=function(){return this.tabDisplay&&this.tabDisplay.closeTab(),this.usesTabDisplay()&&(this.tabDisplay=this.instantiateTabDisplay(),this.tabDisplay.setBannerState(this.bannerState,this.bannerMessage)),this.tabDisplay},apogeeapp.app.Component.prototype.getTabDisplay=function(){return this.tabDisplay},apogeeapp.app.Component.prototype.closeTabDisplay=function(){this.tabDisplay&&(this.tabDisplay.closeTab(),this.tabDisplay=null)},apogeeapp.app.Component.prototype.toJson=function(){var a={};a.type=this.generator.uniqueName,null!=this.windowDisplay&&(this.windowDisplayStateJson=this.windowDisplay.getStateJson()),this.windowDisplayStateJson&&(a.windowState=this.windowDisplayStateJson);for(var b=0;b<this.saveActions.length;b++)this.saveActions[b].call(this,a);return a},apogeeapp.app.Component.prototype.onDelete=function(){if(this.uiActiveParent){var a=this.workspaceUI.getComponent(this.uiActiveParent);a&&a.removeChildComponent(this)}this.tabDisplay&&this.closeTabDisplay();for(var b=0;b<this.cleanupActions.length;b++)this.cleanupActions[b].call(this)},apogeeapp.app.Component.prototype.memberUpdated=function(){if(this.object.getParent()!==this.uiActiveParent){var a=this.uiActiveParent,b=this.object.getParent();if(this.uiActiveParent=b,a){var c=this.workspaceUI.getComponent(a);c.removeChildComponent(this),this.windowDisplay&&(this.windowDisplay.deleteDisplay(),this.windowDisplay=null)}if(b){var d=this.workspaceUI.getComponent(b);d.addChildComponent(this)}}var e=this.getObject();if(e.hasError()){for(var f="",g=e.getErrors(),h=0;h<g.length;h++)f+=g[h].msg+"\n";this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_ERROR,this.bannerMessage=f}else e.getResultPending()?(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_PENDING,this.bannerMessage=apogeeapp.app.WindowHeaderManager.PENDING_MESSAGE):(this.bannerState=apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE,this.bannerMessage=null);this.treeDisplay.updateData(),this.treeDisplay.setBannerState(this.bannerState,this.bannerMessage),null!=this.windowDisplay&&(this.windowDisplay.updateData(),this.windowDisplay.setBannerState(this.bannerState,this.bannerMessage)),null!=this.tabDisplay&&(this.tabDisplay.updateData(),this.tabDisplay.setBannerState(this.bannerState,this.bannerMessage))},apogeeapp.app.Component.prototype.getPropertyValues=function(){var a=this.object,b={};b.name=a.getName();var c=a.getParent();return c&&(b.parentName=c.getFullName()),a.generator.addPropFunction&&a.generator.addPropFunction(a,b),this.generator.addPropFunction&&this.generator.addPropFunction(this,b),b},apogeeapp.app.Component.prototype.createOpenCallback=function(){var a,b=this,c=this.workspaceUI,d=function(a){var b=a.getTabDisplay();if(b){var d=b.getTab();d.makeActive()}else{var b=a.createTabDisplay(),d=b.getTab(),e=c.getTabFrame();e.addTab(d,!0)}};if(this.usesTabDisplay())a=function(){d(b)};else{var e=this.object.getParent();if(e){var f=c.getComponent(e);f&&f.usesTabDisplay()&&(a=function(){d(f),f.showChildComponent(b)})}}return a},apogeeapp.app.Component.prototype.createDeleteCallback=function(){var a=this.getObject();return function(){var b=confirm("Are you sure you want to delete this object?");if(b){var c={};c.action="deleteMember",c.member=a;var d=apogee.action.doAction(c);if(!d.getSuccess()){var e=d.getErrorMsg();alert(e)}}}},apogeeapp.app.ParentComponent=function(a,b,c,d){apogeeapp.app.Component.call(this,a,b,c,d),this.tabDisplay=null},apogeeapp.app.ParentComponent.prototype=Object.create(apogeeapp.app.Component.prototype),apogeeapp.app.ParentComponent.prototype.constructor=apogeeapp.app.ParentComponent,apogeeapp.app.ParentComponent.prototype.instantiateWindowDisplay=function(){return new apogeeapp.app.ParentWindowComponentDisplay(this,this.windowDisplayStateJson)},apogeeapp.app.ParentComponent.prototype.usesTabDisplay=function(){return!0},apogeeapp.app.ParentComponent.prototype.showChildComponent=function(a){a.getObject().getParent()==this.getObject()&&this.tabDisplay&&this.tabDisplay.showChildComponent(a)},apogeeapp.app.ParentComponent.prototype.getMenuItems=function(a){var b=a?a:[],c={},d=this.getWorkspaceUI().getApp(),e={};e.parentName=this.object.getFullName(),c.title="Add Component...",c.childMenuItems=d.getAddChildMenuItems(e),b.push(c);var b=apogeeapp.app.Component.prototype.getMenuItems.call(this,b);return b},apogeeapp.app.ParentComponent.prototype.isParentComponent=!0,apogeeapp.app.ParentComponent.prototype.removeChildComponent=function(a){var b=this.getTreeEntry(),c=a.getObject().getId();b.removeChild(c);var d=a.getWindowDisplay();d&&d.deleteDisplay()},apogeeapp.app.ParentComponent.prototype.addChildComponent=function(a){var b=this.getTreeEntry(),c=a.getTreeEntry(),d=a.getObject().getId();b.addChild(d,c),this.tabDisplay&&this.tabDisplay.addChildComponent(a)},apogeeapp.app.EditComponent=function(a,b,c,d){apogeeapp.app.Component.call(this,a,b,c,d)},apogeeapp.app.EditComponent.prototype=Object.create(apogeeapp.app.Component.prototype),apogeeapp.app.EditComponent.prototype.constructor=apogeeapp.app.EditComponent,apogeeapp.app.EditComponent.prototype.instantiateWindowDisplay=function(){return new apogeeapp.app.EditWindowComponentDisplay(this,this.windowDisplayStateJson)},apogeeapp.app.EditComponent.prototype.setAlternateWindowDisplay=function(a){this.alternateWindowDisplay=a,this.windowDisplay=a,a.setBannerState(this.bannerState,this.bannerMessage)},apogeeapp.app.EditComponent.prototype.usesTabDisplay=function(){return!1},apogeeapp.app.EditComponent.prototype.instantiateTabDisplay=function(){return null},apogeeapp.app.EditComponent.prototype.getMenuItems=function(a){var b=a?a:[],b=apogeeapp.app.Component.prototype.getMenuItems.call(this,b);if(this.object.isCodeable&&this.object.hasCode()){var c=this.getTableEditSettings();if(void 0!==c.clearFunctionMenuText){var d={};d.title=c.clearFunctionMenuText,d.callback=this.getClearFunctionCallback(c.emptyDataValue),b.push(d)}}return b},apogeeapp.app.EditComponent.prototype.getClearFunctionCallback=function(a){var b={};return b.member=this.object,b.data=a,b.action=apogee.updatemember.UPDATE_DATA_ACTION_NAME,function(){var a=apogee.action.doAction(b);a.getSuccess()||alert(a.getErrorMsg())}},apogeeapp.app.TreeComponentDisplay=function(a){this.component=a,this.object=a.getObject(),this.treeEntry=this._createTreeEntry()},apogeeapp.app.TreeComponentDisplay.prototype.getTreeEntry=function(){return this.treeEntry},apogeeapp.app.TreeComponentDisplay.prototype.changeParent=function(a,b){var c=b.getTreeEntry();c.removeChild(this.object.getId());var d=a.getTreeEntry();d.addChild(this.object.getId(),this.treeEntry)},apogeeapp.app.TreeComponentDisplay.prototype.deleteDisplay=function(){alert("Delete tree component display not implemneted")},apogeeapp.app.TreeComponentDisplay.prototype.setBannerState=function(a,b){var c=apogeeapp.app.WindowHeaderManager.getIconOverlay(a);c?this.treeEntry.setIconOverlay(c):this.treeEntry.clearIconOverlay()},apogeeapp.app.TreeComponentDisplay.prototype.updateData=function(){this.treeEntry.setLabel(this.object.getName())},apogeeapp.app.TreeComponentDisplay.prototype._createTreeEntry=function(){var a=this,b=function(){var b=[],c=a.component.getOpenMenuItem();return c&&b.push(c),a.component.getMenuItems(b)},c=this.component.createOpenCallback(),d=this.object.getName(),e=this.component.getIconUrl(),f=this.object.isParent&&this.object.isRoot();return new apogeeapp.ui.treecontrol.TreeEntry(d,e,c,b,f)},apogeeapp.app.TabComponentDisplay=function(a,b,c){this.component=a,this.member=b,this.folder=c,this._loadTabEntry()},apogeeapp.app.TabComponentDisplay.prototype.getTab=function(){return this.tab},apogeeapp.app.TabComponentDisplay.prototype.closeTab=function(){this.tab&&(this.tab.close(),this.tab=null)},apogeeapp.app.TabComponentDisplay.prototype.setBannerState=function(a,b){if(a==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE?this.windowHeaderManager.hideBannerBar():this.windowHeaderManager.showBannerBar(b,a),this.tab){var c=apogeeapp.app.WindowHeaderManager.getIconOverlay(a);c?this.tab.setIconOverlay(c):this.tab.clearIconOverlay()}},apogeeapp.app.TabComponentDisplay.prototype.updateData=function(){this.tab.setTitle(this.member.getName())},apogeeapp.app.TabComponentDisplay.prototype.addChildComponent=function(a){var b=a.createWindowDisplay(),c=b.getWindowFrame(),d=b.getPreferredPosition();d||(d=this.parentContainer.getNextWindowPosition()),c.setPosition(d.x,d.y),this.parentContainer.addWindow(c);var e=b.getPreferredState();c.setWindowState(e)},apogeeapp.app.TabComponentDisplay.prototype.showChildComponent=function(a){var b=a.getWindowDisplay();if(b){var c=b.getWindowFrame();c&&this.parentContainer.bringToFront(c)}},apogeeapp.app.TabComponentDisplay.prototype._loadTabEntry=function(){this.tab=new apogeeapp.ui.Tab(this.member.getId()),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.tab.setHeaderContent(this.windowHeaderManager.getHeaderElement()),this._createDisplayContent(),this.tab.setContent(this.contentElement);var a=function(){d.parentContainer.elementIsShown()};this.tab.addListener(apogeeapp.ui.SHOWN_EVENT,a);var b=function(){d.parentContainer.elementIsHidden()};this.tab.addListener(apogeeapp.ui.HIDDEN_EVENT,b);var c=this.tab.createMenu(this.component.getIconUrl()),d=this,e=function(){return d.component.getMenuItems()};c.setAsOnTheFlyMenu(e),this.tab.setTitle(this.member.getName());var d=this,f=function(){d.component.closeTabDisplay(),d.destroy()};this.tab.addListener(apogeeapp.ui.CLOSE_EVENT,f)},apogeeapp.app.TabComponentDisplay.PARENT_CONTAINER_STYLE={position:"relative",display:"table",width:"100%",height:"100%",top:"0px",left:"0px"},apogeeapp.app.TabComponentDisplay.prototype._createDisplayContent=function(){if(this.contentElement=apogeeapp.ui.createElement("div",null,apogeeapp.app.TabComponentDisplay.PARENT_CONTAINER_STYLE),this.parentContainer=new apogeeapp.ui.WindowParent(this.contentElement),this.folder.isParent){this.setAddChildrenContextMenu();var a=this.component.getWorkspaceUI(),b=this.folder.getChildMap();for(var c in b){var d=b[c],e=a.getComponent(d);this.addChildComponent(e)}}},apogeeapp.app.TabComponentDisplay.prototype.setAddChildrenContextMenu=function(){var a=this.component.getWorkspaceUI(),b=a.getApp(),c={};c.parentName=this.member.getFullName(),this.contentElement.oncontextmenu=function(a){if(a.preventDefault(),a.stopPropagation(),a.offsetX){var d={},e={};e.x=a.offsetX,e.y=a.offsetY,d.coordInfo=e}var f=new apogeeapp.ui.MenuBody;f.setMenuItems(b.getAddChildMenuItems(c,d)),apogeeapp.ui.Menu.showContextMenu(f,a)}},apogeeapp.app.TabComponentDisplay.prototype.destroy=function(){var a=this.folder.getChildMap(),b=this.component.getWorkspaceUI();for(var c in a){var d=a[c],e=b.getComponent(d);e.closeWindowDisplay()}this.closeTab()},apogeeapp.app.ParentWindowComponentDisplay=function(a,b){this.component=a,this.object=a.getObject(),this.options=b,this._loadWindowFrameEntry()},apogeeapp.app.ParentWindowComponentDisplay.prototype.getWindowFrame=function(){return this.windowFrame},apogeeapp.app.ParentWindowComponentDisplay.prototype.getPreferredPosition=function(){return this.options?this.options.posInfo:void 0},apogeeapp.app.ParentWindowComponentDisplay.prototype.getPreferredState=function(){return apogeeapp.ui.WINDOW_STATE_MINIMIZED},apogeeapp.app.ParentWindowComponentDisplay.prototype.getComponent=function(){return this.component;
},apogeeapp.app.ParentWindowComponentDisplay.prototype.deleteDisplay=function(){this.windowFrame&&this.windowFrame.close()},apogeeapp.app.ParentWindowComponentDisplay.prototype.setBannerState=function(a,b){if(this.windowFrame){var c=apogeeapp.app.WindowHeaderManager.getIconOverlay(a);c?this.windowFrame.setIconOverlay(c):this.windowFrame.clearIconOverlay()}},apogeeapp.app.ParentWindowComponentDisplay.prototype.updateData=function(){this.windowFrame&&this.windowFrame.setTitle(this.object.getDisplayName())},apogeeapp.app.ParentWindowComponentDisplay.prototype.getStateJson=function(){if(this.windowFrame){var a={};return a.posInfo=this.windowFrame.getPosInfo(),a}},apogeeapp.app.ParentWindowComponentDisplay.prototype._loadWindowFrameEntry=function(){var a={};a.minimizable=!1,a.maximizable=!1,a.resizable=!1,a.movable=!0,a.frameColorClass="visicomp_windowColor",a.titleBarClass="visicomp_titleBarClass",this.windowFrame=new apogeeapp.ui.WindowFrame(a),this.windowFrame.setWindowState(apogeeapp.ui.WINDOW_STATE_MINIMIZED);var b=apogeeapp.ui.createElement("div");this.windowFrame.setContent(b),this.windowFrame.setTitle(this.object.getDisplayName());var c=this.windowFrame.createMenu(this.component.getIconUrl()),d=this,e=function(){var a=[],b=d.component.getOpenMenuItem();return b&&a.push(b),d.component.getMenuItems(a)};c.setAsOnTheFlyMenu(e)},apogeeapp.app.ParentWindowComponentDisplay.prototype.destroy=function(){for(var a in viewModeElements){var b=this.viewModeElemens[a];b.destroy()}},apogeeapp.app.EditWindowComponentDisplay=function(a,b){this.component=a,this.object=a.getObject(),this.options=b,this.viewType=null,this.select=null,this.viewModeElements={},this.viewModeElement=null,this._loadWindowFrameEntry()},apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR="#f4f4f4",apogeeapp.app.EditWindowComponentDisplay.prototype.getWindowFrame=function(){return this.windowFrame},apogeeapp.app.EditWindowComponentDisplay.prototype.getPreferredPosition=function(){return this.options?this.options.posInfo:void 0},apogeeapp.app.EditWindowComponentDisplay.prototype.getPreferredState=function(){return this.options&&void 0!==this.options.state?this.options.state:apogeeapp.ui.WINDOW_STATE_NORMAL},apogeeapp.app.EditWindowComponentDisplay.prototype.getComponent=function(){return this.component},apogeeapp.app.EditWindowComponentDisplay.prototype.getMember=function(){return this.object},apogeeapp.app.EditWindowComponentDisplay.prototype.deleteDisplay=function(){for(var a in this.viewModeElements){var b=this.viewModeElements[a];b&&b.destroy()}this.windowFrame&&this.windowFrame.close()},apogeeapp.app.EditWindowComponentDisplay.prototype.setBannerState=function(a,b){if(this.windowHeaderManager&&(a==apogeeapp.app.WindowHeaderManager.BANNER_TYPE_NONE?this.windowHeaderManager.hideBannerBar():this.windowHeaderManager.showBannerBar(b,a)),this.windowFrame){var c=apogeeapp.app.WindowHeaderManager.getIconOverlay(a);c?this.windowFrame.setIconOverlay(c):this.windowFrame.clearIconOverlay()}},apogeeapp.app.EditWindowComponentDisplay.prototype.updateData=function(){this.windowFrame&&(this.windowFrame.setTitle(this.object.getDisplayName()),this.viewModeElement.memberUpdated())},apogeeapp.app.EditWindowComponentDisplay.prototype.getStateJson=function(){var a={},b=!1;return this.windowFrame&&(a.sizeInfo=this.windowFrame.getSizeInfo(),a.posInfo=this.windowFrame.getPosInfo(),a.state=this.windowFrame.getWindowState(),b=!0),this.viewType&&(a.viewType=this.viewType,b=!0),b?a:void 0},apogeeapp.app.EditWindowComponentDisplay.prototype.setStateJson=function(a){this.windowFrame&&(a.sizeInfo&&this.windowFrame.setSizeInfo(a.sizeInfo),a.posInfo&&this.windowFrame.setPosInfo(a.posInfo),a.state&&this.windowFrame.setWindowState(a.state)),a.viewType&&(this.viewType=a.viewType)},apogeeapp.app.EditWindowComponentDisplay.prototype._loadWindowFrameEntry=function(){var a={};a.minimizable=!0,a.maximizable=!0,a.resizable=!0,a.movable=!0,a.frameColorClass="visicomp_windowColor",a.titleBarClass="visicomp_titleBarClass",this.windowFrame=new apogeeapp.ui.WindowFrame(a),this.options&&this.options.sizeInfo?this.windowFrame.setSize(this.options.sizeInfo.width,this.options.sizeInfo.height):this.windowFrame.setSize(this.component.generator.DEFAULT_WIDTH,this.component.generator.DEFAULT_HEIGHT),this.windowHeaderManager=new apogeeapp.app.WindowHeaderManager,this.windowFrame.setHeaderContent(this.windowHeaderManager.getHeaderElement()),this.windowFrame.setTitle(this.object.getDisplayName());var b=this.windowFrame.createMenu(this.component.getIconUrl()),c=this.component,d=function(){return c.getMenuItems()};b.setAsOnTheFlyMenu(d),this._createSelectTool(),this._initContentUI()},apogeeapp.app.EditWindowComponentDisplay.prototype._createSelectTool=function(){this.select=apogeeapp.ui.createElement("select",null,{marginRight:"3px",backgroundColor:"transparent"});var a=this,b=function(b){a.setViewType(a.select.value)};this.select.onchange=b,this.windowFrame.addTitleToolElement(this.select)},apogeeapp.app.EditWindowComponentDisplay.prototype._initContentUI=function(){for(var a=this.component.getTableEditSettings(),b=a.viewModes,c=0;c<b.length;c++){var d=b[c];this.select.add(apogeeapp.ui.createElement("option",{text:d}))}var e=this._getInitialViewType(b,a.defaultView);this.setViewType(e)},apogeeapp.app.EditWindowComponentDisplay.prototype._getInitialViewType=function(a,b){return this.options&&this.options.viewType&&a.indexOf(this.options.viewType)>=0?this.options.viewType:b?b:a[0]},apogeeapp.app.EditWindowComponentDisplay.prototype.setViewType=function(a){if(this.viewType!==a){if(this.viewModeElement){var b=this.viewModeElement.requestHide();if(b!==apogeeapp.app.ViewMode.CLOSE_OK)return b===apogeeapp.app.ViewMode.UNSAVED_DATA?alert("You must save or cancel the edit session to change the view mode."):alert("close request rejected..."),void this._updateViewTypeSelect();this.viewModeElement.hide()}this.viewType=a,this._updateViewTypeSelect(),this.viewModeElement=this.viewModeElements[a],this.viewModeElement||(this.viewModeElement=this.component.getViewModeElement(this,a),this.viewModeElements[a]=this.viewModeElement),this._updateViewContent()}},apogeeapp.app.EditWindowComponentDisplay.prototype._updateViewTypeSelect=function(){this.select.value!=this.viewType&&(this.select.value=this.viewType)},apogeeapp.app.EditWindowComponentDisplay.prototype._updateViewContent=function(){this.viewModeElement?(this.viewModeElement.showData(),this.windowFrame.setContent(this.viewModeElement.getElement())):alert("Error: View mode element not found!")},apogeeapp.app.EditWindowComponentDisplay.prototype.startEditUI=function(a,b){this.select.disabled=!0,this.showSaveBar(a,b)},apogeeapp.app.EditWindowComponentDisplay.prototype.endEditUI=function(){this.hideSaveBar(),this.select.disabled=!1},apogeeapp.app.EditWindowComponentDisplay.prototype.showSaveBar=function(a,b){this.saveDiv||(this.saveDiv=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",backgroundColor:"white",border:"solid 1px gray",padding:"3px"}),this.saveDiv.appendChild(document.createTextNode("Edit: ")),this.saveBarSaveButton=document.createElement("button"),this.saveBarSaveButton.innerHTML="Save",this.saveDiv.appendChild(this.saveBarSaveButton),this.saveDiv.appendChild(document.createTextNode(" ")),this.saveBarCancelButton=document.createElement("button"),this.saveBarCancelButton.innerHTML="Cancel",this.saveDiv.appendChild(this.saveBarCancelButton)),this.saveBarSaveButton.onclick=a,this.saveBarCancelButton.onclick=b,this.saveBarActive=!0,this.windowHeaderManager.showToolbar(this.saveDiv)},apogeeapp.app.EditWindowComponentDisplay.prototype.hideSaveBar=function(){this.saveBarActive=!1,this.windowHeaderManager.showToolbar(this.normalToolbarDiv)},apogeeapp.app.FolderComponent=function(a,b,c){apogeeapp.app.ParentComponent.call(this,a,b,apogeeapp.app.FolderComponent.generator,c),this.addSaveAction(apogeeapp.app.FolderComponent.writeToJson),this.memberUpdated()},apogeeapp.app.FolderComponent.prototype=Object.create(apogeeapp.app.ParentComponent.prototype),apogeeapp.app.FolderComponent.prototype.constructor=apogeeapp.app.FolderComponent,apogeeapp.app.FolderComponent.prototype.instantiateTabDisplay=function(){var a=this.getObject();return this.tabDisplay=new apogeeapp.app.TabComponentDisplay(this,a,a),this.tabDisplay},apogeeapp.app.FolderComponent.writeToJson=function(a){var b=this.getObject(),c=this.getWorkspaceUI();a.children=c.getFolderComponentContentJson(b)},apogeeapp.app.FolderComponent.createComponent=function(a,b,c){var d={};d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name,b.children&&(d.children=b.children),d.type=apogee.Folder.generator.type;var e=apogee.action.doAction(d),f=d.member;if(f){var g=apogeeapp.app.FolderComponent.createComponentFromJson(a,f,c);e.component=g}return e},apogeeapp.app.FolderComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.FolderComponent(a,b,c);return c&&c.children&&a.loadFolderComponentContentFromJson(b,c.children),d},apogeeapp.app.FolderComponent.generator={},apogeeapp.app.FolderComponent.generator.displayName="Folder",apogeeapp.app.FolderComponent.generator.uniqueName="apogeeapp.app.FolderComponent",apogeeapp.app.FolderComponent.generator.createComponent=apogeeapp.app.FolderComponent.createComponent,apogeeapp.app.FolderComponent.generator.createComponentFromJson=apogeeapp.app.FolderComponent.createComponentFromJson,apogeeapp.app.FolderComponent.generator.DEFAULT_WIDTH=500,apogeeapp.app.FolderComponent.generator.DEFAULT_HEIGHT=500,apogeeapp.app.FolderComponent.generator.ICON_RES_PATH="/folderIcon.png",apogeeapp.app.FolderComponent.generator.propertyDialogLines=[{type:"invisible",resultKey:"children"}],apogeeapp.app.FolderComponent.generator.appendWorkspaceChildren=function(a,b){a.children=b},apogeeapp.app.JsonTableComponent=function(a,b,c){apogeeapp.app.EditComponent.call(this,a,b,apogeeapp.app.JsonTableComponent.generator,c),this.memberUpdated()},apogeeapp.app.JsonTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.JsonTableComponent.prototype.constructor=apogeeapp.app.JsonTableComponent,apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT="Text",apogeeapp.app.JsonTableComponent.VIEW_JSON_TEXT="JSON",apogeeapp.app.JsonTableComponent.VIEW_FORM="Form",apogeeapp.app.JsonTableComponent.VIEW_CODE="Formula",apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.JsonTableComponent.VIEW_MODES=[apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT,apogeeapp.app.JsonTableComponent.VIEW_JSON_TEXT,apogeeapp.app.JsonTableComponent.VIEW_FORM,apogeeapp.app.JsonTableComponent.VIEW_CODE,apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION],apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.JsonTableComponent.VIEW_MODES,defaultView:apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT,clearFunctionMenuText:"Clear Formula",emptyDataValue:""},apogeeapp.app.JsonTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.JsonTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.JsonTableComponent.prototype.getViewModeElement=function(a,b){switch(b){case apogeeapp.app.JsonTableComponent.VIEW_PLAIN_TEXT:return new apogeeapp.app.AceDataMode(a,(!1));case apogeeapp.app.JsonTableComponent.VIEW_JSON_TEXT:return new apogeeapp.app.AceDataMode(a,(!0));case apogeeapp.app.JsonTableComponent.VIEW_FORM:return new apogeeapp.app.FormDataMode(a);case apogeeapp.app.JsonTableComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(a);case apogeeapp.app.JsonTableComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(a);case apogeeapp.app.JsonTableComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.JsonTableComponent.createComponent=function(a,b,c){var d={};d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name,d.type=apogee.JsonTable.generator.type;var e=apogee.action.doAction(d),f=d.member;if(f){var g=new apogeeapp.app.JsonTableComponent(a,f,c);e.component=g}return e},apogeeapp.app.JsonTableComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.JsonTableComponent(a,b,c);return d},apogeeapp.app.JsonTableComponent.generator={},apogeeapp.app.JsonTableComponent.generator.displayName="Data Table",apogeeapp.app.JsonTableComponent.generator.uniqueName="apogeeapp.app.JsonTableComponent",apogeeapp.app.JsonTableComponent.generator.createComponent=apogeeapp.app.JsonTableComponent.createComponent,apogeeapp.app.JsonTableComponent.generator.createComponentFromJson=apogeeapp.app.JsonTableComponent.createComponentFromJson,apogeeapp.app.JsonTableComponent.generator.DEFAULT_WIDTH=300,apogeeapp.app.JsonTableComponent.generator.DEFAULT_HEIGHT=300,apogeeapp.app.JsonTableComponent.generator.ICON_RES_PATH="/dataIcon.png",apogeeapp.app.GridTableComponent=function(a,b,c){apogeeapp.app.EditComponent.call(this,a,b,apogeeapp.app.GridTableComponent.generator,c),this.memberUpdated()},apogeeapp.app.GridTableComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.GridTableComponent.prototype.constructor=apogeeapp.app.GridTableComponent,apogeeapp.app.GridTableComponent.VIEW_GRID="Grid",apogeeapp.app.GridTableComponent.VIEW_CODE="Formula",apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.GridTableComponent.VIEW_MODES=[apogeeapp.app.GridTableComponent.VIEW_GRID,apogeeapp.app.GridTableComponent.VIEW_CODE,apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION],apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.GridTableComponent.VIEW_MODES,defaultView:apogeeapp.app.GridTableComponent.VIEW_GRID,clearFunctionMenuText:"Clear Formula",emptyDataValue:[[null]]},apogeeapp.app.GridTableComponent.DEFAULT_VIEW=apogeeapp.app.GridTableComponent.VIEW_GRID,apogeeapp.app.GridTableComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.GridTableComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.GridTableComponent.prototype.getViewModeElement=function(a,b){switch(b){case apogeeapp.app.GridTableComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(a);case apogeeapp.app.GridTableComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(a);case apogeeapp.app.GridTableComponent.VIEW_GRID:return new apogeeapp.app.HandsonGridMode(a);case apogeeapp.app.GridTableComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.GridTableComponent.createComponent=function(a,b,c){var d={};d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name,d.type=apogee.JsonTable.generator.type,d.updateData={},d.updateData.data=[[""]];var e=apogee.action.doAction(d),f=d.member;if(f){var g=new apogeeapp.app.GridTableComponent(a,f,c);e.component=g}return e},apogeeapp.app.GridTableComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.GridTableComponent(a,b,c);return d},apogeeapp.app.GridTableComponent.generator={},apogeeapp.app.GridTableComponent.generator.displayName="Grid Table",apogeeapp.app.GridTableComponent.generator.uniqueName="apogeeapp.app.GridTableComponent",apogeeapp.app.GridTableComponent.generator.createComponent=apogeeapp.app.GridTableComponent.createComponent,apogeeapp.app.GridTableComponent.generator.createComponentFromJson=apogeeapp.app.GridTableComponent.createComponentFromJson,apogeeapp.app.GridTableComponent.generator.DEFAULT_WIDTH=300,apogeeapp.app.GridTableComponent.generator.DEFAULT_HEIGHT=300,apogeeapp.app.GridTableComponent.generator.ICON_RES_PATH="/gridIcon.png",apogeeapp.app.TextComponent=function(a,b,c){apogeeapp.app.EditComponent.call(this,a,b,apogeeapp.app.TextComponent.generator,c),this.memberUpdated()},apogeeapp.app.TextComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.TextComponent.prototype.constructor=apogeeapp.app.TextComponent,apogeeapp.app.TextComponent.VIEW_TEXT="Text",apogeeapp.app.TextComponent.VIEW_CODE="Formula",apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.TextComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.TextComponent.VIEW_MODES=[apogeeapp.app.TextComponent.VIEW_TEXT,apogeeapp.app.TextComponent.VIEW_CODE,apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.TextComponent.VIEW_DESCRIPTION],apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.TextComponent.VIEW_MODES,defaultView:apogeeapp.app.TextComponent.VIEW_TEXT,clearFunctionMenuText:"Clear Formula",emptyDataValue:""},apogeeapp.app.TextComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.TextComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.TextComponent.prototype.getViewModeElement=function(a,b){switch(b){case apogeeapp.app.TextComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(a);case apogeeapp.app.TextComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(a);case apogeeapp.app.TextComponent.VIEW_TEXT:return new apogeeapp.app.AceTextMode(a);case apogeeapp.app.TextComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.TextComponent.createComponent=function(a,b,c){var d={};d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name,d.type=apogee.JsonTable.generator.type,d.updateData={},d.updateData.data="";var e=apogee.action.doAction(d),f=d.member;if(f){var g=new apogeeapp.app.TextComponent(a,f,c);e.component=g}return e},apogeeapp.app.TextComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.TextComponent(a,b,c);return d},apogeeapp.app.TextComponent.generator={},apogeeapp.app.TextComponent.generator.displayName="Text Table",apogeeapp.app.TextComponent.generator.uniqueName="apogeeapp.app.TextComponent",apogeeapp.app.TextComponent.generator.createComponent=apogeeapp.app.TextComponent.createComponent,apogeeapp.app.TextComponent.generator.createComponentFromJson=apogeeapp.app.TextComponent.createComponentFromJson,apogeeapp.app.TextComponent.generator.DEFAULT_WIDTH=300,apogeeapp.app.TextComponent.generator.DEFAULT_HEIGHT=300,apogeeapp.app.TextComponent.generator.ICON_RES_PATH="/textIcon.png",apogeeapp.app.FunctionComponent=function(a,b,c){apogeeapp.app.EditComponent.call(this,a,b,apogeeapp.app.FunctionComponent.generator,c),this.memberUpdated()},apogeeapp.app.FunctionComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.FunctionComponent.prototype.constructor=apogeeapp.app.FunctionComponent,apogeeapp.app.FunctionComponent.VIEW_CODE="Code",apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.FunctionComponent.VIEW_MODES=[apogeeapp.app.FunctionComponent.VIEW_CODE,apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION],apogeeapp.app.FunctionComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.FunctionComponent.VIEW_MODES,defaultView:apogeeapp.app.FunctionComponent.VIEW_CODE},apogeeapp.app.FunctionComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.FunctionComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.FunctionComponent.prototype.getViewModeElement=function(a,b){switch(b){case apogeeapp.app.FunctionComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(a);case apogeeapp.app.FunctionComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(a);case apogeeapp.app.FunctionComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.FunctionComponent.createComponent=function(a,b,c){var d={};d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name;var e;e=b.argListString?apogee.FunctionTable.parseStringArray(b.argListString):[],d.updateData={},d.updateData.argList=e,d.type=apogee.FunctionTable.generator.type;var f=apogee.action.doAction(d),g=d.member;if(g){var h=new apogeeapp.app.FunctionComponent(a,g,c);f.component=h}return f},apogeeapp.app.FunctionComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.FunctionComponent(a,b,c);return d},apogeeapp.app.FunctionComponent.generator={},apogeeapp.app.FunctionComponent.generator.displayName="Function",apogeeapp.app.FunctionComponent.generator.uniqueName="apogeeapp.app.FunctionComponent",apogeeapp.app.FunctionComponent.generator.createComponent=apogeeapp.app.FunctionComponent.createComponent,apogeeapp.app.FunctionComponent.generator.createComponentFromJson=apogeeapp.app.FunctionComponent.createComponentFromJson,apogeeapp.app.FunctionComponent.generator.DEFAULT_WIDTH=400,apogeeapp.app.FunctionComponent.generator.DEFAULT_HEIGHT=400,apogeeapp.app.FunctionComponent.generator.ICON_RES_PATH="/functionIcon.png",apogeeapp.app.FunctionComponent.generator.propertyDialogLines=[{type:"inputElement",heading:"Arg List: ",resultKey:"argListString"}],apogeeapp.app.FolderFunctionComponent=function(a,b,c){apogeeapp.app.ParentComponent.call(this,a,b,apogeeapp.app.FolderFunctionComponent.generator,c);var d=b.getInternalFolder();a.registerMember(d,this,b),this.memberUpdated(),this.addSaveAction(apogeeapp.app.FolderFunctionComponent.writeToJson)},apogeeapp.app.FolderFunctionComponent.prototype=Object.create(apogeeapp.app.ParentComponent.prototype),apogeeapp.app.FolderFunctionComponent.prototype.constructor=apogeeapp.app.FolderFunctionComponent,apogeeapp.app.FolderFunctionComponent.prototype.instantiateTabDisplay=function(){var a=this.getObject(),b=a.getInternalFolder();return this.tabDisplay=new apogeeapp.app.TabComponentDisplay(this,a,b),this.tabDisplay},apogeeapp.app.FolderFunctionComponent.writeToJson=function(a){var b=this.getObject(),c=b.getInternalFolder(),d=this.getWorkspaceUI();a.children=d.getFolderComponentContentJson(c)},apogeeapp.app.FolderFunctionComponent.createComponent=function(a,b,c){var d={};if(d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name,b.argListString){var e=apogee.FunctionTable.parseStringArray(b.argListString);d.argList=e}b.returnValueString&&(d.returnValue=b.returnValueString),b.internalFolder&&(d.internalFolder=b.internalFolder),d.type=apogee.FolderFunction.generator.type;var f=apogee.action.doAction(d),g=d.member;if(f.getSuccess()){var h=apogeeapp.app.FolderFunctionComponent.createComponentFromJson(a,g,c);f.component=h}return f},apogeeapp.app.FolderFunctionComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.FolderFunctionComponent(a,b,c);if(c&&c.children){var e=b.getInternalFolder();a.loadFolderComponentContentFromJson(e,c.children)}return d},apogeeapp.app.FolderFunctionComponent.generator={},apogeeapp.app.FolderFunctionComponent.generator.displayName="Folder Function",apogeeapp.app.FolderFunctionComponent.generator.uniqueName="apogeeapp.app.FolderFunctionComponent",apogeeapp.app.FolderFunctionComponent.generator.createComponent=apogeeapp.app.FolderFunctionComponent.createComponent,apogeeapp.app.FolderFunctionComponent.generator.createComponentFromJson=apogeeapp.app.FolderFunctionComponent.createComponentFromJson,apogeeapp.app.FolderFunctionComponent.generator.DEFAULT_WIDTH=500,apogeeapp.app.FolderFunctionComponent.generator.DEFAULT_HEIGHT=500,apogeeapp.app.FolderFunctionComponent.generator.ICON_RES_PATH="/functionFolderIcon.png",apogeeapp.app.FolderFunctionComponent.generator.propertyDialogLines=[{type:"inputElement",heading:"Arg List: ",resultKey:"argListString"},{type:"inputElement",heading:"Return Val: ",resultKey:"returnValueString"},{type:"invisible",resultKey:"internalFolder"}],apogeeapp.app.FolderFunctionComponent.generator.appendWorkspaceChildren=function(a,b){var c={};c.name=a.name,c.type=apogee.Folder.generator.type,apogeeapp.app.FolderComponent.generator.appendWorkspaceChildren(c,b),a.internalFolder=c},apogeeapp.app.BasicControlComponent=function(a,b,c,d){apogeeapp.app.EditComponent.call(this,a,b,c,d),this.doKeepAlive=!0,this.memberUpdated()},apogeeapp.app.BasicControlComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.BasicControlComponent.prototype.constructor=apogeeapp.app.BasicControlComponent,apogeeapp.app.BasicControlComponent.prototype.setDoKeepAlive=function(a){this.doKeepAlive=a,this.outputMode&&this.outputMode.setDoKeepAlive(a)},apogeeapp.app.BasicControlComponent.VIEW_OUTPUT="Output",apogeeapp.app.BasicControlComponent.VIEW_CODE="Code",apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.BasicControlComponent.VIEW_MODES=[apogeeapp.app.BasicControlComponent.VIEW_OUTPUT,apogeeapp.app.BasicControlComponent.VIEW_CODE,apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION],apogeeapp.app.BasicControlComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.BasicControlComponent.VIEW_MODES,defaultView:apogeeapp.app.BasicControlComponent.VIEW_OUTPUT},apogeeapp.app.BasicControlComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.BasicControlComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.BasicControlComponent.prototype.getViewModeElement=function(a,b){switch(b){case apogeeapp.app.BasicControlComponent.VIEW_OUTPUT:return this.outputMode||(this.outputMode=new apogeeapp.app.ControlOutputMode(a,this.doKeepAlive)),this.outputMode;case apogeeapp.app.BasicControlComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(a);case apogeeapp.app.BasicControlComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(a);case apogeeapp.app.BasicControlComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.BasicControlComponent.createGenerator=function(a,b,c){var d={},e=function(a,b,e){var f=(a.getWorkspace(),{});f.action="createMember",f.owner=b.parent,f.workspace=b.parent.getWorkspace(),f.name=b.name,f.type=apogee.JsonTable.generator.type;var g=apogee.action.doAction(f),h=f.member;if(h){var i=new c(a,h,d,e);g.component=i}return g},f=function(a,b,e){var f=new c(a,b,d,e);return f};return d.displayName=a,d.uniqueName=b,d.createComponent=e,d.createComponentFromJson=f,d.DEFAULT_WIDTH=500,d.DEFAULT_HEIGHT=500,d.ICON_RES_PATH="/controlIcon.png",d},apogeeapp.app.CustomControlComponent=function(a,b,c){apogeeapp.app.EditComponent.call(this,a,b,apogeeapp.app.CustomControlComponent.generator,c),this.uiCodeFields={},this.currentCss="",this.loadResourceFromJson(c),c&&c.doKeepAlive?this.doKeepAlive=!0:this.doKeepAlive=!1,this.memberUpdated(),this.addSaveAction(apogeeapp.app.CustomControlComponent.writeToJson)},apogeeapp.app.CustomControlComponent.prototype=Object.create(apogeeapp.app.EditComponent.prototype),apogeeapp.app.CustomControlComponent.prototype.constructor=apogeeapp.app.CustomControlComponent,apogeeapp.app.CustomControlComponent.prototype.getDataDisplay=function(a){var b=this.getUiCodeField(apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML),c=this.createResource(),d=new apogeeapp.app.HtmlJsDataDisplay(b,c,a);return d},apogeeapp.app.CustomControlComponent.prototype.getUiCodeFields=function(){return this.uiCodeFields},apogeeapp.app.CustomControlComponent.prototype.getUiCodeField=function(a){var b=this.uiCodeFields[a];return null!==b&&void 0!==b||(b=""),b},apogeeapp.app.CustomControlComponent.prototype.getDoKeepAlive=function(){return this.doKeepAlive},apogeeapp.app.CustomControlComponent.prototype.setDoKeepAlive=function(a){this.doKeepAlive=a,this.outputMode&&this.outputMode.setDoKeepAlive(a)},apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML="html",apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS="css",apogeeapp.app.CustomControlComponent.CODE_FIELD_INIT="init",apogeeapp.app.CustomControlComponent.CODE_FIELD_SET_DATA="setData",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_HIDE="onHide",apogeeapp.app.CustomControlComponent.CODE_FIELD_DESTROY="destroy",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_LOAD="onLoad",apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_RESIZE="onResize",apogeeapp.app.CustomControlComponent.CODE_FIELD_CONSTRUCTOR="constructorAddition",apogeeapp.app.CustomControlComponent.VIEW_OUTPUT="Output",apogeeapp.app.CustomControlComponent.VIEW_CODE="Model Code",apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE="Private",apogeeapp.app.CustomControlComponent.VIEW_HTML="HTML",apogeeapp.app.CustomControlComponent.VIEW_CSS="CSS",apogeeapp.app.CustomControlComponent.VIEW_INIT="init(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_SET_DATA="setData(data,element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_HIDE="onHide(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_DESTROY="destroy(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD="onLoad(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE="onResize(element,mode)",apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR="constructor(mode)",apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION="Notes",apogeeapp.app.CustomControlComponent.VIEW_MODES=[apogeeapp.app.CustomControlComponent.VIEW_OUTPUT,apogeeapp.app.CustomControlComponent.VIEW_CODE,apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE,apogeeapp.app.CustomControlComponent.VIEW_HTML,apogeeapp.app.CustomControlComponent.VIEW_CSS,apogeeapp.app.CustomControlComponent.VIEW_INIT,apogeeapp.app.CustomControlComponent.VIEW_SET_DATA,apogeeapp.app.CustomControlComponent.VIEW_ON_HIDE,apogeeapp.app.CustomControlComponent.VIEW_DESTROY,apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD,apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE,apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR,apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION],apogeeapp.app.CustomControlComponent.TABLE_EDIT_SETTINGS={viewModes:apogeeapp.app.CustomControlComponent.VIEW_MODES,defaultView:apogeeapp.app.CustomControlComponent.VIEW_OUTPUT},apogeeapp.app.CustomControlComponent.prototype.getTableEditSettings=function(){return apogeeapp.app.CustomControlComponent.TABLE_EDIT_SETTINGS},apogeeapp.app.CustomControlComponent.prototype.getViewModeElement=function(a,b){switch(b){case apogeeapp.app.CustomControlComponent.VIEW_OUTPUT:return this.outputMode||(this.outputMode=new apogeeapp.app.ControlOutputMode(a,this.doKeepAlive)),this.outputMode;case apogeeapp.app.CustomControlComponent.VIEW_CODE:return new apogeeapp.app.AceCodeMode(a);case apogeeapp.app.CustomControlComponent.VIEW_SUPPLEMENTAL_CODE:return new apogeeapp.app.AceSupplementalMode(a);case apogeeapp.app.CustomControlComponent.VIEW_HTML:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML);case apogeeapp.app.CustomControlComponent.VIEW_CSS:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS);case apogeeapp.app.CustomControlComponent.VIEW_INIT:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_INIT);case apogeeapp.app.CustomControlComponent.VIEW_SET_DATA:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_SET_DATA);case apogeeapp.app.CustomControlComponent.VIEW_ON_HIDE:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_HIDE);case apogeeapp.app.CustomControlComponent.VIEW_DESTROY:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_DESTROY);case apogeeapp.app.CustomControlComponent.VIEW_ON_LOAD:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_LOAD);
case apogeeapp.app.CustomControlComponent.VIEW_ON_RESIZE:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_ON_RESIZE);case apogeeapp.app.CustomControlComponent.VIEW_CONSTRUCTOR:return new apogeeapp.app.AceCustomControlMode(a,apogeeapp.app.CustomControlComponent.CODE_FIELD_CONSTRUCTOR);case apogeeapp.app.CustomControlComponent.VIEW_DESCRIPTION:return new apogeeapp.app.AceDescriptionMode(a);default:return alert("unrecognized view element!"),null}},apogeeapp.app.CustomControlComponent.prototype.updateFromJson=function(a){this.loadResourceFromJson(a)},apogeeapp.app.CustomControlComponent.prototype.loadResourceFromJson=function(a){var b;b=a&&a.resource?a.resource:{},this.update(b)},apogeeapp.app.CustomControlComponent.prototype.createResource=function(){try{var a="",b=this.getUiCodeFields();for(var c in apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS){var d=b[c];if(d&&""!=d){var e=apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS[c],f=apogee.util.formatString(e,d);a+=f+"\n"}}var g=apogee.util.formatString(apogeeapp.app.CustomControlComponent.GENERATOR_FUNCTION_FORMAT_TEXT,a),h=new Function(g),i=h(),j=i();return j}catch(k){alert("Error creating custom control: "+k.message)}},apogeeapp.app.CustomControlComponent.prototype.update=function(a){this.outputMode&&this.outputMode.triggerReload(),this.uiCodeFields=a;var b=this.getUiCodeField(apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS);b!==this.currentCss&&(""==b&&""==this.currentCss||(apogeeapp.ui.setMemberCssData(this.getObject().getId(),b),this.currentCss=b));var c=new apogee.ActionResponse;return c},apogeeapp.app.CustomControlComponent.writeToJson=function(a){a.resource=this.uiCodeFields},apogeeapp.app.CustomControlComponent.GENERATOR_FUNCTION_FORMAT_TEXT=["//member functions","var resourceFunction = function(component) {","var resource = {};","{0}","return resource;","}","//end member functions","return resourceFunction;",""].join("\n"),apogeeapp.app.CustomControlComponent.GENERATOR_INTERNAL_FORMATS={constructorAddition:"resource.constructorAddition = function(mode) {\n__customControlDebugHook();\n{0}\n};",init:"resource.init = function(element,mode) {\n{0}\n};",setData:"resource.setData = function(data,element,mode) {\n{0}\n};",onHide:"resource.onHide = function(element,mode) {\n{0}\n};",destroy:"resource.destroy = function(element,mode) {\n{0}\n};",onLoad:"resource.onLoad = function(element,mode) {\n{0}\n};",onResize:"resource.onResize = function(element,mode) {\n{0}\n};"},apogeeapp.app.CustomControlComponent.createComponent=function(a,b,c){var d={};d.action="createMember",d.owner=b.parent,d.workspace=b.parent.getWorkspace(),d.name=b.name,d.type=apogee.JsonTable.generator.type;var e=apogee.action.doAction(d),f=d.member;if(f){if(!b.destroyOnHide){var g;g=c?apogee.util.deepJsonCopy(c):{},g.doKeepAlive=!0}var h=new apogeeapp.app.CustomControlComponent.createComponentFromJson(a,f,g);e.component=h}return e},apogeeapp.app.CustomControlComponent.createComponentFromJson=function(a,b,c){var d=new apogeeapp.app.CustomControlComponent(a,b,c);return d},apogeeapp.app.CustomControlComponent.addPropFunction=function(a,b){var c=a.getDoKeepAlive();b.destroyOnHide=!c},apogeeapp.app.CustomControlComponent.updateProperties=function(a,b,c,d){var e=!c.destroyOnHide;a.setDoKeepAlive(e)},apogeeapp.app.CustomControlComponent.generator={},apogeeapp.app.CustomControlComponent.generator.displayName="Custom Control",apogeeapp.app.CustomControlComponent.generator.uniqueName="apogeeapp.app.CustomControlComponent",apogeeapp.app.CustomControlComponent.generator.createComponent=apogeeapp.app.CustomControlComponent.createComponent,apogeeapp.app.CustomControlComponent.generator.createComponentFromJson=apogeeapp.app.CustomControlComponent.createComponentFromJson,apogeeapp.app.CustomControlComponent.generator.DEFAULT_WIDTH=500,apogeeapp.app.CustomControlComponent.generator.DEFAULT_HEIGHT=500,apogeeapp.app.CustomControlComponent.generator.ICON_RES_PATH="/controlIcon.png",apogeeapp.app.CustomControlComponent.generator.propertyDialogLines=[{type:"checkbox",heading:"Destroy on Hide: ",resultKey:"destroyOnHide"}],apogeeapp.app.CustomControlComponent.generator.addPropFunction=apogeeapp.app.CustomControlComponent.addPropFunction,apogeeapp.app.CustomControlComponent.generator.updateProperties=apogeeapp.app.CustomControlComponent.updateProperties,apogeeapp.app.createworkspace={},apogeeapp.app.createworkspace.getCreateCallback=function(a){return function(){a.getWorkspaceUI()&&alert("There is already an open workspace. You must close the workspace first.");var b=apogeeapp.app.createworkspace.createWorkspace(a);b.getSuccess()||alert(b.getErrorMsg())}},apogeeapp.app.createworkspace.createWorkspace=function(a){var b,c=new apogee.ActionResponse;try{if(a.getWorkspaceUI())throw new Error("There is already an open workspace");var d=new apogeeapp.app.WorkspaceUI;b=a.setWorkspaceUI(d);var e=new apogee.Workspace;d.setWorkspace(e),c.workspaceUI=d}catch(f){b&&a.clearWorkspaceUI();var g=apogee.ActionError.processException(f,"AppException",!1);c.addError(g)}return c},apogeeapp.app.openworkspace={},apogeeapp.app.openworkspace.getOpenCallback=function(a){return function(){if(a.getWorkspaceUI())return void alert("There is already an open workspace. You must close the workspace first.");var b=function(b,c,d){if(b)alert("Error: "+b.message);else{var e=function(a){a.getSuccess()||alert(a.getErrorMsg())};apogeeapp.app.openworkspace.openWorkspace(a,c,d,e)}};apogeeapp.app.openworkspace.openFile(b)}},apogeeapp.app.openworkspace.openWorkspace=function(a,b,c,d){var e,f=new apogee.ActionResponse;try{if(a.getWorkspaceUI())throw new Error("There is already an open workspace");var g=JSON.parse(b),h=new apogeeapp.app.WorkspaceUI;e=a.setWorkspaceUI(h);var i,j,k=!1;g.jsLinks&&g.jsLinks.length>0?(i=g.jsLinks,k=!0):i=[],g.cssLinks&&g.cssLinks.length>0?(j=g.cssLinks,k=!0):j=[];var l=function(){apogeeapp.app.openworkspace.loadWorkspace(h,g),d(f)};k?h.setLinks(i,j,l):l()}catch(m){e&&a.clearWorkspaceUI();var n=apogee.ActionError.processException(m,"AppException",!1);f.addError(n),d(f)}},apogeeapp.app.openworkspace.loadWorkspace=function(a,b,c){var d=b.workspace,e=b.components,f=new apogee.Workspace(d,c);a.setWorkspace(f,e)},apogeeapp.app.openworkspace.openWorkspaceFromUrl=function(a,b){var c=function(a){a.getSuccess()||alert(a.getErrorMsg())};apogeeapp.app.openworkspace.openWorkspaceFromUrlImpl(a,b,c)},apogeeapp.app.openworkspace.openWorkspaceFromUrlImpl=function(a,b,c){var d=function(d){apogeeapp.app.openworkspace.openWorkspace(a,d,b,c)},e=function(a){var b=new apogee.ActionError(a,"AppException",null),d=new apogee.ActionResponse;d.addError(b),c(d)};apogeeapp.app.openworkspace.doRequest(b,d,e)},apogeeapp.app.openworkspace.doRequest=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){var a;4==d.readyState&&200==d.status?b(d.responseText):4==d.readyState&&d.status>=400&&(a="Error in http request. Status: "+d.status,c(a))},d.open("GET",a,!0),d.send()},apogeeapp.app.saveworkspace={},apogeeapp.app.saveworkspace.getSaveCallback=function(a,b){return function(){var a=apogeeapp.app.saveworkspace.getWorkspaceText();return a?void(void 0===b?apogeeapp.app.saveworkspace.showSaveDialog(a):apogeeapp.app.saveworkspace.saveFile(b,a)):void alert("There is no workspace open.")}},apogeeapp.app.saveworkspace.getWorkspaceText=function(){var a=app.getWorkspaceUI();if(a){var b=a.toJson();return JSON.stringify(b)}},apogeeapp.app.importworkspace={},apogeeapp.app.importworkspace.getImportCallback=function(a,b){return function(){if(!a.getWorkspaceUI())return void alert("There must be an open workspace to import a workspace.");var c=function(c,d,e){if(c)alert("Error: "+c.message);else{var f=function(a){a.getSuccess()||alert(a.getErrorMsg())};apogeeapp.app.importworkspace.openWorkspace(a,b,d,e,f)}};apogeeapp.app.openworkspace.openFile(c)}},apogeeapp.app.importworkspace.openWorkspace=function(a,b,c,d,e){var f=new apogee.ActionResponse;try{var g,h,i=a.getWorkspaceUI(),j=JSON.parse(c),k=!1;j.jsLinks&&j.jsLinks.length>0?(g=j.jsLinks,k=!0):g=[],j.cssLinks&&j.cssLinks.length>0?(h=j.cssLinks,k=!0):h=[];var l={};l.name=j.workspace.data.name,b.appendWorkspaceChildren(l,j.workspace.data.children);var m={};m.children=j.components;var n=apogeeapp.app.addcomponent.getAddComponentCallback(a,b,l,m);k?i.setLinks(g,h,n):n()}catch(o){var p=apogee.ActionError.processException(o,"AppException",!1);f.addError(p),e(f)}},apogeeapp.app.importworkspace.openWorkspaceFromUrl=function(a,b){var c=function(a){a.getSuccess()||alert(a.getErrorMsg())};apogeeapp.app.importworkspace.openWorkspaceFromUrlImpl(a,b,c)},apogeeapp.app.importworkspace.openWorkspaceFromUrlImpl=function(a,b,c){var d=function(d){apogeeapp.app.importworkspace.openWorkspace(a,d,b,c)},e=function(a){var b=new apogee.ActionError(a,"AppException",null),d=new apogee.ActionResponse;d.addError(b),c(d)};apogeeapp.app.importworkspace.doRequest(b,d,e)},apogeeapp.app.importworkspace.doRequest=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){var a;4==d.readyState&&200==d.status?b(d.responseText):4==d.readyState&&d.status>=400&&(a="Error in http request. Status: "+d.status,c(a))},d.open("GET",a,!0),d.send()},apogeeapp.app.exportworkspace={},apogeeapp.app.exportworkspace.getExportCallback=function(a){var b=function(){var b=a.getWorkspaceUI();if(!b)return void alert("There is no open workspace.");var c=b.getFolders(),d=[];for(var e in c)d.push(e);var f=apogeeapp.app.exportworkspace.getExportDialogLayout(d),g=function(a){var b=c[a.parentName],d=apogeeapp.app.exportworkspace.getWorkspaceText(b);return d?(apogeeapp.app.saveworkspace.showSaveDialog(d),!0):void alert("There is no workspace open.")};apogeeapp.app.dialog.showConfigurableDialog(f,g)};return b},apogeeapp.app.exportworkspace.getWorkspaceText=function(a){var b=app.getWorkspaceUI();if(b){var c=b.toJson(a);return JSON.stringify(c)}},apogeeapp.app.exportworkspace.getExportDialogLayout=function(a){var b={},c=[];b.lines=c;var d={};if(d.type="title",d.title="Export Folder as Workspace",c.push(d),a){var e={};e.type="dropdown",e.heading="Folder: ",e.entries=a,e.resultKey="parentName",c.push(e)}var f={};return f.type="submit",f.submit="OK",f.cancel="Cancel",c.push(f),b},apogeeapp.app.closeworkspace={},apogeeapp.app.closeworkspace.getCloseCallback=function(a){return function(){var b=apogeeapp.app.closeworkspace.closeWorkspace(a);b.getSuccess()||alert(b.getErrorMsg())}},apogeeapp.app.closeworkspace.closeWorkspace=function(a){var b=new apogee.ActionResponse,c=!1;try{var d=a.getWorkspaceUI();if(null===d){var e="There is no workspace open.",f=new apogee.ActionError(e,"User",null);return b.addError(f),b}var g=d.getWorkspace(),h=confirm("Are you sure you want to close the workspace?");if(!h)return b;c=a.clearWorkspaceUI(),d.close(),g.onClose()}catch(i){var j=!c,f=apogee.ActionError.processException(i,"AppException",j);b.addError(f)}return b},apogeeapp.app.addcomponent={},apogeeapp.app.addcomponent.getAddComponentCallback=function(a,b,c,d){var e=function(){var e=a.getWorkspaceUI();if(!e)return void alert("There is no open workspace.");var f=e.getFolders(),g=[];for(var h in f)g.push(h);var i=apogeeapp.app.propdialog.getDialogLayout(g,b,!0,c),j=function(a){var c=apogee.codeCompiler.validateTableName(a.name);if(!c.valid)return alert(c.errorMessage),!1;a.parent=f[a.parentName];var g=b.createComponent(e,a,d);return g.getSuccess()||alert(g.getErrorMsg()),!0};apogeeapp.app.dialog.showConfigurableDialog(i,j)};return e},apogeeapp.app.addcomponent.getAddAdditionalComponentCallback=function(a,b,c){return function(){var d=function(d){var e=a.getComponentGenerator(d);if(e){var f=apogeeapp.app.addcomponent.getAddComponentCallback(a,e,b,c);f()}else alert("Unknown component type: "+d)};apogeeapp.app.dialog.showSelectComponentDialog(a.additionalComponents,d)}},apogeeapp.app.updatecomponent={},apogeeapp.app.updatecomponent.getUpdateComponentCallback=function(a){var b=a.generator,c=function(){var c=a.getWorkspaceUI(),d=a.getPropertyValues(),e=null,f=null;if(a.getObject().getParent()){e=c.getFolders(),f=[];for(var g in e)f.push(g)}var h=apogeeapp.app.propdialog.getDialogLayout(f,b,!1,d),i=function(b){var c=!1;for(var f in b)b[f]!==d[f]&&(c=!0);if(!c)return!0;if(b.name!==d.name){var g=apogee.codeCompiler.validateTableName(b.name);if(!g.valid)return alert(g.errorMessage),!1}e?b.owner=e[b.parentName]:b.owner=a.getObject().getOwner();var h=apogeeapp.app.updatecomponent.updatePropertyValues(a,d,b);return h.getSuccess()||alert(h.getErrorMsg()),!0};apogeeapp.app.dialog.showConfigurableDialog(h,i)};return c},apogeeapp.app.updatecomponent.updatePropertyValues=function(a,b,c){var d,e=new apogee.ActionResponse,f=a.getObject(),g=a.getWorkspace(),h=[];b.name===c.name&&b.parentName===c.parentName||(d={},d.action="moveMember",d.member=f,d.name=c.name,d.owner=c.owner,h.push(d));var i=f.generator;return i.getPropertyUpdateAction&&(d=i.getPropertyUpdateAction(f,b,c),d&&h.push(d)),h.length>0&&(d={},d.action="compoundAction",d.actions=h,d.workspace=g,e=apogee.action.doAction(d,e)),a.generator.updateProperties&&a.generator.updateProperties(a,b,c,e),e},apogeeapp.app.updatelinks={},apogeeapp.app.updatelinks.getUpdateLinksCallback=function(a){return function(){var b=a.getWorkspaceUI();return b?void apogeeapp.app.dialog.showUpdateLinksDialog(b):void alert("There is no open workspace.")}},apogeeapp.app.ViewMode=function(a,b){this.componentDisplay=a,this.doKeepAlive=b,this.member=a.getMember(),this.dataDisplay=null,this.inEditMode=!1},apogeeapp.app.ViewMode.UNSAVED_DATA=-1,apogeeapp.app.ViewMode.CLOSE_OK=0,apogeeapp.app.ViewMode.prototype.getMember=function(){return this.member},apogeeapp.app.ViewMode.prototype.getUiObject=function(){return this.componentDisplay.getWindowFrame()},apogeeapp.app.ViewMode.prototype.setDoKeepAlive=function(a){this.doKeepAlive=a},apogeeapp.app.ViewMode.prototype.triggerReload=function(){this.dataDisplay&&(this.dataDisplay.destroy&&this.dataDisplay.destroy(),this.dataDisplay=null)},apogeeapp.app.ViewMode.prototype.showData=function(){this.dataDisplay||(this.dataDisplay=this.createDisplay()),this.dataDisplay.showData(this.getDisplayData(),this.getIsDataEditable())},apogeeapp.app.ViewMode.prototype.requestHide=function(){if(this.dataDisplay){if(this.dataDisplay.requestHide)return this.dataDisplay.requestHide();if(this.inEditMode)return apogeeapp.app.ViewMode.UNSAVED_DATA}return apogeeapp.app.ViewMode.CLOSE_OK},apogeeapp.app.ViewMode.prototype.hide=function(){this.dataDisplay&&(this.dataDisplay.hide&&this.dataDisplay.hide(),this.doKeepAlive||this.destroy())},apogeeapp.app.ViewMode.prototype.memberUpdated=function(){this.dataDisplay&&!this.inEditMode&&this.showData()},apogeeapp.app.ViewMode.prototype.getElement=function(){return this.dataDisplay?this.dataDisplay.getElement():null},apogeeapp.app.ViewMode.prototype.destroy=function(){this.dataDisplay&&(this.dataDisplay.destroy&&this.dataDisplay.destroy(),this.dataDisplay=null)},apogeeapp.app.ViewMode.prototype.onCancel=function(){return this.showData(),!0},apogeeapp.app.ViewMode.prototype.startEditMode=function(a,b){this.inEditMode=!0,this.componentDisplay.startEditUI(a,b)},apogeeapp.app.ViewMode.prototype.endEditMode=function(){this.inEditMode=!1,this.componentDisplay.endEditUI()},apogeeapp.app.TextAreaEditor=function(a){this.outsideDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"});var b=apogeeapp.ui.createElement("TEXTAREA",null,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",overflow:"auto"});this.textArea=b,this.textArea.readOnly=!0,this.outsideDiv.appendChild(this.textArea),this.viewMode=a,this.workingData=null,this.editOk=!1,this.editMode=!1;var c=this,d=function(){c.onMouseClick()};this.textArea.addEventListener("click",d)},apogeeapp.app.TextAreaEditor.prototype.save=function(){var a=this.textArea.value,b=this.viewMode.onSave(a);b&&this.endEditMode()},apogeeapp.app.TextAreaEditor.prototype.cancel=function(){var a=this.viewMode.onCancel();a&&this.endEditMode()},apogeeapp.app.TextAreaEditor.prototype.getElement=function(){return this.outsideDiv},apogeeapp.app.TextAreaEditor.prototype.showData=function(a,b){this.editOk=b,this.textArea.readOnly=!b,this.textArea.value=a,this.editOk?this.textArea.style.backgroundColor="":this.textArea.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR},apogeeapp.app.TextAreaEditor.prototype.destroy=function(){},apogeeapp.app.TextAreaEditor.prototype.endEditMode=function(){this.editMode=!1,this.textArea.readOnly=!0,this.viewMode.endEditMode()},apogeeapp.app.TextAreaEditor.prototype.onMouseClick=function(){if(this.editOk&&!this.editMode){var a=this,b=function(){a.save()},c=function(){a.cancel()};this.viewMode.startEditMode(b,c),this.textArea.readOnly=!1,this.editMode=!0}},apogeeapp.app.TextAreaMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.TextAreaMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.TextAreaMode.prototype.constructor=apogeeapp.app.TextAreaMode,apogeeapp.app.TextAreaMode.formatString="\t",apogeeapp.app.TextAreaMode.prototype.createDisplay=function(){return new apogeeapp.app.TextAreaEditor(this)},apogeeapp.app.TextAreaMode.prototype.getDisplayData=function(){var a,b=this.member.getData();return a=null===b?"null":void 0===b?"undefined":JSON.stringify(b,null,apogeeapp.app.TextAreaMode.formatString)},apogeeapp.app.TextAreaMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.TextAreaMode.prototype.onSave=function(a){var b;if(a.length>0)try{b=JSON.parse(a)}catch(c){return alert("There was an error parsing the JSON input: "+c.message),!1}else b="";var d={};d.action="updateData",d.member=this.member,d.data=b;apogee.action.doAction(d);return!0},apogeeapp.app.AceTextEditor=function(a,b){this.outsideDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"}),this.editorDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.outsideDiv.appendChild(this.editorDiv),this.viewMode=a,this.workingData=null,this.editOk=!1,this.editMode=!1;var c=ace.edit(this.editorDiv);c.renderer.setShowGutter(!0),c.setReadOnly(!0),c.setTheme("ace/theme/eclipse"),c.getSession().setMode(b),c.$blockScrolling=1/0,this.editor=c,this.resizeCallback=function(){c.resize()},this.callbackAttached=!1;var d=this,e=function(){d.onMouseClick()};this.editorDiv.addEventListener("click",e)},apogeeapp.app.AceTextEditor.prototype.save=function(){var a=this.editor.getSession().getValue(),b=this.viewMode.onSave(a);b&&this.endEditMode()},apogeeapp.app.AceTextEditor.prototype.cancel=function(){var a=this.viewMode.onCancel();a&&this.endEditMode()},apogeeapp.app.AceTextEditor.prototype.getElement=function(){return this.outsideDiv},apogeeapp.app.AceTextEditor.prototype.showData=function(a,b){if(this.editOk=b,this.editor.getSession().setValue(a),this.editOk?this.editorDiv.style.backgroundColor="":this.editorDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR,!this.callbackAttached){var c=this.viewMode.getUiObject();c&&(c.addListener(apogeeapp.ui.RESIZED_EVENT,this.resizeCallback),c.addListener(apogeeapp.ui.SHOWN_EVENT,this.resizeCallback),this.callbackAttached=!0)}this.resizeCallback()},apogeeapp.app.AceTextEditor.prototype.hide=function(){var a=this.viewMode.getUiObject();a&&(a.removeListener(apogeeapp.ui.RESIZED_EVENT,this.resizeCallback),a.removeListener(apogeeapp.ui.SHOWN_EVENT,this.resizeCallback),this.callbackAttached=!1)},apogeeapp.app.AceTextEditor.prototype.destroy=function(){this.editor&&(this.editor.destroy(),this.editor=null)},apogeeapp.app.AceTextEditor.prototype.endEditMode=function(){this.editMode=!1,this.editor.setReadOnly(!0),this.viewMode.endEditMode()},apogeeapp.app.AceTextEditor.prototype.onMouseClick=function(){if(this.editOk&&!this.editMode){var a=this,b=function(){a.save()},c=function(){a.cancel()};this.viewMode.startEditMode(b,c),this.editor.setReadOnly(!1),this.editMode=!0}},apogeeapp.app.AceCodeMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.AceCodeMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceCodeMode.prototype.constructor=apogeeapp.app.AceCodeMode,apogeeapp.app.AceCodeMode.prototype.createDisplay=function(){return new apogeeapp.app.AceTextEditor(this,"ace/mode/javascript")},apogeeapp.app.AceCodeMode.prototype.getDisplayData=function(){return this.member.getFunctionBody()},apogeeapp.app.AceCodeMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceCodeMode.prototype.onSave=function(a){var b={};this.onBlankData&&""===a?(b.action="updateData",b.member=this.member,b.data=this.onBlankData.dataValue):(b.action="updateCode",b.member=this.member,b.argList=this.member.getArgList(),b.functionBody=a,b.supplementalCode=this.member.getSupplementalCode());apogee.action.doAction(b);return!0},apogeeapp.app.AceDataMode=function(a,b){apogeeapp.app.ViewMode.call(this,a),this.doJsonFormatting=b},apogeeapp.app.AceDataMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceDataMode.prototype.constructor=apogeeapp.app.AceDataMode,apogeeapp.app.AceDataMode.formatString="\t",apogeeapp.app.AceDataMode.prototype.createDisplay=function(){var a=this.doJsonFormatting?"ace/mode/json":"ace/mode/text";return new apogeeapp.app.AceTextEditor(this,a)},apogeeapp.app.AceDataMode.prototype.getDisplayData=function(){var a,b=this.member.getData();return a=null===b?"null":void 0===b?"undefined":JSON.stringify(b,null,apogeeapp.app.AceDataMode.formatString)},apogeeapp.app.AceDataMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.AceDataMode.prototype.onSave=function(a){var b;if(a.length>0)try{b=JSON.parse(a)}catch(c){return alert("There was an error parsing the JSON input: "+c.message),!1}else b="";var d={};d.action="updateData",d.member=this.member,d.data=b;apogee.action.doAction(d);return!0},apogeeapp.app.AceDescriptionMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.AceDescriptionMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceDescriptionMode.prototype.constructor=apogeeapp.app.AceDescriptionMode,apogeeapp.app.AceDescriptionMode.prototype.createDisplay=function(){return new apogeeapp.app.TextAreaEditor(this)},apogeeapp.app.AceDescriptionMode.prototype.getDisplayData=function(){return this.member.getDescription()},apogeeapp.app.AceDescriptionMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceDescriptionMode.prototype.onSave=function(a){null!==a&&void 0!==a||(a="");var b={};b.action="updateDescription",b.member=this.member,b.description=a;apogee.action.doAction(b);return!0},apogeeapp.app.AceTextMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.AceTextMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceTextMode.prototype.constructor=apogeeapp.app.AceTextMode,apogeeapp.app.AceTextMode.prototype.createDisplay=function(){return new apogeeapp.app.AceTextEditor(this,"ace/mode/text")},apogeeapp.app.AceTextMode.prototype.getDisplayData=function(){var a,b=this.member.getData();return a=null===b||void 0===b?"":b},apogeeapp.app.AceTextMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.AceTextMode.prototype.onSave=function(a){null!==a&&void 0!==a||(a="");var b={};b.action="updateData",b.member=this.member,b.data=a;apogee.action.doAction(b);return!0},apogeeapp.app.AceSupplementalMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.AceSupplementalMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceSupplementalMode.prototype.constructor=apogeeapp.app.AceSupplementalMode,apogeeapp.app.AceSupplementalMode.prototype.createDisplay=function(){return new apogeeapp.app.AceTextEditor(this,"ace/mode/javascript")},apogeeapp.app.AceSupplementalMode.prototype.getDisplayData=function(){return this.member.getSupplementalCode()},apogeeapp.app.AceSupplementalMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceSupplementalMode.prototype.onSave=function(a){var b={};b.action="updateCode",b.member=this.member,b.argList=this.member.getArgList(),b.functionBody=this.member.getFunctionBody(),b.supplementalCode=a;var c=apogee.action.doAction(b);return!c.getSuccess(),!0},apogeeapp.app.AceCustomControlMode=function(a,b){apogeeapp.app.ViewMode.call(this,a),this.component=a.getComponent(),this.codeField=b},apogeeapp.app.AceCustomControlMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.AceCustomControlMode.prototype.constructor=apogeeapp.app.AceCustomControlMode,apogeeapp.app.AceCustomControlMode.prototype.createDisplay=function(){var a;return a=this.codeField===apogeeapp.app.CustomControlComponent.CODE_FIELD_HTML?"ace/mode/html":this.codeField===apogeeapp.app.CustomControlComponent.CODE_FIELD_CSS?"ace/mode/css":"ace/mode/javascript",new apogeeapp.app.AceTextEditor(this,a)},apogeeapp.app.AceCustomControlMode.prototype.getDisplayData=function(){var a=this.component.getUiCodeFields(),b=a[this.codeField];return void 0!==b&&null!==b||(b=""),b},apogeeapp.app.AceCustomControlMode.prototype.getIsDataEditable=function(){return!0},apogeeapp.app.AceCustomControlMode.prototype.onSave=function(a){var b=this.component.getUiCodeFields();b[this.codeField]=a;var c=this.component.update(b);if(!c.getSuccess()){var d=c.getErrorMsg();alert(d)}return!0},apogeeapp.app.HtmlJsDataDisplay=function(a,b,c){if(this.resource=b,this.outputMode=c,this.containerElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"}),this.outputElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.containerElement.appendChild(this.outputElement),a&&(this.outputElement.innerHTML=a),b.constructorAddition)try{b.constructorAddition.call(this,c)}catch(d){alert("Error in "+this.outputMode.getFullName()+" init function: "+d.message)}var e,f,g=!1,h=!1,i=this;if(b.onLoad&&(f=function(){try{b.onLoad.call(i,i.outputElement,i.outputMode)}catch(a){alert("Error in "+i.outputMode.getFullName()+" onLoad function: "+a.message)}i.outputMode.showData()},g=!0),g&&apogeeapp.ui.setLoadListener(this.containerElement,f),b.onResize&&(e=function(){try{b.onResize.call(i,i.outputElement,i.outputMode)}catch(a){console.log("Error in "+i.outputMode.getFullName()+" onResize function: "+a.message)}},h=!0),this.resource.setData||h?this.showData=function(a){try{if(this.resource.setData&&b.setData.call(i,a,i.outputElement,i.outputMode),h&&!i.callbackAttached){var c=i.outputMode.getUiObject();c&&(c.addListener(apogeeapp.ui.RESIZED_EVENT,e),i.callbackAttached=!0)}}catch(d){alert("Error in "+i.outputMode.getFullName()+" setData function: "+d.message)}}:this.showData=function(a){},this.resource.hideRequest&&(this.hideRequest=function(){try{b.onHide.call(i,i.outputElement,i.outputMode)}catch(a){alert("Error in "+i.outputMode.getFullName()+" onHide function: "+a.message)}}),(this.resource.onHide||i.callbackAttached)&&(this.hide=function(){try{if(i.resource.onHide&&b.onHide.call(i,i.outputElement,i.outputMode),i.callbackAttached){var a=i.outputMode.getUiObject();a&&(a.removeListener(apogeeapp.ui.RESIZED_EVENT,i.resizeCallback),i.callbackAttached=!1)}}catch(c){alert("Error in "+i.outputMode.getFullName()+" onHide function: "+c.message)}}),this.resource.destroy&&(this.destroy=function(){try{b.destroy.call(i,i.outputElement,i.outputMode)}catch(a){alert("Error in "+i.outputMode.getFullName()+" destroy function: "+a.message)}}),b.init)try{b.init.call(this,this.outputElement,c)}catch(d){alert("Error in "+this.outputMode.getFullName()+" init function: "+d.message)}},apogeeapp.app.HtmlJsDataDisplay.prototype.getElement=function(){return this.containerElement},apogeeapp.app.JsDataDisplay=function(a){this.outputMode=a,this.outputElement=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"})},apogeeapp.app.JsDataDisplay.prototype.getElement=function(){return this.outputElement},apogeeapp.app.JsDataDisplay.prototype.getOutputMode=function(){return this.outputMode},apogeeapp.app.JsonFormEditor=function(a){this.editorDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"auto"}),this.workingData={d:"c"},this.editOk=!1,this.editor=null;var b=this;this.editCallback=function(){var c=b.editor.getCurrentValue();b.workingData=c,a.onSave(c)}},apogeeapp.app.JsonFormEditor.prototype.getElement=function(){return this.editorDiv},apogeeapp.app.JsonFormEditor.prototype.showData=function(a,b){a===this.workingData&&this.editOk===b||(void 0===a&&(a=null),this.workingData=apogee.util.deepJsonCopy(a),this.editOk=b,apogeeapp.ui.removeAllChildren(this.editorDiv),this.editor=new apogeeapp.jsonedit.JsonEditArea(this.editorDiv,a,b),this.editor.setEditCallback(this.editCallback),this.editOk?this.editorDiv.style.backgroundColor="":this.editorDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR)},apogeeapp.app.JsonFormEditor.prototype.destroy=function(){},apogeeapp.app.FormDataMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.FormDataMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.FormDataMode.prototype.constructor=apogeeapp.app.FormDataMode,apogeeapp.app.FormDataMode.prototype.createDisplay=function(){return new apogeeapp.app.JsonFormEditor(this)},apogeeapp.app.FormDataMode.prototype.getDisplayData=function(){return this.member.getData()},apogeeapp.app.FormDataMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.FormDataMode.prototype.onSave=function(a){var b={};b.action="updateData",b.member=this.member,b.data=a;apogee.action.doAction(b);return!0},apogeeapp.app.HandsonGridEditor=function(a){this.outsideDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"}),this.gridDiv=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",left:"0px",width:"50px",height:"50px",overflow:"hidden",zIndex:0}),this.outsideDiv.appendChild(this.gridDiv),this.viewMode=a,this.inputData=null,this.editOk=!1;var b=this;this.resizeCallback=function(){b.gridDiv.style.width=b.outsideDiv.clientWidth+"px",b.gridDiv.style.height=b.outsideDiv.clientHeight+"px",b.gridControl&&b.gridControl.render()},this.callbackAttached=!1,this.loadCallback=function(){b.onLoad(a)},apogeeapp.ui.setLoadListener(this.outsideDiv,this.loadCallback),this.loaded=!1,this.gridEdited=function(a){b.save(arguments)},this.timerInProcess=!1;var c=50;this.delayGridEdited=function(a){if(!b.timerInProcess){b.timerInProcess=!0;var d=function(a){b.timerInProcess=!1,b.gridEdited(arguments)};setTimeout(d,c)}}},apogeeapp.app.HandsonGridEditor.prototype.save=function(a){"loadData"!=a[1]&&(this.inputData=apogee.util.deepJsonCopy(this.gridControl.getData()),this.viewMode.onSave(this.inputData))},apogeeapp.app.HandsonGridEditor.prototype.cancel=function(){this.viewMode.onCancel()},apogeeapp.app.HandsonGridEditor.prototype.getElement=function(){return this.outsideDiv},apogeeapp.app.HandsonGridEditor.prototype.showData=function(a,b){if(this.loaded&&(this.inputData!==a||!b)){var c=this.editOk;this.editOk=b,this.inputData=a;var d=apogee.util.deepJsonCopy(a);if(d||(d=[[]]),this.gridControl&&c===b?this.gridControl.loadData(d):this.createNewGrid(d),this.editOk?this.gridDiv.style.backgroundColor="":this.gridDiv.style.backgroundColor=apogeeapp.app.EditWindowComponentDisplay.NO_EDIT_BACKGROUND_COLOR,!this.callbackAttached){var e=this.viewMode.getUiObject();e&&(e.addListener(apogeeapp.ui.RESIZED_EVENT,this.resizeCallback),
this.callbackAttached=!0),this.resizeCallback()}}},apogeeapp.app.HandsonGridEditor.prototype.onLoad=function(a){this.loaded=!0,a.showData()},apogeeapp.app.HandsonGridEditor.prototype.hide=function(){var a=this.viewMode.getUiObject();a&&(a.removeListener(apogeeapp.ui.RESIZED_EVENT,this.resizeCallback),this.callbackAttached=!1),this.loaded=!1},apogeeapp.app.HandsonGridEditor.prototype.destroy=function(){this.gridControl&&(this.gridControl.destroy(),this.gridControl=null)},apogeeapp.app.HandsonGridEditor.prototype.createNewGrid=function(a){this.gridControl&&(this.gridControl.destroy(),this.gridControl=null);var b;this.editOk?(b={data:a,rowHeaders:!0,colHeaders:!0,contextMenu:!0,afterChange:this.gridEdited,afterCreateCol:this.delayGridEdited,afterCreateRow:this.delayGridEdited,afterRemoveCol:this.gridEdited,afterRemoveRow:this.gridEdited},this.gridEditable=!0):(b={data:a,readOnly:!0,rowHeaders:!0,colHeaders:!0},this.gridEditable=!1),this.gridControl=new Handsontable(this.gridDiv,b)},apogeeapp.app.HandsonGridMode=function(a){apogeeapp.app.ViewMode.call(this,a)},apogeeapp.app.HandsonGridMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.HandsonGridMode.prototype.constructor=apogeeapp.app.HandsonGridMode,apogeeapp.app.HandsonGridMode.prototype.createDisplay=function(){return new apogeeapp.app.HandsonGridEditor(this)},apogeeapp.app.HandsonGridMode.prototype.getDisplayData=function(){return this.member.getData()},apogeeapp.app.HandsonGridMode.prototype.getIsDataEditable=function(){return!this.member.hasCode()},apogeeapp.app.HandsonGridMode.prototype.onSave=function(a){var b={};b.action="updateData",b.member=this.member,b.data=a;apogee.action.doAction(b);return!0},apogeeapp.app.ControlOutputMode=function(a,b){apogeeapp.app.ViewMode.call(this,a,b),this.component=a.getComponent(),this.member=this.component.getObject()},apogeeapp.app.ControlOutputMode.prototype=Object.create(apogeeapp.app.ViewMode.prototype),apogeeapp.app.ControlOutputMode.prototype.constructor=apogeeapp.app.ControlOutputMode,apogeeapp.app.ControlOutputMode.prototype.createDisplay=function(){return this.component.getDataDisplay(this)},apogeeapp.app.ControlOutputMode.prototype.getDisplayData=function(){return this.member.getData()},apogeeapp.app.ControlOutputMode.prototype.getFullName=function(){return this.member.getFullName()},apogeeapp.app.ControlOutputMode.prototype.getMessenger=function(){return new apogee.action.Messenger(this.member)},apogeeapp.app.ControlOutputMode.prototype.getIsDataEditable=function(){return!1},apogeeapp.app.dialog.showConfigurableDialog=function(a,b){var c=apogeeapp.ui.createDialog({movable:!0}),d=[],e={};e.onClose=function(){for(var a=0;a<d.length;a++)i=d[a],i.onClose&&i.onClose();apogeeapp.ui.closeDialog(c)},e.onCancel=function(){e.onClose()},e.onSubmit=function(){for(var a,c={},f=0;f<d.length;f++)a=d[f],a.addToResult&&a.addToResult(c);var g=b(c);g&&e.onClose()};for(var f=apogeeapp.ui.createElement("div",{className:"dialogBody"}),g=0;g<a.lines.length;g++){var h=a.lines[g],i=apogeeapp.app.dialog.showConfigurableDialog.createLine(h,e);d.push(i),i.element&&f.appendChild(i.element)}c.setContent(f),apogeeapp.ui.showDialog(c),c.fitToContent(),c.centerInParent()},apogeeapp.app.dialog.showConfigurableDialog.createLine=function(a,b){var c=apogeeapp.app.dialog.showConfigurableDialog.lineFunctions[a.type];return c?c(a,b):(alert("Error: Unknown for element type: "+a.type),null)},apogeeapp.app.dialog.showConfigurableDialog.lineFunctions={title:function(a,b){var c={},d=apogeeapp.ui.createElement("div",{className:"dialogLine"});return d.appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:a.title})),c.element=d,c},dropdown:function(a,b){var c={},d=apogeeapp.ui.createElement("div",{className:"dialogLine"});a.heading&&d.appendChild(document.createTextNode(a.heading));for(var e=apogeeapp.ui.createElement("select"),f=0;f<a.entries.length;f++){var g=a.entries[f];e.add(apogeeapp.ui.createElement("option",{text:g}))}return a.initial&&(e.value=a.initial),a.disabled&&(e.disabled=!0),d.appendChild(e),c.element=d,c.addToResult=function(b){var c=e.value;b[a.resultKey]=c},c},inputElement:function(a,b){var c={},d=apogeeapp.ui.createElement("div",{className:"dialogLine"});a.heading&&d.appendChild(document.createTextNode(a.heading));var e=apogeeapp.ui.createElement("input",{type:"text"});return a.initial&&(e.value=a.initial),a.disabled&&(e.disabled=!0),d.appendChild(e),c.element=d,c.addToResult=function(b){var c=e.value.trim();b[a.resultKey]=c},c},aceEditor:function(a,b){},radioButton:function(a,b){},checkbox:function(a,b){var c={},d=apogeeapp.ui.createElement("div",{className:"dialogLine"});a.heading&&d.appendChild(document.createTextNode(a.heading));var e=apogeeapp.ui.createElement("input");return e.type="checkbox",a.name&&(e.name=a.name),a.value&&(e.value=a.value),a.initial&&(e.checked=!0),d.appendChild(e),c.element=d,c.addToResult=function(b){var c=e.checked;b[a.resultKey]=c},c},submit:function(a,b){var c={},d=apogeeapp.ui.createElement("div",{className:"dialogLine"});return a.submit&&d.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:a.submit,onclick:b.onSubmit})),a.cancel&&d.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:a.cancel,onclick:b.onCancel})),c.element=d,c},custom:function(a,b){return a.createLineObject(b)},invisible:function(a,b){var c={};return c.element=null,c.addToResult=function(b){b[a.resultKey]=a.initial},c}},apogeeapp.app.dialog.showUpdateLinksDialog=function(a){var b=apogeeapp.ui.createDialog({minimizable:!0,maximizable:!0,movable:!0}),c=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",height:"100%",overflow:"auto"});b.setContent(c);var d,e=apogeeapp.ui.createElement("div",null,{display:"table",overflow:"hidden"});c.appendChild(e);var d;d=apogeeapp.ui.createElement("div",{className:"dialogLine"}),d.appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:"Update Links"})),e.appendChild(d),d=apogeeapp.ui.createElement("div",{className:"dialogLine"});var f=apogeeapp.ui.createElement("input",{type:"radio",name:"componentContent",value:"jsLinks"});d.appendChild(f),d.appendChild(document.createTextNode("JS Links")),e.appendChild(d);var g=apogeeapp.ui.createElement("input",{type:"radio",name:"componentContent",value:"cssLinks"});d.appendChild(g),d.appendChild(document.createTextNode("CSS Links")),d=apogeeapp.ui.createElement("div",{className:"dialogLine"});var h=apogeeapp.ui.createElement("div",null,{position:"relative",width:"500px",height:"300px",border:"1px solid darkgray"});d.appendChild(h),e.appendChild(d);var i=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px"}),j=null;h.appendChild(i);var k=apogeeapp.ui.createElement("div",null,{position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px"}),l=null;h.appendChild(k),d=apogeeapp.ui.createElement("div",{className:"dialogLine"});var m=function(){o()},n=function(){var b,c;if(j){var d=j.getSession().getValue().trim();b=apogeeapp.app.dialog.createLinkArray(d)}else b=[];if(l){var e=l.getSession().getValue().trim();c=apogeeapp.app.dialog.createLinkArray(e)}else c=[];a.setLinks(b,c),o()},o=function(){apogeeapp.ui.closeDialog(b),j&&(j.destroy(),j=null),l&&(l.destroy(),l=null)};d.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Save",onclick:n})),d.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Cancel",onclick:m})),e.appendChild(d),b.setContent(e),apogeeapp.ui.showDialog(b),b.fitToContent(),b.centerInParent();var p=function(){if(k.style.display="none",i.style.display="",!j){j=ace.edit(i),j.$blockScrolling=1/0,j.setTheme("ace/theme/eclipse"),j.getSession().setMode("ace/mode/text");var b=a.getJsLinks();if(b){var c=b.join("\n");j.getSession().setValue(c)}}},q=function(){if(k.style.display="",i.style.display="none",!l){l=ace.edit(k),l.$blockScrolling=1/0,l.setTheme("ace/theme/eclipse"),l.getSession().setMode("ace/mode/text");var b=a.getCssLinks();if(b){var c=b.join("\n");l.getSession().setValue(c)}}};f.checked=!0,p();var r=function(){g.checked?q():f.checked&&p()};g.onchange=r,f.onchange=r},apogeeapp.app.dialog.createLinkText=function(a){return a.join("\n")},apogeeapp.app.dialog.createLinkArray=function(a){return a&&0!==a.length?a.split(/\s/):[]},apogeeapp.app.dialog.showSelectComponentDialog=function(a,b){var c=apogeeapp.ui.createDialog({movable:!0}),d=apogeeapp.ui.createElement("div",null,{display:"block",position:"relative",top:"0px",height:"100%",overflow:"auto"});c.setContent(d);var e,f=apogeeapp.ui.createElement("div",null,{display:"table",overflow:"hidden"});d.appendChild(f);var e;e=apogeeapp.ui.createElement("div",{className:"dialogLine"}),e.appendChild(apogeeapp.ui.createElement("div",{className:"dialogTitle",innerHTML:"Select Component Type"})),f.appendChild(e),e=apogeeapp.ui.createElement("div",{className:"dialogLine"}),e.appendChild(document.createTextNode("Component:"));var g=apogeeapp.ui.createElement("select");e.appendChild(g);for(var h=0;h<a.length;h++){var i=a[h];g.add(apogeeapp.ui.createElement("option",{text:i}))}f.appendChild(e),e=apogeeapp.ui.createElement("div",{className:"dialogLine"});var j=function(){apogeeapp.ui.closeDialog(c)},k=function(){var a=g.value;b(a),apogeeapp.ui.closeDialog(c)};e.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Create",onclick:k})),e.appendChild(apogeeapp.ui.createElement("button",{className:"dialogButton",innerHTML:"Cancel",onclick:j})),f.appendChild(e),c.setContent(f),apogeeapp.ui.showDialog(c),c.fitToContent(),c.centerInParent()},apogeeapp.app.propdialog={},apogeeapp.app.propdialog.getDialogLayout=function(a,b,c,d){var e=apogee.util.deepJsonCopy(b.propertyDialogLines),f={},g=[];f.lines=g;var h={};if(h.type="title",c?h.title="New "+b.displayName:h.title="Update "+b.displayName,g.push(h),a){var i={};i.type="dropdown",i.heading="Folder: ",i.entries=a,i.resultKey="parentName",g.push(i)}var j={};if(j.type="inputElement",j.heading="Name: ",j.resultKey="name",g.push(j),e)for(var k=0;k<e.length;k++)g.push(e[k]);var l={};if(l.type="submit",c?l.submit="Create":l.submit="Update",l.cancel="Cancel",g.push(l),d)for(var k=0;k<g.length;k++){var m=g[k];m.resultKey&&(m.initial=d[m.resultKey])}return f};