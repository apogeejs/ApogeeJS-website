{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":1,"lists":{"es module":{"treeState":0},"js link":{"treeState":0},"css link":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"DataCellAndDownload","children":{"main":{"name":"main","type":"apogee.Folder","children":{"url":{"name":"url","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return \"https://www.apogeejs.com/web/examples/population/us\" + yearsAvailable[0] + \".json\"\n\n//to view errors, use the following line instead\n//return \"https://www.apogeejs.com/web/examples/population/us\" + yearsAvailable[0] + \".jsonXXX\"","supplementalCode":""}},"yearsAvailable":{"name":"yearsAvailable","type":"apogee.JsonMember","updateData":{"data":[1980,2000,2017]}},"basicJsonDownload":{"name":"basicJsonDownload","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return apogeeutil.jsonRequest(url);","supplementalCode":""}},"basicTextDownload":{"name":"basicTextDownload","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return apogeeutil.textRequest(url);","supplementalCode":""}},"comparison":{"name":"comparison","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return apogeeutil.jsonEquals(basicJsonDownload,JSON.parse(basicTextDownload));","supplementalCode":""}},"downloadWithFetch":{"name":"downloadWithFetch","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":" return fetch(url).then(response => {\n    if(response.ok) return response.json();\n    else return new Error(\"Error in http request: \" + response.status);\n})","supplementalCode":""}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Apogee Basics: Data Cells and Downloading Data"}]},{"type":"paragraph","content":[{"type":"text","text":"Apogee looks something like a Jupyter notebook, but the cells are very different. It was originally inspired by the spreadsheet. You write code by putting formulas in cells, and the cells show the result of those formulas."}]},{"type":"paragraph","content":[{"type":"text","text":"The basic cell is the Data Cell. Like a spreadsheet cell, you can enter a static value or a formula. However, the static value is any JSON value. And the formula is a javascript function."}]},{"type":"paragraph","content":[{"type":"text","text":"Here is a Data Cell with a static value. In this case it is a string JSON value."}]},{"type":"apogeeComponent","attrs":{"name":"yearsAvailable","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Below, we show a Data Cell with a formula. Notice how it references the other cell by name. The names of cells can be used as read-only variable names in other cells."}]},{"type":"apogeeComponent","attrs":{"name":"url","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Downloading Data"}]},{"type":"paragraph","content":[{"type":"text","text":"You can do just about anything else possible in a programming language. Right here we will make some HTTP requests."}]},{"type":"paragraph","content":[{"type":"text","text":"Apogee will automatically handle asynchronous actions. All you have to do is return a Promise object from the function."}]},{"type":"heading3","content":[{"type":"text","text":"Download with Convenient Library Functions"}]},{"type":"paragraph","content":[{"type":"text","text":"For HTTP requests, the Apogee library includes some convenient helper functions."}]},{"type":"paragraph","content":[{"type":"text","text":"Here we request a URL with the data returned as a JSON object."}]},{"type":"apogeeComponent","attrs":{"name":"basicJsonDownload","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"While an asynchronous action is being done, a yellow banner is placed on the cell. Any cell that depends on this one will wait for it to finish before it is evaluated."}]},{"type":"paragraph","content":[{"type":"text","text":"Below, we show a request the returns a text object. In this case we will use the same URL and show that the result is a text object."}]},{"type":"apogeeComponent","attrs":{"name":"basicTextDownload","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"We can show these are equal below (but actually we are just trying to show more examples of formulas, and another of the few library functions included)."}]},{"type":"apogeeComponent","attrs":{"name":"comparison","id":0,"state":""}},{"type":"heading3","content":[{"type":"text","text":"Download with Fetch"}]},{"type":"paragraph","content":[{"type":"text","text":"You do not need to use the library functions. Fetch, or any other function returning a Promise, also works."}]},{"type":"paragraph","content":[{"type":"text","text":"Here we use fetch to do the download."}]},{"type":"paragraph","content":[{"type":"text","text":"Note that in our formula we added some error handling to add throwing an Error if there is a problem. Fetch specifically avoids doing this, but because Apogee is a form of "},{"type":"text","marks":[{"type":"italic"}],"text":"iterative"},{"type":"text","text":" programming, this is a recommended form of error handling in most cases. To view what happens when there is an error in the request, change the URL above so that it is not valid."}]},{"type":"apogeeComponent","attrs":{"name":"downloadWithFetch","id":0,"state":""}},{"type":"paragraph"}]}},"children":{"url":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"yearsAvailable":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"basicJsonDownload":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"basicTextDownload":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"comparison":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"downloadWithFetch":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}